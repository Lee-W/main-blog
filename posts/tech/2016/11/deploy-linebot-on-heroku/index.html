<!DOCTYPE html>

<html lang="zh-tw">
<head>
<meta charset="utf-8"/>
<meta charset="utf-8" content="text/html" http-equiv="Content-Type">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"/>
<title>Deploy LineBot on Heroku </title>
<meta content="True" name="HandheldFriendly"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="origin" name="referrer"/>
<meta content="Pelican" name="generator"/>
<link href="https://blog.wei-lee.me/posts/tech/2016/11/deploy-linebot-on-heroku" rel="canonical"/>
<!-- Feed -->
<link href="https://blog.wei-lee.me/feeds/all.atom.xml" rel="alternate" title="Those aren't written down are meant to be forgotten Full Atom Feed" type="application/atom+xml"/>
<!-- TODO: combine -->
<link href="https://blog.wei-lee.me/theme/css/style.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/pygments.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/pagefind-ui-custom.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/code.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/code-copy.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/custom.css" rel="stylesheet" type="text/css"/>
<link href="/pagefind/pagefind-ui.css" rel="stylesheet"/>
<!-- Custom fonts -->
<link href="https://fonts.googleapis.com/css?family=Montserrat:400,300" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css"/>
<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
<script>
    var siteUrl = 'https://blog.wei-lee.me';
  </script>
<script>
    var localTheme = localStorage.getItem('attila_theme');
    switch (localTheme) {
      case 'dark':
        document.documentElement.classList.add('theme-dark');
        break;
      case 'light':
        document.documentElement.classList.add('theme-light');
        break;
      default:
        break;
    }
  </script>
<meta content="上一篇提到如何用 ngrok 讓我們可以不用架 Https Server，直接在本地端測試 Bot 再來要談的是如何把 Bot 部署到 Heroku 上" name="description"/>
<meta content="Wei Lee" name="author"/>
<meta content="Heroku" name="tags"/>
<meta content="Django" name="tags"/>
<meta content="Chat Bot" name="tags"/>
<meta content="Deployment" name="tags"/>
<!-- Open Graph -->
<meta content="Those aren't written down are meant to be forgotten" prefix="og: http://ogp.me/ns#" property="og:site_name">
<meta content="Deploy LineBot on Heroku " prefix="og: http://ogp.me/ns#" property="og:title">
<meta content="上一篇提到如何用 ngrok 讓我們可以不用架 Https Server，直接在本地端測試 Bot 再來要談的是如何把 Bot 部署到 Heroku 上" prefix="og: http://ogp.me/ns#" property="og:description">
<meta content="zh-tw" prefix="og: http://ogp.me/ns#" property="og:locale">
<meta content="https://blog.wei-lee.me/posts/tech/2016/11/deploy-linebot-on-heroku" prefix="og: http://ogp.me/ns#" property="og:url">
<meta content="article" prefix="og: http://ogp.me/ns#" property="og:type">
<meta content="2016-11-27 06:05:00+08:00" prefix="og: http://ogp.me/ns#" property="article:published_time"/>
<meta content="" prefix="og: http://ogp.me/ns#" property="article:modified_time"/>
<meta content="https://blog.wei-lee.me/author/wei-lee.html" prefix="og: http://ogp.me/ns#" property="article:author"/>
<meta content="Tech" prefix="og: http://ogp.me/ns#" property="article:section">
<meta content="Heroku" prefix="og: http://ogp.me/ns#" property="article:tag"/>
<meta content="Django" prefix="og: http://ogp.me/ns#" property="article:tag"/>
<meta content="Chat Bot" prefix="og: http://ogp.me/ns#" property="article:tag"/>
<meta content="Deployment" prefix="og: http://ogp.me/ns#" property="article:tag"/>
<meta content="https://blog.wei-lee.me/images/cover.jpeg" prefix="og: http://ogp.me/ns#" property="og:image"/>
<!-- Twitter Card -->
<meta content="summary_large_image" name="twitter:card"/>
<meta content="@clleew" name="twitter:site"/>
<meta content="Deploy LineBot on Heroku " name="twitter:title"/>
<meta content="https://blog.wei-lee.me/posts/tech/2016/11/deploy-linebot-on-heroku" name="twitter:url"/>
<meta content="https://blog.wei-lee.me/images/cover.jpeg" name="twitter:image:src"/>
<meta content="上一篇提到如何用 ngrok 讓我們可以不用架 Https Server，直接在本地端測試 Bot 再來要談的是如何把 Bot 部署到 Heroku 上" name="twitter:description"/>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "name": "Deploy LineBot on Heroku",
  "headline": "Deploy LineBot on Heroku",
  "datePublished": "2016-11-27 06:05:00+08:00",
  "dateModified": "",
  "author": {
    "@type": "Person",
    "name": "Wei Lee",
    "url": "https://blog.wei-lee.me/author/wei-lee.html"
  },
  "image": "https://blog.wei-lee.me//images/cover.jpeg",
  "url": "https://blog.wei-lee.me/posts/tech/2016/11/deploy-linebot-on-heroku",
  "description": "上一篇提到如何用 ngrok 讓我們可以不用架 Https Server，直接在本地端測試 Bot 再來要談的是如何把 Bot 部署到 Heroku 上"
}
</script>
</meta></meta></meta></meta></meta></meta></meta></link></meta><link href="https://blog.wei-lee.me/posts/tech/2016/11/deploy-linebot-on-heroku" rel="canonical"/><script type="application/ld+json">{"@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [{"@type": "ListItem", "position": 1, "name": "Those aren't written down are meant to be forgotten", "item": "https://blog.wei-lee.me"}, {"@type": "ListItem", "position": 2, "name": "Posts", "item": "https://blog.wei-lee.me/posts"}, {"@type": "ListItem", "position": 3, "name": "Tech", "item": "https://blog.wei-lee.me/posts/tech"}, {"@type": "ListItem", "position": 4, "name": "2016", "item": "https://blog.wei-lee.me/posts/tech/2016"}, {"@type": "ListItem", "position": 5, "name": "11", "item": "https://blog.wei-lee.me/posts/tech/2016/11"}, {"@type": "ListItem", "position": 6, "name": "Deploy linebot on heroku", "item": "https://blog.wei-lee.me/posts/tech/2016/11/deploy-linebot-on-heroku"}, {"@type": "ListItem", "position": 7, "name": "Index", "item": "https://blog.wei-lee.me/posts/tech/2016/11/deploy-linebot-on-heroku/index.html"}]}</script><script type="application/ld+json">{"@context": "https://schema.org", "@type": "Article", "author": {"@type": "Person", "name": "Wei Lee"}, "publisher": {"@type": "Organization", "name": "Those aren't written down are meant to be forgotten"}, "headline": "Deploy LineBot on Heroku", "about": "Tech", "datePublished": "2016-11-27 06:05"}</script><meta content="summary" name="twitter:card"/><meta content="https://blog.wei-lee.me/posts/tech/2016/11/deploy-linebot-on-heroku" property="og:url"/><meta content="article" property="og:type"/><meta content="Deploy LineBot on Heroku" property="og:title"/><meta content="C" property="og:locale"/></head>
<body class="category-template">
<div class="nav-header">
<nav aria-label="Main" class="nav-wrapper">
<ul>
<li class="nav-🏠 Home" role="presentation"><a href="/"><span>🏠 Home</span></a></li>
<li class="nav-About Me" role="presentation"><a href="/pages/about-me.html"><span>About Me</span></a></li>
<li class="nav-👨‍💻 Tech active" role="presentation"><a href="/category/tech.html"><span>👨‍💻 Tech</span></a></li>
<li class="nav-📚 Book Digest" role="presentation"><a href="/category/book.html"><span>📚 Book Digest</span></a></li>
<li class="nav-💬 Gossiping" role="presentation"><a href="/category/gossiping.html"><span>💬 Gossiping</span></a></li>
<li class="nav-🏷️ Tags" role="presentation"><a href="/tags.html"><span>🏷️ Tags</span></a></li>
<li class="nav-🗄️ Archives" role="presentation"><a href="/archives.html"><span>🗄️ Archives</span></a></li>
<li class="nav-📚 Series" role="presentation"><a href="/series_list.html"><span>📚 Series</span></a></li>
<li class="nav-🔍 Search" role="presentation"><a href="/search.html"><span>🔍 Search</span></a></li>
</ul>
<ul class="nav-meta">
<li class="nav-linkedin"><a aria-label="Linkedin" href="https://tw.linkedin.com/in/clleew" target="_blank"><i aria-hidden="true" class="icon icon-linkedin"></i>
<span>Linkedin</span>
</a></li>
<li class="nav-github"><a aria-label="Github" href="https://github.com/Lee-W" target="_blank"><i aria-hidden="true" class="icon icon-github"></i>
<span>GitHub</span>
</a></li>
<li class="nav-twitter"><a aria-label="Twitter" href="https://twitter.com/clleew" target="_blank"><i aria-hidden="true" class="icon icon-twitter"></i>
<span>Twitter</span>
</a></li>
<li class="nav-search" style="display: none;">
<a title="Search">
<i aria-hidden="true" class="icon icon-search"></i>
<span>Search</span>
</a>
</li>
</ul> </nav>
<div class="nav-wrapper-control">
<div class="inner">
<a class="nav-menu" role="button"><i aria-hidden="true" class="icon icon-menu"></i>Menu</a>
<a class="nav-search" role="button" style="display: none;" title="Search"><i aria-hidden="true" class="icon icon-search"></i></a>
</div>
</div>
</div>
<div aria-label="Close" class="nav-close" role="button"></div>
<section class="page-wrapper" id="wrapper">
<!-- Progressbar -->
<div class="progress-container">
<span class="progress-bar"></span>
</div>
<!-- Page Header -->
<!-- Set your background image for this header on the line below. -->
<header class="post-header has-cover">
<div class="inner">
<span class="post-info">
<span class="post-type">Article</span>
<span class="post-count">Tech</span>
</span>
<h1 class="post-title">
            Deploy LineBot on Heroku
        </h1>
<div class="post-meta">
<div class="post-meta-avatars">
<figure class="post-meta-avatar avatar">
<a class="author-avatar" href="https://blog.wei-lee.me/author/wei-lee.html">
<img alt="Wei Lee" class="author-profile-image" src="https://blog.wei-lee.me//images/avatar.jpeg"/>
</a>
</figure>
</div>
<h4 class="post-meta-author">
            Wei Lee
          </h4>
<time datetime="2016/11/27 - Sun">2016/11/27 - Sun</time>
          • 1 min read
        </div>
<div class="post-cover cover">
<img alt="Category Tech" src="https://blog.wei-lee.me/images/cover.jpeg"/>
</div>
</div>
</header>
<!-- Post content -->
<main class="content" data-pagefind-body="" role="main">
<article class="post">
<div class="inner">
<section class="post-content">
<p>上一篇提到如何用 ngrok<br/>
讓我們可以不用架 Https Server，直接在本地端測試 Bot</p>
<p>再來要談的是如何把 Bot 部署到 Heroku 上</p>
<!--more-->
<h2 id="why-not-ngrok">Why not ngrok</h2>
<p>使用 ngrok 必須要讓你的本地端一直開著才能收到訊息<br/>
而且免費版的 ngrok 每次都會更改 url<br/>
所以我們需要一個可以讓其他人較長時間測試的 Server</p>
<p>以我自己的開發習慣<br/>
我會使用 ngrok，來做 Bot 的基本除錯<br/>
Heroku 則是用來讓其他人測試功能<br/>
真的要上線的時候才會自己架一個 Https Server</p>
<p>Line 的帳號也是 ngrok, heroku 跟上線需要的各申請一個<br/>
不過 ngrok 可以好幾個 Line Bot 專案共用一個即可</p>
<h2 id="heroku">Heroku</h2>
<h3 id="create-app">Create App</h3>
<p>先上<a href="https://www.heroku.com">Heroku</a> 辦個帳號</p>
<p>到個人的 dashboard<br/>
<code>New</code> → <code>Create New App</code><br/>
選一個名字，就創好 App 了</p>
<h3 id="deploy">Deploy</h3>
<h4 id="add-remote">Add Remote</h4>
<p>在部署之前要先安裝<a href="https://devcenter.heroku.com/articles/heroku-command-line">Heroku CLI</a></p>
<p>再來我們要到原本 line-echobot，將 heroku 加入這個專案的 remote</p>
<div class="highlight"><pre><span></span><code>heroku<span class="w"> </span>login
heroku<span class="w"> </span>git:remote<span class="w"> </span>-a<span class="w"> </span>leewbot
</code></pre></div>
<p>接著用 <code>git remote -v</code> 就能看到 <code>heroku</code> 已經被加入 remote 了<br/>
以後只要 <code>git push heroku master</code>，就能部署到 Heroku<br/>
不過我們還必須要多做一些設定才能讓 Bot 順利的部署</p>
<h4 id="environment-variables">Environment Variables</h4>
<p>首先是我們原先設定的環境變數<br/>
Heroku 是透過這個指令來做設定</p>
<div class="highlight"><pre><span></span><code>heroku<span class="w"> </span>config:set<span class="w"> </span><span class="s2">"env key"</span>:<span class="s2">"env value"</span>
</code></pre></div>
<p>或者也能到 dashboard 的 <code>Settings</code> → <code>Config Variables</code> → <code>Reveal Config Vars</code> 做設定</p>
<h4 id="python-environments">Python Environments</h4>
<p>因為 Heroku 支援多種不同的語言<br/>
所以要讓 Heroku 知道我們使用的是 Python</p>
<p>Heroku 可過專案中是否有 <code>requirements.txt</code> 來判斷這個專案是否為 Python 專案<br/>
並且安裝 <code>requirements.txt</code> 內的函式庫<br/>
名稱如果打錯，可能會讓 Heroku 不知道這是 Python 專案，導致部署失敗</p>
<p>另外可以透過 <code>runtime.txt</code> 來指定 Python 的版本<br/>
目前支援這兩種版本<br/>
* <code>python-2.7.12</code><br/>
* <code>python-3.5.2</code></p>
<h4 id="deploy-settings-procfile">Deploy Settings - Procfile</h4>
<p>再來必須要讓 Heroku 知道我們執行專案的指令是什麼<br/>
這個指令就是寫在 <code>Profile</code> 中</p>
<p>這裡使用的部署套件是 gunicorn<br/>
先在 <code>requirements.txt</code> 加入 <code>gunicorn==19.0.0</code><br/>
再來創一個 <code>Profile</code>，內容是</p>
<div class="highlight"><pre><span></span><code>web: gunicorn line_echobot.wsgi --log-file -
</code></pre></div>
<p>如果用其他的部署套件，則需要修改 web 後面的指令</p>
<p>到了這裡就做好所有的設定了<br/>
最後只要 <code>git push heroku master</code> 就會部署到 Heroku 上</p>
<p>透過 <code>heroku open</code> 能看到剛剛部署上去的專案<br/>
接著把專案的網址加上我們先前設定的 callback url <code>echobot/callback</code><br/>
設定到 Line Bot 的 Webhook URL，就完成了</p>
<h2 id="reference">Reference</h2>
<ul>
<li><a href="https://devcenter.heroku.com/articles/getting-started-with-python#introduction">Getting Started on Heroku with Python</a></li>
<li><a href="https://devcenter.heroku.com/articles/deploying-python">Deploying Python and Django Apps on Heroku</a></li>
</ul>
</section>
<section class="post-footer">
<div class="post-share">
<span class="post-info-label">Share</span>
<a aria-label="Twitter" class="twitter" href="https://twitter.com/share?text=Deploy LineBot on Heroku&amp;url=https://blog.wei-lee.me/posts/tech/2016/11/deploy-linebot-on-heroku" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235'); return false;" title="Twitter">
<i aria-hidden="true" class="fab fa-twitter"></i>
<span class="hidden">Twitter</span>
</a>
<a aria-label="Facebook" class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.wei-lee.me/posts/tech/2016/11/deploy-linebot-on-heroku" onclick="window.open(this.href, 'facebook-share', 'width=580,height=296'); return false;" title="Facebook">
<i aria-hidden="true" class="fa-brands fa-facebook"></i>
<span class="hidden">Facebook</span>
</a>
<a aria-label="LinkedIn" class="linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://blog.wei-lee.me/posts/tech/2016/11/deploy-linebot-on-heroku&amp;title=Deploy LineBot on Heroku" onclick="window.open(this.href, 'linkedin-share', 'width=930,height=720'); return false;" title="LinkedIn">
<i aria-hidden="true" class="fa-brands fa-linkedin"></i>
<span class="hidden">LinkedIn</span>
</a>
<a aria-label="Mastodon" class="mastodon" href="https://mtd.pythonasia.org/share?text=Deploy%20LineBot%20on%20Heroku%20https%3A//blog.wei-lee.me/posts/tech/2016/11/deploy-linebot-on-heroku" onclick="window.open(this.href, 'mastodon-share', 'width=930,height=720'); return false;" title="Mastodon">
<i aria-hidden="true" class="fa-brands fa-mastodon fa-xl" style="color: #74C0FC;"></i>
<span class="hidden">Mastodon</span>
</a>
<a aria-label="Email" class="email" href="mailto:?subject=Deploy LineBot on Heroku&amp;body=https://blog.wei-lee.me/posts/tech/2016/11/deploy-linebot-on-heroku" title="Email">
<i aria-hidden="true" class="fa-solid fa-envelope"></i>
<span class="hidden">Email</span>
</a>
<div class="clear"></div>
</div>
<aside class="post-tags">
<a href="https://blog.wei-lee.me/tag/heroku.html">Heroku</a><a href="https://blog.wei-lee.me/tag/django.html">Django</a><a href="https://blog.wei-lee.me/tag/chat-bot.html">Chat Bot</a><a href="https://blog.wei-lee.me/tag/deployment.html">Deployment</a> </aside>
<div class="clear"></div>
<div class="series">
<p>This post is part 4 of the "Line Bot Tutorial" series:</p>
<ol class="parts">
<li>
<a href="https://blog.wei-lee.me/posts/tech/2016/11/introduction-to-chatbot">Introduction to Chatbot</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2016/11/apply-line-messaging-api">Apply Line Messaging API</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2016/11/line-echo-bot-on-django">Line Echo Bot on Django</a>
</li>
<li class="active">
<a href="https://blog.wei-lee.me/posts/tech/2016/11/deploy-linebot-on-heroku">Deploy LineBot on Heroku</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2016/11/more-about-line-messaging-api-template-messages">More About Line Messaging API - Template Messages</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2016/11/more-than-just-echo-bot">More than Just Echo Bot</a>
</li>
</ol>
</div>
</section>
<aside class="post-nav">
<a class="post-nav-next" href="https://blog.wei-lee.me/posts/tech/2016/11/more-about-line-messaging-api-template-messages">
<section class="post-nav-teaser">
<i class="icon icon-arrow-left"></i>
<h2 class="post-nav-title">More About Line Messaging API - Template Messages</h2>
<p class="post-nav-excerpt">除了傳送文字外，Line Bot 還可以傳 圖片, 影像, 聲音, 地圖 貼圖 (Line Bot 所能使用的貼圖清單) Imagemap Template Button...</p>
<p class="post-nav-meta"><time datetime="2016/11/27 - Sun">2016/11/27 - Sun</time></p>
</section>
</a>
<a class="post-nav-prev" href="https://blog.wei-lee.me/posts/tech/2016/11/line-echo-bot-on-django">
<section class="post-nav-teaser">
<i class="icon icon-arrow-right"></i>
<h2 class="post-nav-title">Line Echo Bot on Django</h2>
<p class="post-nav-excerpt">單純要寫一個只會 Echo 的 Line Chat Bot 用 flask 只要 85 行的 code 就能解決 官方已經有提供相當清楚的範例flask-echo 了...</p>
<p class="post-nav-meta"><time datetime="2016/11/24 - Thu">2016/11/24 - Thu</time></p>
</section>
</a>
<div class="clear"></div>
</aside>
</div>
<script type="text/javascript">var use_utterance = true;</script>
<section class="post-comments">
<script async="" crossorigin="anonymous" data-issue-term="https://blog.wei-lee.me/posts/tech/2016/11/deploy-linebot-on-heroku" data-label="blog-comment" data-repo="Lee-W/main-blog" data-theme="github-light" src="https://utteranc.es/client.js">
</script>
</section>
</article>
</main>
<div class="nav-footer">
<nav aria-label="Footer" class="nav-wrapper">
<span class="nav-copy">Those aren't written down are meant to be forgotten © 2023
          <a class="nav-rss" href="https://blog.wei-lee.me/feeds/all.atom.xml" target="_blank" title="RSS"><i class="icon icon-rss"></i></a>
</span>
<span class="nav-credits">



          Published with <a href="https://github.com/getpelican/pelican" rel="nofollow">Pelican</a> • Theme <a href="https://github.com/arulrajnet/attila" rel="nofollow">Attila</a> •
          <a class="menu-item js-theme" data-dark="Dark theme" data-light="Light theme" data-system="System theme" href="#">
<span class="theme-icon"></span><span class="theme-text">System theme</span>
</a>
</span>
</nav>
</div>
</section>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.slim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"></script>
<!-- TODO: minify -->
<script src="https://blog.wei-lee.me/theme/js/jquery.fitvids.js" type="text/javascript"></script>
<script src="https://blog.wei-lee.me/theme/js/script.js" type="text/javascript"></script>
<script src="https://blog.wei-lee.me/theme/js/clipboard.min.js" type="text/javascript"></script>
<script src="https://blog.wei-lee.me/theme/js/copy-to-clipboard.js" type="text/javascript"></script>
<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-3J7XQ46QH5"></script>
<script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-3J7XQ46QH5', { 'anonymize_ip': true });
    </script>
<script src="/pagefind/pagefind-ui.js"></script>
<script>
      window.addEventListener('DOMContentLoaded', (event) => {
          new PagefindUI({
              element: "#search",
              showImages: false,
          });
      });
  </script>
<!-- 	The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in article.html, but it needs to be included down here, after jQuery has already loaded. -->
<!-- Add MathJax and FontAwesome for Asciidoc -->\
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" rel="stylesheet"/>
<script>
  $(document).ready(function () {
    var viewport = $(window);
    var post = $('.post-content');
    // Responsive videos with fitVids
    post.fitVids();

    var mdSelector=".highlight pre code";
    var rstSelector=".highlight pre code";
    // For ":source-highlighter: highlight.js`" in asciidoc
    var adocSelector="pre.highlight > code[data-lang]"
    var selector=mdSelector;
    // Format code blocks and add line numbers
    function codestyling() {
      $(selector).each(function(i, e) {
        // Code highlight
        hljs.highlightElement(e);
        // No lines for plain text blocks
        if (!$(this).hasClass('language-text')) {
          var code = $(this);
          // Calculate amount of lines
          var lines = code.html().split(/\n(?!$)/g).length;
          var numbers = [];
          if (lines > 1) {
            lines++;
          }
          for (i = 1; i < lines; i++) {
            numbers += '<span class="line" aria-hidden="true">' + i + '</span>';
          }
          code.parent().append('<div class="lines">' + numbers + '</div>');
        }
      });
    }

    // Format code blocks only
    function codestylingWithoutLineNumbers() {
      $(selector).each(function(i, e) {
        // Code highlight
        hljs.highlightElement(e);
      });
    }

    codestylingWithoutLineNumbers();
    // Reading progress bar on window top
    function readingProgress() {
      var postBottom = post.offset().top + post.height();
      var viewportHeight = viewport.height();
      var progress = 100 - (((postBottom - (viewport.scrollTop() + viewportHeight) + viewportHeight / 3) / (postBottom - viewportHeight + viewportHeight / 3)) * 100);
      $('.progress-bar').css('width', progress + '%');
      (progress > 100) ? $('.progress-container').addClass('complete'): $('.progress-container').removeClass('complete');
    }
    readingProgress();
    // Trigger reading progress
    viewport.on({
      'scroll': function() {
        readingProgress();
      },
      'resize': function() {
        readingProgress();
      },
      'orientationchange': function() {
        readingProgress();
      }
    });

  });
</script>
</body>
</html>
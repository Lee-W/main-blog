<!DOCTYPE html>

<html lang="zh-tw">
<head>
<meta charset="utf-8"/>
<meta charset="utf-8" content="text/html" http-equiv="Content-Type">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"/>
<title>[Note] Effective Python </title>
<meta content="True" name="HandheldFriendly"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="origin" name="referrer"/>
<meta content="Pelican" name="generator"/>
<link href="https://blog.wei-lee.me/posts/tech/2019/01/effective-python" rel="canonical"/>
<!-- Feed -->
<link href="https://blog.wei-lee.me/feeds/all.atom.xml" rel="alternate" title="Those aren't written down are meant to be forgotten Full Atom Feed" type="application/atom+xml"/>
<!-- TODO: combine -->
<link href="https://blog.wei-lee.me/theme/css/style.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/pygments.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/pagefind-ui-custom.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/code.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/code-copy.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/custom.css" rel="stylesheet" type="text/css"/>
<link href="/pagefind/pagefind-ui.css" rel="stylesheet"/>
<!-- Custom fonts -->
<link href="https://fonts.googleapis.com/css?family=Montserrat:400,300" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css"/>
<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
<script>
    var siteUrl = 'https://blog.wei-lee.me';
  </script>
<script>
    var localTheme = localStorage.getItem('attila_theme');
    switch (localTheme) {
      case 'dark':
        document.documentElement.classList.add('theme-dark');
        break;
      case 'light':
        document.documentElement.classList.add('theme-light');
        break;
      default:
        break;
    }
  </script>
<meta content="ç¬¬äºŒæ¬¡çœ‹éçµ‚æ–¼æœ‰è¾¦æ³•æŠŠåŸæœ¬çœ‹ä¸æ‡‚çš„éƒ¨åˆ†éƒ½çœ‹æ‡‚äº† é‚£äº›çœ‹ä¸æ‡‚çš„å¤§å¤šæ˜¯å¾ˆæŠ½è±¡åŒ–çš„æŠ€å·§ ä½†æ˜¯å•Šï¼Œçœ‹æ‡‚äº†é€™äº›èªæ³• ç¾åœ¨çš„æˆ‘é‚„æ˜¯æ²’æœ‰èƒ½åŠ›ï¼Œå°‡é€™äº›æŠ½è±¡åŒ–æ‡‰ç”¨åœ¨æˆ‘è‡ªå·±çš„ç¨‹å¼ä¸­ ä¸éå…¶ä»–å¤§éƒ¨åˆ†æ¯”è¼ƒç°¡å–®çš„åœ¨çœ‹éä¸€æ¬¡ é‚„æ˜¯æé†’æˆ‘åœ¨æ¯ä¸€å€‹çœ‰çœ‰è§’è§’éƒ½é‚„è¦å†æ›´æ³¨æ„ ä¸Šæ¬¡çœ‹éçš„é‚„æ²’æœ‰å…¨éƒ¨éƒ½æ‡‰ç”¨åˆ°æˆ‘å¯«ç¨‹å¼çš„ç¿’æ…£ä¸­å‘¢" name="description"/>
<meta content="Wei Lee" name="author"/>
<meta content="Python" name="tags"/>
<meta content="Note" name="tags"/>
<!-- Open Graph -->
<meta content="Those aren't written down are meant to be forgotten" prefix="og: http://ogp.me/ns#" property="og:site_name">
<meta content="[Note] Effective Python " prefix="og: http://ogp.me/ns#" property="og:title">
<meta content="ç¬¬äºŒæ¬¡çœ‹éçµ‚æ–¼æœ‰è¾¦æ³•æŠŠåŸæœ¬çœ‹ä¸æ‡‚çš„éƒ¨åˆ†éƒ½çœ‹æ‡‚äº† é‚£äº›çœ‹ä¸æ‡‚çš„å¤§å¤šæ˜¯å¾ˆæŠ½è±¡åŒ–çš„æŠ€å·§ ä½†æ˜¯å•Šï¼Œçœ‹æ‡‚äº†é€™äº›èªæ³• ç¾åœ¨çš„æˆ‘é‚„æ˜¯æ²’æœ‰èƒ½åŠ›ï¼Œå°‡é€™äº›æŠ½è±¡åŒ–æ‡‰ç”¨åœ¨æˆ‘è‡ªå·±çš„ç¨‹å¼ä¸­ ä¸éå…¶ä»–å¤§éƒ¨åˆ†æ¯”è¼ƒç°¡å–®çš„åœ¨çœ‹éä¸€æ¬¡ é‚„æ˜¯æé†’æˆ‘åœ¨æ¯ä¸€å€‹çœ‰çœ‰è§’è§’éƒ½é‚„è¦å†æ›´æ³¨æ„ ä¸Šæ¬¡çœ‹éçš„é‚„æ²’æœ‰å…¨éƒ¨éƒ½æ‡‰ç”¨åˆ°æˆ‘å¯«ç¨‹å¼çš„ç¿’æ…£ä¸­å‘¢" prefix="og: http://ogp.me/ns#" property="og:description">
<meta content="zh-tw" prefix="og: http://ogp.me/ns#" property="og:locale">
<meta content="https://blog.wei-lee.me/posts/tech/2019/01/effective-python" prefix="og: http://ogp.me/ns#" property="og:url"/>
<meta content="article" prefix="og: http://ogp.me/ns#" property="og:type"/>
<meta content="2019-01-19 16:45:00+08:00" prefix="og: http://ogp.me/ns#" property="article:published_time"/>
<meta content="" prefix="og: http://ogp.me/ns#" property="article:modified_time"/>
<meta content="https://blog.wei-lee.me/author/wei-lee.html" prefix="og: http://ogp.me/ns#" property="article:author"/>
<meta content="Tech" prefix="og: http://ogp.me/ns#" property="article:section">
<meta content="Python" prefix="og: http://ogp.me/ns#" property="article:tag"/>
<meta content="Note" prefix="og: http://ogp.me/ns#" property="article:tag"/>
<meta content="https://blog.wei-lee.me/images/cover.jpeg" prefix="og: http://ogp.me/ns#" property="og:image"/>
<!-- Twitter Card -->
<meta content="summary_large_image" name="twitter:card"/>
<meta content="@clleew" name="twitter:site"/>
<meta content="[Note] Effective Python " name="twitter:title"/>
<meta content="https://blog.wei-lee.me/posts/tech/2019/01/effective-python" name="twitter:url"/>
<meta content="https://blog.wei-lee.me/images/cover.jpeg" name="twitter:image:src"/>
<meta content="ç¬¬äºŒæ¬¡çœ‹éçµ‚æ–¼æœ‰è¾¦æ³•æŠŠåŸæœ¬çœ‹ä¸æ‡‚çš„éƒ¨åˆ†éƒ½çœ‹æ‡‚äº† é‚£äº›çœ‹ä¸æ‡‚çš„å¤§å¤šæ˜¯å¾ˆæŠ½è±¡åŒ–çš„æŠ€å·§ ä½†æ˜¯å•Šï¼Œçœ‹æ‡‚äº†é€™äº›èªæ³• ç¾åœ¨çš„æˆ‘é‚„æ˜¯æ²’æœ‰èƒ½åŠ›ï¼Œå°‡é€™äº›æŠ½è±¡åŒ–æ‡‰ç”¨åœ¨æˆ‘è‡ªå·±çš„ç¨‹å¼ä¸­ ä¸éå…¶ä»–å¤§éƒ¨åˆ†æ¯”è¼ƒç°¡å–®çš„åœ¨çœ‹éä¸€æ¬¡ é‚„æ˜¯æé†’æˆ‘åœ¨æ¯ä¸€å€‹çœ‰çœ‰è§’è§’éƒ½é‚„è¦å†æ›´æ³¨æ„ ä¸Šæ¬¡çœ‹éçš„é‚„æ²’æœ‰å…¨éƒ¨éƒ½æ‡‰ç”¨åˆ°æˆ‘å¯«ç¨‹å¼çš„ç¿’æ…£ä¸­å‘¢" name="twitter:description"/>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "name": "[Note] Effective Python",
  "headline": "[Note] Effective Python",
  "datePublished": "2019-01-19 16:45:00+08:00",
  "dateModified": "",
  "author": {
    "@type": "Person",
    "name": "Wei Lee",
    "url": "https://blog.wei-lee.me/author/wei-lee.html"
  },
  "image": "https://blog.wei-lee.me//images/cover.jpeg",
  "url": "https://blog.wei-lee.me/posts/tech/2019/01/effective-python",
  "description": "ç¬¬äºŒæ¬¡çœ‹éçµ‚æ–¼æœ‰è¾¦æ³•æŠŠåŸæœ¬çœ‹ä¸æ‡‚çš„éƒ¨åˆ†éƒ½çœ‹æ‡‚äº† é‚£äº›çœ‹ä¸æ‡‚çš„å¤§å¤šæ˜¯å¾ˆæŠ½è±¡åŒ–çš„æŠ€å·§ ä½†æ˜¯å•Šï¼Œçœ‹æ‡‚äº†é€™äº›èªæ³• ç¾åœ¨çš„æˆ‘é‚„æ˜¯æ²’æœ‰èƒ½åŠ›ï¼Œå°‡é€™äº›æŠ½è±¡åŒ–æ‡‰ç”¨åœ¨æˆ‘è‡ªå·±çš„ç¨‹å¼ä¸­ ä¸éå…¶ä»–å¤§éƒ¨åˆ†æ¯”è¼ƒç°¡å–®çš„åœ¨çœ‹éä¸€æ¬¡ é‚„æ˜¯æé†’æˆ‘åœ¨æ¯ä¸€å€‹çœ‰çœ‰è§’è§’éƒ½é‚„è¦å†æ›´æ³¨æ„ ä¸Šæ¬¡çœ‹éçš„é‚„æ²’æœ‰å…¨éƒ¨éƒ½æ‡‰ç”¨åˆ°æˆ‘å¯«ç¨‹å¼çš„ç¿’æ…£ä¸­å‘¢"
}
</script>
</meta></meta></meta></meta></meta></link></meta><link href="https://blog.wei-lee.me/posts/tech/2019/01/effective-python" rel="canonical"/><script type="application/ld+json">{"@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [{"@type": "ListItem", "position": 1, "name": "Those aren't written down are meant to be forgotten", "item": "https://blog.wei-lee.me"}, {"@type": "ListItem", "position": 2, "name": "Posts", "item": "https://blog.wei-lee.me/posts"}, {"@type": "ListItem", "position": 3, "name": "Tech", "item": "https://blog.wei-lee.me/posts/tech"}, {"@type": "ListItem", "position": 4, "name": "2019", "item": "https://blog.wei-lee.me/posts/tech/2019"}, {"@type": "ListItem", "position": 5, "name": "01", "item": "https://blog.wei-lee.me/posts/tech/2019/01"}, {"@type": "ListItem", "position": 6, "name": "Effective python", "item": "https://blog.wei-lee.me/posts/tech/2019/01/effective-python"}, {"@type": "ListItem", "position": 7, "name": "Index", "item": "https://blog.wei-lee.me/posts/tech/2019/01/effective-python/index.html"}]}</script><script type="application/ld+json">{"@context": "https://schema.org", "@type": "Article", "author": {"@type": "Person", "name": "Wei Lee"}, "publisher": {"@type": "Organization", "name": "Those aren't written down are meant to be forgotten"}, "headline": "[Note] Effective Python", "about": "Tech", "datePublished": "2019-01-19 16:45"}</script><meta content="summary" name="twitter:card"/><meta content="https://blog.wei-lee.me/posts/tech/2019/01/effective-python" property="og:url"/><meta content="article" property="og:type"/><meta content="[Note] Effective Python" property="og:title"/><meta content="C" property="og:locale"/></head>
<body class="category-template">
<div class="nav-header">
<nav aria-label="Main" class="nav-wrapper">
<ul>
<li class="nav-ğŸ  Home" role="presentation"><a href="/"><span>ğŸ  Home</span></a></li>
<li class="nav-About Me" role="presentation"><a href="/pages/about-me.html"><span>About Me</span></a></li>
<li class="nav-ğŸ‘¨â€ğŸ’» Tech active" role="presentation"><a href="/category/tech.html"><span>ğŸ‘¨â€ğŸ’» Tech</span></a></li>
<li class="nav-ğŸ“š Book Digest" role="presentation"><a href="/category/book.html"><span>ğŸ“š Book Digest</span></a></li>
<li class="nav-ğŸ’¬ Gossiping" role="presentation"><a href="/category/gossiping.html"><span>ğŸ’¬ Gossiping</span></a></li>
<li class="nav-ğŸ·ï¸ Tags" role="presentation"><a href="/tags.html"><span>ğŸ·ï¸ Tags</span></a></li>
<li class="nav-ğŸ—„ï¸ Archives" role="presentation"><a href="/archives.html"><span>ğŸ—„ï¸ Archives</span></a></li>
<li class="nav-ğŸ“š Series" role="presentation"><a href="/series_list.html"><span>ğŸ“š Series</span></a></li>
<li class="nav-ğŸ” Search" role="presentation"><a href="/search.html"><span>ğŸ” Search</span></a></li>
</ul>
<ul class="nav-meta">
<li class="nav-linkedin"><a aria-label="Linkedin" href="https://tw.linkedin.com/in/clleew" target="_blank"><i aria-hidden="true" class="icon icon-linkedin"></i>
<span>Linkedin</span>
</a></li>
<li class="nav-github"><a aria-label="Github" href="https://github.com/Lee-W" target="_blank"><i aria-hidden="true" class="icon icon-github"></i>
<span>GitHub</span>
</a></li>
<li class="nav-twitter"><a aria-label="Twitter" href="https://twitter.com/clleew" target="_blank"><i aria-hidden="true" class="icon icon-twitter"></i>
<span>Twitter</span>
</a></li>
<li class="nav-search" style="display: none;">
<a title="Search">
<i aria-hidden="true" class="icon icon-search"></i>
<span>Search</span>
</a>
</li>
</ul> </nav>
<div class="nav-wrapper-control">
<div class="inner">
<a class="nav-menu" role="button"><i aria-hidden="true" class="icon icon-menu"></i>Menu</a>
<a class="nav-search" role="button" style="display: none;" title="Search"><i aria-hidden="true" class="icon icon-search"></i></a>
</div>
</div>
</div>
<div aria-label="Close" class="nav-close" role="button"></div>
<section class="page-wrapper" id="wrapper">
<!-- Progressbar -->
<div class="progress-container">
<span class="progress-bar"></span>
</div>
<!-- Page Header -->
<!-- Set your background image for this header on the line below. -->
<header class="post-header has-cover">
<div class="inner">
<span class="post-info">
<span class="post-type">Article</span>
<span class="post-count">Tech</span>
</span>
<h1 class="post-title">
            [Note] Effective Python
        </h1>
<div class="post-meta">
<div class="post-meta-avatars">
<figure class="post-meta-avatar avatar">
<a class="author-avatar" href="https://blog.wei-lee.me/author/wei-lee.html">
<img alt="Wei Lee" class="author-profile-image" src="https://blog.wei-lee.me//images/avatar.jpeg"/>
</a>
</figure>
</div>
<h4 class="post-meta-author">
            Wei Lee
          </h4>
<time datetime="2019/01/19 - Sat">2019/01/19 - Sat</time>
          â€¢ 5 min read
        </div>
<div class="post-cover cover">
<img alt="Category Tech" src="https://blog.wei-lee.me/images/cover.jpeg"/>
</div>
</div>
</header>
<!-- Post content -->
<main class="content" data-pagefind-body="" role="main">
<article class="post">
<div class="inner">
<section class="post-content">
<p><img alt="effective python" src="/images/books/effective-python.jpg"/></p>
<p>ç¬¬äºŒæ¬¡çœ‹éçµ‚æ–¼æœ‰è¾¦æ³•æŠŠåŸæœ¬çœ‹ä¸æ‡‚çš„éƒ¨åˆ†éƒ½çœ‹æ‡‚äº†<br/>
é‚£äº›çœ‹ä¸æ‡‚çš„å¤§å¤šæ˜¯å¾ˆæŠ½è±¡åŒ–çš„æŠ€å·§<br/>
ä½†æ˜¯å•Šï¼Œçœ‹æ‡‚äº†é€™äº›èªæ³•<br/>
ç¾åœ¨çš„æˆ‘é‚„æ˜¯æ²’æœ‰èƒ½åŠ›ï¼Œå°‡é€™äº›æŠ½è±¡åŒ–æ‡‰ç”¨åœ¨æˆ‘è‡ªå·±çš„ç¨‹å¼ä¸­<br/>
ä¸éå…¶ä»–å¤§éƒ¨åˆ†æ¯”è¼ƒç°¡å–®çš„åœ¨çœ‹éä¸€æ¬¡<br/>
é‚„æ˜¯æé†’æˆ‘åœ¨æ¯ä¸€å€‹çœ‰çœ‰è§’è§’éƒ½é‚„è¦å†æ›´æ³¨æ„<br/>
ä¸Šæ¬¡çœ‹éçš„é‚„æ²’æœ‰å…¨éƒ¨éƒ½æ‡‰ç”¨åˆ°æˆ‘å¯«ç¨‹å¼çš„ç¿’æ…£ä¸­å‘¢</p>
<!--more-->
<div class="toc">
<ul>
<li><a href="#pythonic">ç¬¬ä¸€ç« ï¼š Pythonic æ€ç¶­</a><ul>
<li><a href="#02-pep8">ä½œæ³•02ï¼š éµå¾ª PEP8 é¢¨æ ¼æŒ‡å—</a></li>
<li><a href="#04">ä½œæ³•04ï¼š æ’°å¯«è¼”åŠ©å‡½å¼è€Œéè¤‡é›œçš„é‹ç®—å¼</a></li>
<li><a href="#05">ä½œæ³•05: çŸ¥é“å¦‚ä½•åˆ‡å‰²åºåˆ—</a></li>
<li><a href="#07-list-comprehension-map-filter">ä½œæ³•07: ä½¿ç”¨ list comprehension è€Œé map å’Œ filter</a></li>
<li><a href="#09-generator-list-comprehension">ä½œæ³•09: è€ƒæ…®ä½¿ç”¨ generator å–ä»£å¤§å‹ list comprehension</a></li>
<li><a href="#11-zip-iterables">ä½œæ³•11: ä½¿ç”¨ zip ä¾†å¹³è¡Œè™•ç† iterables</a></li>
<li><a href="#12-for-while-else">ä½œæ³•12: é¿å…åœ¨ for æˆ– while å¾Œé¢ä½¿ç”¨ else å€å¡Š</a></li>
<li><a href="#13-tryexceptelsefinally">ä½œæ³•13: å–„ç”¨ try/except/else/finally ä¸­çš„æ¯å€‹å€å¡Š</a></li>
</ul>
</li>
<li><a href="#_1">ç¬¬äºŒç« ï¼š å‡½å¼</a><ul>
<li><a href="#14-none">ä½œæ³•14: å„ªå…ˆé¸ç”¨ä¾‹å¤–è™•ç†è€Œéå›å‚³ None</a></li>
<li><a href="#20-none-docstrings-mutable-default-arguments">ä½œæ³•20: ä½¿ç”¨ None èˆ‡ Docstrings ä¾†æŒ‡å®š mutable default arguments</a></li>
<li><a href="#19-keyword-argument-related-to-21">ä½œæ³•19: ä»¥ keyword argument æä¾›é¸æ“‡æ€§çš„è¡Œç‚º (Related to ä½œæ³•21)</a></li>
<li><a href="#21-keyword-argument">ä½œæ³•21: å¼·åˆ¶ä½¿ç”¨åƒ…é™ keyword argument ä¾†è®“ç¨‹å¼ç¢¼æ›´æ¸…æ¥šæ˜“æ‡‚</a></li>
</ul>
</li>
<li><a href="#_2">ç¬¬ä¸‰ç« ï¼š é¡åˆ¥èˆ‡ç¹¼æ‰¿</a><ul>
<li><a href="#22-class-dictionary-tuple">ä½œæ³•22: å„ªå…ˆé¸ç”¨è¼”åŠ© class è€Œéä½¿ç”¨ dictionary æˆ– tuple ä¾†ç®¡ç†ç´€éŒ„</a></li>
<li><a href="#25-super">ä½œæ³•25: ä½¿ç”¨ super ä¾†åˆå§‹åŒ–çˆ¶é¡åˆ¥</a></li>
<li><a href="#27">ä½œæ³•27: å„ªå…ˆé¸ç”¨å…¬é–‹å±¬æ€§è€Œéç§æœ‰å±¬æ€§</a></li>
</ul>
</li>
<li><a href="#_3">ç¬¬å››ç« ï¼š å…ƒé¡åˆ¥èˆ‡å±¬æ€§</a><ul>
<li><a href="#33-34-35">ä½œæ³•33, 34, 35</a></li>
</ul>
</li>
<li><a href="#_4">ç¬¬äº”ç« ï¼š å…±æ™‚èˆ‡å¹³è¡Œè™•ç†</a><ul>
<li><a href="#38-lock-data-race">ä½œæ³•38: ä½¿ç”¨ Lock ä¾†é¿å…åŸ·è¡Œç·’ä¸­çš„ data race</a></li>
<li><a href="#39-queue">ä½œæ³•39: ä½¿ç”¨ Queue ä¾†å”èª¿åŸ·è¡Œç·’ä¹‹é–“çš„å·¥ä½œ</a></li>
<li><a href="#41-concurrentfutures">ä½œæ³•41: è€ƒæ…®ä½¿ç”¨ concurrent.futures ä¾†é”æˆçœŸæ­£çš„å¹³è¡Œè™•ç†</a></li>
</ul>
</li>
<li><a href="#_5">ç¬¬å…­ç« ï¼š å…§å»ºæ¨¡çµ„</a><ul>
<li><a href="#34-contextlib-with-statement-tryfinally">ä½œæ³•34: è€ƒæ…®ä½¿ç”¨ contextlib èˆ‡ with statement ä¾†å»ºç«‹å¯é‡ç”¨çš„ try/finally è¡Œç‚º</a></li>
<li><a href="#45-datetime-time">ä½œæ³•45: æœ¬åœ°æ™‚é˜ä½¿ç”¨ datetime è€Œé time</a></li>
</ul>
</li>
<li><a href="#_6">ç¬¬ä¸ƒç« ï¼š å”ä½œ</a><ul>
<li><a href="#49-function-class-module-docstrings">ä½œæ³•49: ç‚ºæ¯å€‹ function, class, module æ’°å¯« Docstrings</a></li>
<li><a href="#50-package-module-api">ä½œæ³•50: ä½¿ç”¨ package ä¾†çµ„ç¹” module ä¸¦æä¾›ç©©å®šçš„ API</a></li>
<li><a href="#51-root-exception-api">ä½œæ³•51: å®šç¾©ä¸€å€‹ root exception ä¾†éš”é›¢å‘¼å«è€…èˆ‡ API</a></li>
<li><a href="#52">ä½œæ³•52: çŸ¥é“å¦‚ä½•æ‰“ç ´å¾ªç’°ä¾å­˜æ€§</a></li>
</ul>
</li>
<li><a href="#_7">ç¬¬å…«ç« ï¼š æ¨å‡ºç”¢å“</a><ul>
<li><a href="#57-pdb">ä½œæ³•57: è€ƒæ…®ä½¿ç”¨ pdb ä¾†é€²è¡Œäº’å‹•å¼é™¤éŒ¯</a></li>
<li><a href="#58">ä½œæ³•58: æœ€ä½³åŒ–ä¹‹å‰å…ˆé€²è¡Œæ•ˆèƒ½è©•ä¼°</a></li>
<li><a href="#59-tracemalloc">ä½œæ³•59: ä½¿ç”¨ tracemalloc ä¾†äº†è§£è¨˜æ†¶é«”ç”¨é‡æˆ–æ˜¯å¦æœ‰æ´©æ¼</a></li>
</ul>
</li>
</ul>
</div>
<hr/>
<h2 id="pythonic">ç¬¬ä¸€ç« ï¼š Pythonic æ€ç¶­</h2>
<h3 id="02-pep8">ä½œæ³•02ï¼š éµå¾ª PEP8 é¢¨æ ¼æŒ‡å—</h3>
<p><a href="https://www.python.org/dev/peps/pep-0008/">PEP8</a><br/>
(æˆ‘åªæŠŠæˆ‘èªç‚ºå®¹æ˜“è¢«å¿½ç•¥æˆ–ç‰¹åˆ¥é‡è¦çš„å¹¾é»ç•™ä¸‹ä¾†)</p>
<ul>
<li>Whitespace<ul>
<li>éé•·çš„ expressions è¦æ¥çºŒåˆ°å…¶ä»–æ–‡å­—è¡Œæ™‚ï¼Œé™¤äº†åŸæœ¬çš„ç¸®æ’å±¤æ¬¡ï¼Œæ‡‰å†åŠ ä¸Šé¡å¤–çš„<strong>å››å€‹ç©ºæ ¼</strong>ä¾†ç¸®æ’</li>
</ul>
</li>
<li>Naming<ul>
<li>protected instance attributes â†’ _leading_underscore</li>
<li>private instance attributes â†’ __double_leading_underscore</li>
<li>Class, exceptions â†’ CapitalizedWord</li>
<li>model-level constant â†’ ALL_CAPS</li>
</ul>
</li>
<li>
<p>Statements</p>
<ul>
<li>ä½¿ç”¨è¡Œå…§å¦å®š (inline negation, e.g., <code>if a is not b</code>)ï¼Œè€Œéå¦å®šæ­£å‘çš„é‹ç®—å¼ (negation of positive expressions, e.g., <code>if not a is b</code>)</li>
<li>åˆ¥ç”¨æŸ¥é©—é•·åº¦çš„æ–¹å¼ (<code>if len(somelist) == 0</code>) ä¾†æª¢æŸ¥ç©ºå€¼ã€‚ä½¿ç”¨ <code>if not somelist</code></li>
<li>é¿å…å–®è¡Œ <code>if</code>, <code>for</code>, <code>while</code>, <code>except</code>ï¼Œå°‡å®ƒå€‘åˆ†å¤šè¡Œæè¿°ä»¥æ¸…æ¥šè¡¨é”</li>
<li>import module æ°¸é ç”¨çµ•å°åç¨±<ul>
<li>e.g., ç”¨ <code>from bar import foo</code> è€Œä¸æ˜¯ <code>import foo</code></li>
</ul>
</li>
<li>import é †åº<ol>
<li>standard library modules</li>
<li>third-party modules</li>
<li>your own modules</li>
</ol>
</li>
</ul>
</li>
<li>
<p>ç”¨ <a href="https://www.pylint.org">pylint</a> ä¾†æª¢æŸ¥é¢¨æ ¼</p>
</li>
</ul>
<h3 id="04">ä½œæ³•04ï¼š æ’°å¯«è¼”åŠ©å‡½å¼è€Œéè¤‡é›œçš„é‹ç®—å¼</h3>
<ul>
<li>å°‡è¤‡é›œçš„é‹ç®—å¼ç§»åˆ°è¼”åŠ©å‡½å¼ (helper function) å…§ï¼Œç‰¹åˆ¥æ˜¯åœ¨ä½ éœ€è¦é‡è¤‡ç”¨åˆ°åŒæ¨£çš„é‚è¼¯çš„æ™‚å€™</li>
<li>èˆ‡å…¶åœ¨é‹ç®—å¼ä¸­ä½¿ç”¨ <code>or</code> æˆ– <code>and</code> ï¼Œä¸å¦‚ä½¿ç”¨ <code>if/else</code> è®“ç¨‹å¼ç¢¼æ›´æ˜“è®€</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">my_values</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"red"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"5"</span><span class="p">],</span> <span class="n">green</span><span class="p">:</span> <span class="p">[</span><span class="s2">""</span><span class="p">]}</span>

<span class="c1"># or, and</span>
<span class="n">red</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">my_values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"red"</span><span class="p">,</span> <span class="p">[</span><span class="s2">""</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># if/else</span>
<span class="n">red</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">red</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">red</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">else</span> <span class="mi">0</span>

<span class="c1"># even better if/else</span>
<span class="k">if</span> <span class="n">red</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
    <span class="n">red</span> <span class="o">=</span> <span class="n">red</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">red</span> <span class="o">=</span> <span class="mi">0</span>


<span class="c1"># helper function</span>
<span class="k">def</span> <span class="nf">get_first_int</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">found</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">[</span><span class="s2">""</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">found</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">found</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">found</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">found</span> <span class="o">=</span> <span class="n">default</span>
    <span class="k">return</span> <span class="n">found</span>


<span class="n">red</span> <span class="o">=</span> <span class="n">get_first_int</span><span class="p">(</span><span class="n">my_values</span><span class="p">,</span> <span class="s2">"red"</span><span class="p">)</span>
</code></pre></div>
<h3 id="05">ä½œæ³•05: çŸ¥é“å¦‚ä½•åˆ‡å‰²åºåˆ—</h3>
<ul>
<li>çœç•¥ zero index, æœ€å¾Œçš„ç´¢å¼•ä¾†é™ä½è¦–è¦ºé›œè¨Š<ul>
<li>ç”¨ <code>a[:5]</code>, <code>a[5:]</code> è€Œä¸æ˜¯ <code>a[0:5]</code>, <code>a[5:len(a)]</code></li>
</ul>
</li>
<li>copy value v.s. copy reference</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1"># copy value</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="p">[:]</span>
<span class="k">assert</span> <span class="n">b</span> <span class="o">==</span> <span class="n">a</span>
<span class="k">assert</span> <span class="n">b</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">a</span>

<span class="c1"># copy reference</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">a</span>
<span class="k">assert</span> <span class="n">b</span> <span class="ow">is</span> <span class="n">a</span>
</code></pre></div>
<h3 id="07-list-comprehension-map-filter">ä½œæ³•07: ä½¿ç”¨ list comprehension è€Œé map å’Œ filter</h3>
<ul>
<li>é¿å…ç”¨ <code>map</code>, <code>filter</code> ï¼Œå› ç‚ºä½¿ç”¨ä»–å€‘æ™‚éœ€è¦å»ºç«‹ä¸€å€‹ <code>lambda</code> ï¼Œé€™æ˜¯ç¨®è¦–è¦ºé›œè¨Š</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>

<span class="c1"># list comprehension</span>
<span class="n">squares</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a</span><span class="p">]</span>

<span class="c1"># map</span>
<span class="n">squares</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</code></pre></div>
<h3 id="09-generator-list-comprehension">ä½œæ³•09: è€ƒæ…®ä½¿ç”¨ generator å–ä»£å¤§å‹ list comprehension</h3>
<ul>
<li>å°æ–¼å¤§å‹è¼¸å…¥ä¾†èªª list comprehension å¯èƒ½è€—ç”¨ç›¸ç•¶å¤§é‡çš„è¨˜æ†¶é«”</li>
</ul>
<h3 id="11-zip-iterables">ä½œæ³•11: ä½¿ç”¨ zip ä¾†å¹³è¡Œè™•ç† iterables</h3>
<div class="highlight"><pre><span></span><code><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">,</span> <span class="s2">"d"</span><span class="p">]</span>

<span class="c1"># without zip</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="c1"># with zip</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div>
<ul>
<li>å¦‚æœæä¾›äº†ä¸åŒé•·åº¦çš„ iterables ï¼Œ zip æœƒ truncate æ‰è¼ƒé•·çš„ input</li>
</ul>
<h3 id="12-for-while-else">ä½œæ³•12: é¿å…åœ¨ for æˆ– while å¾Œé¢ä½¿ç”¨ else å€å¡Š</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># avoid</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="o">...</span>
<span class="k">else</span><span class="p">:</span>
    <span class="o">...</span>
</code></pre></div>
<h3 id="13-tryexceptelsefinally">ä½œæ³•13: å–„ç”¨ try/except/else/finally ä¸­çš„æ¯å€‹å€å¡Š</h3>
<ul>
<li><code>finally</code><ul>
<li>å³ä½¿ä¾‹å¤–ç™¼ç”Ÿï¼Œä½†ä¹Ÿæƒ³è¦åœ¨ä¾‹å¤–ç™¼ç”Ÿæ™‚åŸ·è¡Œæ¸…ç†ç”¨çš„ cleanup code</li>
</ul>
</li>
<li><code>else</code><ul>
<li>å¦‚æœ try æ²’æœ‰ä¸Ÿå‡ºä¾‹å¤–ï¼Œ else å€å¡Šå°±æœƒåŸ·è¡Œ</li>
<li>ç”¨ä¾†æœ€å°åŒ– try å€å¡Šçš„ç¨‹å¼ç¢¼é‡ â†’ <strong>è®“ try å€å¡Šåªå‡ºç¾æœƒä¸Ÿå‡ºä¾‹å¤–çš„ç¨‹å¼ç¢¼</strong></li>
</ul>
</li>
</ul>
<h2 id="_1">ç¬¬äºŒç« ï¼š å‡½å¼</h2>
<h3 id="14-none">ä½œæ³•14: å„ªå…ˆé¸ç”¨ä¾‹å¤–è™•ç†è€Œéå›å‚³ None</h3>
<ul>
<li>å›å‚³ <code>None</code> å¸¶æœ‰ç‰¹æ®Šæ„ç¾©çš„å‡½å¼å®¹æ˜“å‡ºéŒ¯ï¼Œå› ç‚º <code>None</code> èˆ‡å…¶ä»–çš„å€¼ (e.g., <code>0</code>, <code>[]</code>, <code>''</code>)ï¼Œåœ¨åšæ¢ä»¶é‹ç®—å¼é‹ç®—çš„çµæœéƒ½æ˜¯ <code>False</code></li>
</ul>
<h3 id="20-none-docstrings-mutable-default-arguments">ä½œæ³•20: ä½¿ç”¨ None èˆ‡ Docstrings ä¾†æŒ‡å®š mutable default arguments</h3>
<ul>
<li>default arguments åªæœƒè¢« evaluate ä¸€æ¬¡ï¼šæ¨¡çµ„è¼‰å…¥æ™‚ã€å‡½å¼å®šç¾©æ™‚ã€‚å°æ–¼å‹•æ…‹å€¼ (e.g., <code>{}</code>, <code>[]</code>) ä¾†èªªï¼Œé€™å¯èƒ½å°è‡´å¥‡æ€ªçš„è¡Œç‚º</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>


<span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>


<span class="c1"># The two results would be the same but should be different</span>
<span class="n">func</span><span class="p">()</span>
<span class="n">func</span><span class="p">()</span>
</code></pre></div>
<p><strong>Fix</strong></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>


<span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Demonstration</span>

<span class="sd">    Args:</span>
<span class="sd">        default: current datetime</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">default</span><span class="p">:</span>
        <span class="n">default</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>
</code></pre></div>
<h3 id="19-keyword-argument-related-to-21">ä½œæ³•19: ä»¥ keyword argument æä¾›é¸æ“‡æ€§çš„è¡Œç‚º (Related to ä½œæ³•21)</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># original</span>
<span class="k">def</span> <span class="nf">flow_rate</span><span class="p">(</span><span class="n">weight_diff</span><span class="p">,</span> <span class="n">time_diff</span><span class="p">,</span> <span class="n">period</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">weight_diff</span> <span class="o">/</span> <span class="n">time_diff</span><span class="p">)</span> <span class="o">*</span> <span class="n">period</span>


<span class="c1"># with default argument</span>
<span class="k">def</span> <span class="nf">flow_rate</span><span class="p">(</span><span class="n">weight_diff</span><span class="p">,</span> <span class="n">time_diff</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">weight_diff</span> <span class="o">/</span> <span class="n">time_diff</span><span class="p">)</span> <span class="o">*</span> <span class="n">period</span>
</code></pre></div>
<p>ä¸åƒã€Œä½œæ³•21ã€å…¨é¢æ¡å– keyword argementçš„åŸå› æ˜¯ç‚ºäº†é”åˆ° backwards compatibility</p>
<h3 id="21-keyword-argument">ä½œæ³•21: å¼·åˆ¶ä½¿ç”¨åƒ…é™ keyword argument ä¾†è®“ç¨‹å¼ç¢¼æ›´æ¸…æ¥šæ˜“æ‡‚</h3>
<ul>
<li>ä½¿ç”¨ keyword-only arguments ä¾†å¼·åˆ¶è¦æ±‚å‘¼å«è€…æä¾› keyword argument ä»¥é¿å…æ··æ·†ï¼Œç‰¹åˆ¥æ˜¯åœ¨æ¥æ”¶å¤šå€‹ Boolean flag çš„å‡½å¼ä¸­</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1"># * indicates the end of positional arguments</span>
<span class="k">def</span> <span class="nf">safe_division</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">divisor</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">ignore_overflow</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span> <span class="o">...</span>
</code></pre></div>
<h2 id="_2">ç¬¬ä¸‰ç« ï¼š é¡åˆ¥èˆ‡ç¹¼æ‰¿</h2>
<h3 id="22-class-dictionary-tuple">ä½œæ³•22: å„ªå…ˆé¸ç”¨è¼”åŠ© class è€Œéä½¿ç”¨ dictionary æˆ– tuple ä¾†ç®¡ç†ç´€éŒ„</h3>
<ul>
<li>å¦‚æœé‚„ä¸éœ€è¦ç”¨åˆ°è¼ƒæœ‰å½ˆæ€§çš„å®Œæ•´ classï¼Œè«‹ä½¿ç”¨ <code>namedtuple</code> ä¾†è£½ä½œè¼•é‡åŒ–ã€ä¸å¯è®Šçš„è³‡æ–™å®¹å™¨<ul>
<li><code>namedtuple</code> ä¸èƒ½æŒ‡å®šé è¨­å¼•æ•¸å€¼ï¼Œå¦‚æœè³‡æ–™æœ‰è¨±å¤š optional propertiesï¼Œå‰‡é‚„æ˜¯é©åˆç”¨ class</li>
</ul>
</li>
</ul>
<h3 id="25-super">ä½œæ³•25: ä½¿ç”¨ super ä¾†åˆå§‹åŒ–çˆ¶é¡åˆ¥</h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Implicit</span><span class="p">(</span><span class="n">BaseClass</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">value</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
</code></pre></div>
<h3 id="27">ä½œæ³•27: å„ªå…ˆé¸ç”¨å…¬é–‹å±¬æ€§è€Œéç§æœ‰å±¬æ€§</h3>
<ul>
<li>ç‚ºä»€éº¼ç§æœ‰å±¬æ€§çš„èªæ³•ä¸å¼·åˆ¶æ–½è¡Œåš´æ ¼çš„å¯è¦‹æ€§é™åˆ¶å‘¢ï¼Ÿ<ul>
<li>We are all consenting adults here.</li>
</ul>
</li>
<li>é¸æ“‡ç§æœ‰å±¬æ€§ï¼Œåªæœƒè®“å­é¡åˆ¥çš„ overrides æˆ– extensions å‹•ä½œè®Šå¾—æ›´éº»ç…©æ›´å®¹æ˜“å‡ºéŒ¯</li>
<li>ä¸€èˆ¬ä¾†èªªæœ€å¥½é¸æ“‡ä½¿ç”¨ protected attributes</li>
<li>å”¯ä¸€å¾—èªçœŸè€ƒæ…®ä½¿ç”¨ private attributes çš„æ™‚æ©Ÿï¼Œæ˜¯æ“”å¿ƒå­é¡åˆ¥æœƒæœ‰åç¨±è¡çªçš„æ™‚å€™</li>
</ul>
<h2 id="_3">ç¬¬å››ç« ï¼š å…ƒé¡åˆ¥èˆ‡å±¬æ€§</h2>
<h3 id="33-34-35">ä½œæ³•33, 34, 35</h3>
<ul>
<li>Metaclass çš„æ‡‰ç”¨<ul>
<li>é©—è­‰ subclass æ˜¯å¦æœ‰è¢«æ­£ç¢ºå®šç¾©</li>
<li>è¨»å†Š class çš„å­˜åœ¨</li>
<li>åœ¨ä¸€å€‹ class è¢«å¯¦éš›ä½¿ç”¨å‰ï¼Œä¿®æ”¹å…¶ç‰¹æ€§</li>
</ul>
</li>
</ul>
<h2 id="_4">ç¬¬äº”ç« ï¼š å…±æ™‚èˆ‡å¹³è¡Œè™•ç†</h2>
<ul>
<li>å…±æ™‚ (concurrency): ä½œæ¥­ç³»çµ±æœƒåœ¨å–®ä¸€è™•ç†å™¨å¿«é€Ÿåˆ‡æ›å¤šå€‹åŸ·è¡Œç¨‹å¼</li>
<li>å¹³è¡Œè™•ç† (parallelism): çœŸæ­£åœ¨åŒä¸€æ™‚é–“åŸ·è¡Œè¨±å¤šå·¥ä½œçš„è™•ç†æ–¹å¼</li>
</ul>
<h3 id="38-lock-data-race">ä½œæ³•38: ä½¿ç”¨ Lock ä¾†é¿å…åŸ·è¡Œç·’ä¸­çš„ data race</h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Count</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">increment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">+=</span> <span class="n">offset</span>
</code></pre></div>
<p>å¦‚æœç”¨ thread å»è·‘ <code>increment</code> æœƒé€ æˆ data race<br/>
åŸå› æ˜¯</p>
<div class="highlight"><pre><span></span><code><span class="n">counter</span><span class="o">.</span><span class="n">count</span> <span class="o">+=</span> <span class="n">offset</span>
</code></pre></div>
<p>å¯¦éš›ä¸ŠåŸ·è¡Œäº†ä¸‰å€‹ operation<br/>
ç­‰æ•ˆæ–¼ä»¥ä¸‹çš„ç¨‹å¼ç¢¼</p>
<div class="highlight"><pre><span></span><code><span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">counter</span><span class="p">,</span> <span class="s2">"count"</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">value</span> <span class="o">+</span> <span class="n">offset</span>
<span class="nb">setattr</span><span class="p">(</span><span class="n">counter</span><span class="p">,</span> <span class="s2">"count"</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</code></pre></div>
<p>é€™æ™‚å€™å¿…é ˆåœ¨ <code>increment</code> åŠ ä¸Š <code>Lock</code> é¿å… data race</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">LockingCounter</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock</span> <span class="o">=</span> <span class="n">Lock</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">increment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">+=</span> <span class="n">offset</span>
</code></pre></div>
<h3 id="39-queue">ä½œæ³•39: ä½¿ç”¨ Queue ä¾†å”èª¿åŸ·è¡Œç·’ä¹‹é–“çš„å·¥ä½œ</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">queue</span> <span class="kn">import</span> <span class="n">Queue</span>

<span class="n">queue</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">consumer</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"consumer waiting"</span><span class="p">)</span>
    <span class="n">queue</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"consumer done"</span><span class="p">)</span>


<span class="n">thread</span> <span class="o">=</span> <span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">consumer</span><span class="p">)</span>
<span class="n">thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Producer putting"</span><span class="p">)</span>
<span class="n">queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="nb">object</span><span class="p">())</span>
<span class="n">thread</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Producer done"</span><span class="p">)</span>
</code></pre></div>
<h3 id="41-concurrentfutures">ä½œæ³•41: è€ƒæ…®ä½¿ç”¨ concurrent.futures ä¾†é”æˆçœŸæ­£çš„å¹³è¡Œè™•ç†</h3>
<ul>
<li><code>from concurrent.futures import multiprocessing</code><ul>
<li>è—‰ç”±åŸ·è¡Œé¡å¤–çš„ç›´è­¯å™¨ä½œç‚º child processesã€‚å› ç‚ºé€™äº› child processes è·Ÿä¸»ç›´è­¯å™¨æ˜¯åˆ†é–‹çš„ï¼Œæ‰€ä»¥å®ƒå€‘çš„ GIL ä¹Ÿæ˜¯åˆ†é–‹çš„</li>
</ul>
</li>
<li>ä½¿ç”¨ multiprocessing çš„æˆæœ¬å¾ˆé«˜<ul>
<li>å› ç‚º main process å’Œ child processes çš„æºé€šéœ€è¦é€é serialization å’Œ deserialization</li>
</ul>
</li>
<li>multiprocessing é©åˆ<ul>
<li>isolated: ä¸å¿…èˆ‡ç¨‹å¼å…¶ä»–éƒ¨åˆ†å…±ç”¨ç‹€æ…‹çš„ function</li>
<li>high-leverage: åœ¨ main process å’Œ child processes åªéœ€è¦è½‰ç§»å°‘é‡çš„è³‡æ–™ï¼Œå°±èƒ½é€²è¡Œå¤§é‡è¨ˆç®—çš„ç‹€æ³</li>
</ul>
</li>
<li>multiprocessing æœ€å¥½åªç”¨åˆ° <code>concurrent.futures</code> çš„ built-in module å’Œ <code>ProcessPoolExecutor</code> class<ul>
<li>å…¶ä»–éƒ¨åˆ†éæ–¼è¤‡é›œï¼Œå»ºè­°é¿å…</li>
</ul>
</li>
</ul>
<h2 id="_5">ç¬¬å…­ç« ï¼š å…§å»ºæ¨¡çµ„</h2>
<h3 id="34-contextlib-with-statement-tryfinally">ä½œæ³•34: è€ƒæ…®ä½¿ç”¨ contextlib èˆ‡ with statement ä¾†å»ºç«‹å¯é‡ç”¨çš„ try/finally è¡Œç‚º</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">contextlib</span> <span class="kn">import</span> <span class="n">contextmanager</span>


<span class="nd">@contextmanager</span>
<span class="k">def</span> <span class="nf">log_level</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">old_level</span> <span class="o">=</span> <span class="n">logger</span><span class="o">.</span><span class="n">getEffectiveLevel</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">logger</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">old</span><span class="p">)</span>


<span class="k">with</span> <span class="n">log_level</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">,</span> <span class="s2">"mylog"</span><span class="p">)</span> <span class="k">as</span> <span class="n">logger</span><span class="p">:</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">"This is my message!"</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debut</span><span class="p">(</span><span class="s2">"This will not print"</span><span class="p">)</span>
</code></pre></div>
<ul>
<li><code>yield</code> å‰æ˜¯ contextmanager çš„ <code>__enter__</code> æœƒåŸ·è¡Œçš„éƒ¨åˆ†ï¼Œä¹‹å¾Œå‰‡æ˜¯ <code>__exit__</code></li>
</ul>
<h3 id="45-datetime-time">ä½œæ³•45: æœ¬åœ°æ™‚é˜ä½¿ç”¨ datetime è€Œé time</h3>
<ul>
<li>æ­é… <code>pytz</code> module ä¾†ä½¿ç”¨ <code>datetime</code> built-in module åœ¨ä¸åŒæ™‚å€çš„æ™‚é–“ä¹‹é–“ä½œè½‰æ›</li>
<li>è™•ç†éç¨‹ä¸­ï¼Œæ°¸é ç”¨ UTC ä¾†è¨˜éŒ„ï¼Œå‘ˆç¾çµ¦ä½¿ç”¨è€…å‰æ‰è½‰æ›</li>
</ul>
<h2 id="_6">ç¬¬ä¸ƒç« ï¼š å”ä½œ</h2>
<h3 id="49-function-class-module-docstrings">ä½œæ³•49: ç‚ºæ¯å€‹ function, class, module æ’°å¯« Docstrings</h3>
<ul>
<li>
<p>General Docstring Guide</p>
<ul>
<li>ç”¨3å€‹ double quotes (<code>"""</code>) é–‹é ­</li>
<li>ç¬¬ä¸€è¡Œæ‡‰è©²æ˜¯å–®ä¸€å¥å­ï¼Œä¾†æå¯«ç”¨é€”</li>
<li>æ¥ä¸‹ä¾†çš„æ–‡å­—å«æœ‰ä½¿ç”¨è€…æ‡‰è©²çŸ¥é“çš„ä½œæ¥­ç´°ç¯€</li>
</ul>
</li>
<li>
<p>class</p>
<ul>
<li>å°‡é‡è¦çš„ public attribute å’Œ method åœ¨ class level çš„ docstring å¯«å‡º</li>
</ul>
</li>
<li>public function / method<ul>
<li>å¯«ä¸Š function çš„ç‰¹æ®Šè¡Œç‚º, argument å’Œ return value</li>
<li>å¦‚æœæ²’æœ‰ argument, return valueï¼Œå–®å¥æè¿°æ‡‰è©²å°±å¤ äº†</li>
<li>å¦‚æœä¸æœƒå›å‚³ä»»ä½•æ±è¥¿ï¼Œå°±ä¸è¦æåˆ° return valueï¼Œè€Œä¸æ˜¯å¯« "return None"</li>
<li>å¦‚æœæœ‰ç”¨åˆ°æ•¸ç›®ä¸å®šçš„ argument , keyword-argumentï¼Œæ‡‰è©²ç”¨ <code>*args</code>, <code>**kwargs</code>ä¾†æè¿°</li>
<li>å¦‚æœæœ‰ default argument éƒ½æ‡‰è©²è¢«æåŠ</li>
<li>å¦‚æœæ˜¯ä¸€å€‹ generatorï¼Œæ‡‰è©²æè¿° iterate æ™‚æœƒ yield ä»€éº¼</li>
<li>å¦‚æœæ˜¯ coroutineï¼Œæ‡‰è©²æè¿°<ul>
<li>æœƒç”¢ç”Ÿä»€éº¼</li>
<li>é æœŸå¾ yield æ”¶åˆ°ä»€éº¼</li>
<li>ä»€éº¼æ™‚å€™æœƒåœæ­¢</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="50-package-module-api">ä½œæ³•50: ä½¿ç”¨ package ä¾†çµ„ç¹” module ä¸¦æä¾›ç©©å®šçš„ API</h3>
<ul>
<li>Python å¯ä»¥é€é module æˆ– package çš„ <code>__all__</code> ç‰¹æ®Šå±¬æ€§ä¾†é™åˆ¶è¦æš´éœ²çµ¦ API ä½¿ç”¨è€…çš„ã€Œè¡¨é¢ç©ã€<ul>
<li>å¦‚æ­¤å³ä½¿é‡æ§‹ä¹Ÿä¸æœƒå½±éŸ¿åˆ°ä½¿ç”¨è€…</li>
<li>é€™åœ¨æä¾›æ˜ç¢ºã€ç©©å®šã€çµ¦å¤–éƒ¨ä½¿ç”¨çš„ API æ˜¯å€‹å¾ˆå¥½çš„åšæ³•</li>
<li>å¦‚æœåªæ˜¯åœ¨å»ºç½®è‡ªå·± module é–“ä½¿ç”¨çš„ API å‰‡æ˜¯æ‡‰è©²é¿å…çš„åšæ³•</li>
</ul>
</li>
<li>ç›¡å¯èƒ½ä½¿ç”¨ <code>from x import y</code>ï¼Œè€Œä¸æ˜¯ <code>import *</code><ul>
<li><code>import *</code> å¯èƒ½é€ æˆè®Šæ•¸åç¨±è¤‡å¯«ï¼Œè€Œä¸”ä¸å®¹æ˜“è¢« debug</li>
</ul>
</li>
</ul>
<h3 id="51-root-exception-api">ä½œæ³•51: å®šç¾©ä¸€å€‹ root exception ä¾†éš”é›¢å‘¼å«è€…èˆ‡ API</h3>
<ul>
<li>ç‚ºä»€éº¼è¦è‡ªå®šç¾©ä¸€å€‹ root exception?<ul>
<li>è®“ä½¿ç”¨è€…çŸ¥é“ä»–å€‘ä»¥éŒ¯èª¤çš„ç”¨æ³•ä½¿ç”¨äº†ä½ çš„ API</li>
<li>å¹«åŠ©ä½ æ‰¾å‡º API ä¸­çš„ bug â†’ åªè¦ä¸æ˜¯æå‡ºé€™äº›è‡ªå®šç¾©çš„ä¾‹å¤–ï¼Œå°±å¾ˆå¯èƒ½æ˜¯ bug çš„æ‰€åœ¨</li>
</ul>
</li>
</ul>
<h3 id="52">ä½œæ³•52: çŸ¥é“å¦‚ä½•æ‰“ç ´å¾ªç’°ä¾å­˜æ€§</h3>
<ul>
<li>
<p>æœ€å¥½çš„åšæ³•æ˜¯é‡æ§‹ç¨‹å¼ç¢¼</p>
<ul>
<li>ä½†æœ‰æ™‚å€™æ¸…æ¥šçš„åŠƒåˆ†ç›¸ç•¶å›°é›£ï¼Œæˆ– cost å¤ªé«˜äº†ï¼Œå› æ­¤é‚„æ˜¯éœ€è¦çŸ¥é“å¦‚ä½•æ‰“ç ´å¾ªç’°ä¾å­˜æ€§</li>
</ul>
</li>
<li>
<p>è§£æ³•ä¸€ï¼š é‡æ–°å®‰æ’åŒ¯å…¥é †åº</p>
<ul>
<li>é€™æ˜¯ä¸€å€‹æ¯”è¼ƒä¸å¥½çš„åšæ³•ï¼Œé•åäº† PEP 8ï¼Œä¸”å®¹æ˜“è®“ç¨‹å¼ç¢¼ç¨å¾®çš„ä¿®æ”¹å°±é€ æˆå•é¡Œ</li>
</ul>
</li>
<li>è§£æ³•äºŒï¼š import, configure and execute<ul>
<li>è®“ module åªä½œå®šç¾© function, class å’Œ constantï¼Œä¸åšå¯¦éš›åŸ·è¡Œ</li>
<li>æ¯å€‹ module æä¾›ä¸€å€‹ configure å‡½å¼ï¼Œè®“æ‰€æœ‰ module éƒ½å®ŒæˆåŒ¯å…¥å¾Œæ‰å‘¼å«</li>
<li>è¨±å¤šç‹€æ³ä¸‹éƒ½èƒ½é‹ä½œè‰¯å¥½ï¼Œä¸¦ä¸”è®“ dependency injection è®Šå¾—å¯èƒ½</li>
<li>ç¼ºé»<ul>
<li>å¾ˆé›£é‡æ–°çµ„ç¹”ç¨‹å¼ç¢¼æ¶æ§‹</li>
<li>å› ç‚ºç‰©ä»¶çš„å®šç¾©å’Œ configuration åœ¨ä¸åŒçš„åœ°æ–¹ï¼Œé€ æˆç¨‹å¼ç¢¼æ›´é›£é–±è®€</li>
</ul>
</li>
</ul>
</li>
<li>è§£æ³•ä¸‰ï¼š å‹•æ…‹åŒ¯å…¥<ul>
<li>é€šå¸¸æ˜¯æœ€ç°¡å–®çš„è§£æ³•</li>
<li>åœ¨ function/method ä¸­æ‰ä½¿ç”¨ import</li>
<li>ä½†ä¸€èˆ¬ä¾†èªªä¾†æ˜¯æœ€å¥½é¿å…ï¼Œ import çš„ cost ä¸¦æ²’æœ‰å°åˆ°å¯ä»¥è¢«å¿½ç•¥</li>
</ul>
</li>
</ul>
<h2 id="_7">ç¬¬å…«ç« ï¼š æ¨å‡ºç”¢å“</h2>
<h3 id="57-pdb">ä½œæ³•57: è€ƒæ…®ä½¿ç”¨ pdb ä¾†é€²è¡Œäº’å‹•å¼é™¤éŒ¯</h3>
<ul>
<li>åœ¨ç¨‹å¼ç¢¼åŠ å…¥ä»¥ä¸‹é€™è¡Œï¼Œå°±èƒ½è®“ç¨‹å¼åŸ·è¡Œåˆ°é€™ä¸€æ­¥æ™‚åœä¸‹ï¼Œé–‹å•Ÿäº’å‹•å¼çš„ python shell</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pdf</span>

<span class="n">pdf</span><span class="o">.</span><span class="n">set_trace</span><span class="p">()</span>
</code></pre></div>
<ul>
<li>æª¢è¦–åŸ·è¡Œä¸­çš„ç¨‹å¼<ul>
<li><code>bt</code>: å°å‡ºç›®å‰ call stack çš„ traceback</li>
<li><code>up</code>: ä¸Šç§» call stack</li>
<li><code>down</code>: ä¸‹ç§» call stack</li>
</ul>
</li>
<li>æ¢å¾©ç¨‹å¼çš„åŸ·è¡Œ<ul>
<li><code>step</code>: åŸ·è¡Œç¨‹å¼ï¼Œç›´åˆ°ä¸‹ä¸€è¡Œ</li>
<li><code>next</code>: åŸ·è¡Œç¨‹å¼ï¼Œç›´åˆ°é‡åˆ°ç›®å‰å‡½å¼çš„ä¸‹ä¸€è¡Œ</li>
<li><code>return</code>: åŸ·è¡Œç¨‹å¼ï¼Œç›´åˆ°ç›®å‰å‡½å¼å›å‚³</li>
<li><code>continue</code>: åŸ·è¡Œç¨‹å¼ï¼Œç›´åˆ°ä¸‹ä¸€å€‹ breakpoint æˆ– set_trace å†è¢«å‘¼å«</li>
</ul>
</li>
</ul>
<h3 id="58">ä½œæ³•58: æœ€ä½³åŒ–ä¹‹å‰å…ˆé€²è¡Œæ•ˆèƒ½è©•ä¼°</h3>
<ul>
<li>ä½¿ç”¨ <code>cProfile</code> module è€Œé <code>profile</code> module<ul>
<li>å› ç‚ºå°ç¨‹å¼æ•ˆèƒ½çš„å½±éŸ¿è¼ƒå°</li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">cProfile</span> <span class="kn">import</span> <span class="n">Profile</span>
<span class="kn">from</span> <span class="nn">pstats</span> <span class="kn">import</span> <span class="n">Stats</span>

<span class="c1"># some program to test</span>
<span class="kn">import</span> <span class="nn">test</span>

<span class="n">profiler</span> <span class="o">=</span> <span class="n">Profile</span><span class="p">()</span>
<span class="n">profiler</span><span class="o">.</span><span class="n">runcall</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>

<span class="n">stats</span> <span class="o">=</span> <span class="n">Stats</span><span class="p">(</span><span class="n">profiler</span><span class="p">)</span>
<span class="n">stats</span><span class="o">.</span><span class="n">strip_dirs</span><span class="p">()</span>
<span class="n">stats</span><span class="o">.</span><span class="n">sort_stats</span><span class="p">(</span><span class="s2">"cumulative"</span><span class="p">)</span>
<span class="n">stats</span><span class="o">.</span><span class="n">print_stats</span><span class="p">()</span>
</code></pre></div>
<h3 id="59-tracemalloc">ä½œæ³•59: ä½¿ç”¨ tracemalloc ä¾†äº†è§£è¨˜æ†¶é«”ç”¨é‡æˆ–æ˜¯å¦æœ‰æ´©æ¼</h3>
<ul>
<li>Python çš„é è¨­å¯¦ä½œ CPython ä¸­ï¼Œè¨˜æ†¶é«”ç®¡ç†çš„æ–¹å¼æ˜¯ä½¿ç”¨ reference counting</li>
<li>Python 3.4 ä»¥å¾Œå¯ä»¥ä½¿ç”¨ tracemalloc</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">tracemalloc</span>

<span class="n">tracemalloc</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="n">time1</span> <span class="o">=</span> <span class="n">tracemalloc</span><span class="o">.</span><span class="n">take_snapshot</span><span class="p">()</span>

<span class="c1"># some code that waste memory</span>

<span class="n">time2</span> <span class="o">=</span> <span class="n">tracemallo</span><span class="o">.</span><span class="n">take_snapshot</span><span class="p">()</span>

<span class="n">stats</span> <span class="o">=</span> <span class="n">time2</span><span class="o">.</span><span class="n">compare_to</span><span class="p">(</span><span class="n">time1</span><span class="p">,</span> <span class="s2">"lineno"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">stat</span> <span class="ow">in</span> <span class="n">stats</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">stat</span><span class="p">)</span>
</code></pre></div>
</section>
<section class="post-footer">
<div class="post-share">
<span class="post-info-label">Share</span>
<a aria-label="Twitter" class="twitter" href="https://twitter.com/share?text=[Note] Effective Python&amp;url=https://blog.wei-lee.me/posts/tech/2019/01/effective-python" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235'); return false;" title="Twitter">
<i aria-hidden="true" class="fab fa-twitter"></i>
<span class="hidden">Twitter</span>
</a>
<a aria-label="Facebook" class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.wei-lee.me/posts/tech/2019/01/effective-python" onclick="window.open(this.href, 'facebook-share', 'width=580,height=296'); return false;" title="Facebook">
<i aria-hidden="true" class="fa-brands fa-facebook"></i>
<span class="hidden">Facebook</span>
</a>
<a aria-label="LinkedIn" class="linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://blog.wei-lee.me/posts/tech/2019/01/effective-python&amp;title=[Note] Effective Python" onclick="window.open(this.href, 'linkedin-share', 'width=930,height=720'); return false;" title="LinkedIn">
<i aria-hidden="true" class="fa-brands fa-linkedin"></i>
<span class="hidden">LinkedIn</span>
</a>
<a aria-label="Mastodon" class="mastodon" href="https://mtd.pythonasia.org/share?text=%5BNote%5D%20Effective%20Python%20https%3A//blog.wei-lee.me/posts/tech/2019/01/effective-python" onclick="window.open(this.href, 'mastodon-share', 'width=930,height=720'); return false;" title="Mastodon">
<i aria-hidden="true" class="fa-brands fa-mastodon fa-xl" style="color: #74C0FC;"></i>
<span class="hidden">Mastodon</span>
</a>
<a aria-label="Email" class="email" href="mailto:?subject=[Note] Effective Python&amp;body=https://blog.wei-lee.me/posts/tech/2019/01/effective-python" title="Email">
<i aria-hidden="true" class="fa-solid fa-envelope"></i>
<span class="hidden">Email</span>
</a>
<div class="clear"></div>
</div>
<aside class="post-tags">
<a href="https://blog.wei-lee.me/tag/python.html">Python</a><a href="https://blog.wei-lee.me/tag/note.html">Note</a> </aside>
<div class="clear"></div>
</section>
<aside class="post-nav">
<a class="post-nav-next" href="https://blog.wei-lee.me/posts/tech/2019/04/sitcon-2019">
<section class="post-nav-teaser">
<i class="icon icon-arrow-left"></i>
<h2 class="post-nav-title">SITCON 2019</h2>
<p class="post-nav-excerpt">SITCON éƒ½éäº†å…©å€‹ç¦®æ‹œ å¥½ä¸å®¹æ˜“æ‰é¨°å‡ºå€‹æ™‚é–“æ•´ç†ä¸€ä¸‹æƒ³æ³• æƒ³æƒ³å»å¹´çš„ X-Village çš„æƒ³æ³•ä¹Ÿä¸€ç›´é‚„æ²’å¥½å¥½å¯«å®Œ å…©å€‹ç¦®æ‹œä¼¼ä¹ä¹Ÿä¸ç®—å¤ªä¹…ï¼ˆï¼Ÿ</p>
<p class="post-nav-meta"><time datetime="2019/04/06 - Sat">2019/04/06 - Sat</time></p>
</section>
</a>
<a class="post-nav-prev" href="https://blog.wei-lee.me/posts/book/2019/01/think-through-note-taking">
<section class="post-nav-teaser">
<i class="icon icon-arrow-right"></i>
<h2 class="post-nav-title">[Book] é›»è…¦ç©ç‰©ç«™é•·çš„ç­†è¨˜æ€è€ƒè¡“</h2>
<p class="post-nav-excerpt">å»å¹´å‰›çœ‹å®Œé€™æœ¬æ›¸çš„æ™‚å€™ï¼Œå¯¦åœ¨è¦ºå¾—è·Ÿæƒ³åƒçš„å¾ˆä¸ä¸€æ¨£ ç›´åˆ°ç¾åœ¨çµ‚æ–¼æœ‰ç©ºå¥½å¥½çš„å†ç¿»éä¸€éï¼Œåšä¸€äº›ç´€éŒ„äº†</p>
<p class="post-nav-meta"><time datetime="2019/01/07 - Mon">2019/01/07 - Mon</time></p>
</section>
</a>
<div class="clear"></div>
</aside>
</div>
<script type="text/javascript">var use_utterance = true;</script>
<section class="post-comments">
<script async="" crossorigin="anonymous" data-issue-term="https://blog.wei-lee.me/posts/tech/2019/01/effective-python" data-label="blog-comment" data-repo="Lee-W/main-blog" data-theme="github-light" src="https://utteranc.es/client.js">
</script>
</section>
</article>
</main>
<div class="nav-footer">
<nav aria-label="Footer" class="nav-wrapper">
<span class="nav-copy">Those aren't written down are meant to be forgotten Â© 2023
          <a class="nav-rss" href="https://blog.wei-lee.me/feeds/all.atom.xml" target="_blank" title="RSS"><i class="icon icon-rss"></i></a>
</span>
<span class="nav-credits">



          Published with <a href="https://github.com/getpelican/pelican" rel="nofollow">Pelican</a> â€¢ Theme <a href="https://github.com/arulrajnet/attila" rel="nofollow">Attila</a> â€¢
          <a class="menu-item js-theme" data-dark="Dark theme" data-light="Light theme" data-system="System theme" href="#">
<span class="theme-icon"></span><span class="theme-text">System theme</span>
</a>
</span>
</nav>
</div>
</section>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.slim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"></script>
<!-- TODO: minify -->
<script src="https://blog.wei-lee.me/theme/js/jquery.fitvids.js" type="text/javascript"></script>
<script src="https://blog.wei-lee.me/theme/js/script.js" type="text/javascript"></script>
<script src="https://blog.wei-lee.me/theme/js/clipboard.min.js" type="text/javascript"></script>
<script src="https://blog.wei-lee.me/theme/js/copy-to-clipboard.js" type="text/javascript"></script>
<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-3J7XQ46QH5"></script>
<script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-3J7XQ46QH5', { 'anonymize_ip': true });
    </script>
<script src="/pagefind/pagefind-ui.js"></script>
<script>
      window.addEventListener('DOMContentLoaded', (event) => {
          new PagefindUI({
              element: "#search",
              showImages: false,
          });
      });
  </script>
<!-- 	The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in article.html, but it needs to be included down here, after jQuery has already loaded. -->
<!-- Add MathJax and FontAwesome for Asciidoc -->\
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" rel="stylesheet"/>
<script>
  $(document).ready(function () {
    var viewport = $(window);
    var post = $('.post-content');
    // Responsive videos with fitVids
    post.fitVids();

    var mdSelector=".highlight pre code";
    var rstSelector=".highlight pre code";
    // For ":source-highlighter: highlight.js`" in asciidoc
    var adocSelector="pre.highlight > code[data-lang]"
    var selector=mdSelector;
    // Format code blocks and add line numbers
    function codestyling() {
      $(selector).each(function(i, e) {
        // Code highlight
        hljs.highlightElement(e);
        // No lines for plain text blocks
        if (!$(this).hasClass('language-text')) {
          var code = $(this);
          // Calculate amount of lines
          var lines = code.html().split(/\n(?!$)/g).length;
          var numbers = [];
          if (lines > 1) {
            lines++;
          }
          for (i = 1; i < lines; i++) {
            numbers += '<span class="line" aria-hidden="true">' + i + '</span>';
          }
          code.parent().append('<div class="lines">' + numbers + '</div>');
        }
      });
    }

    // Format code blocks only
    function codestylingWithoutLineNumbers() {
      $(selector).each(function(i, e) {
        // Code highlight
        hljs.highlightElement(e);
      });
    }

    codestylingWithoutLineNumbers();
    // Reading progress bar on window top
    function readingProgress() {
      var postBottom = post.offset().top + post.height();
      var viewportHeight = viewport.height();
      var progress = 100 - (((postBottom - (viewport.scrollTop() + viewportHeight) + viewportHeight / 3) / (postBottom - viewportHeight + viewportHeight / 3)) * 100);
      $('.progress-bar').css('width', progress + '%');
      (progress > 100) ? $('.progress-container').addClass('complete'): $('.progress-container').removeClass('complete');
    }
    readingProgress();
    // Trigger reading progress
    viewport.on({
      'scroll': function() {
        readingProgress();
      },
      'resize': function() {
        readingProgress();
      },
      'orientationchange': function() {
        readingProgress();
      }
    });

  });
</script>
</body>
</html>
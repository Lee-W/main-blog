
<!DOCTYPE html>

<html lang="zh-tw">
<head>
<meta charset="utf-8"/>
<meta charset="utf-8" content="text/html" http-equiv="Content-Type">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"/>
<title>[Note] Effective Python </title>
<meta content="True" name="HandheldFriendly"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="origin" name="referrer"/>
<meta content="Pelican" name="generator"/>
<link href="https://blog.wei-lee.me/posts/tech/2019/01/effective-python" rel="canonical"/>
<!-- Feed -->
<link href="https://blog.wei-lee.me/feeds/all.atom.xml" rel="alternate" title="Those aren't written down are meant to be forgotten Full Atom Feed" type="application/atom+xml"/>
<!-- TODO: combine -->
<link href="https://blog.wei-lee.me/theme/css/style.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/pygments.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/pagefind-ui-custom.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/code.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/code-copy.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/custom.css" rel="stylesheet" type="text/css"/>
<link href="/pagefind/pagefind-ui.css" rel="stylesheet"/>
<!-- Custom fonts -->
<link href="https://fonts.googleapis.com/css?family=Montserrat:400,300" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css"/>
<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
<script>
    var siteUrl = 'https://blog.wei-lee.me';
  </script>
<script>
    var localTheme = localStorage.getItem('attila_theme');
    switch (localTheme) {
      case 'dark':
        document.documentElement.classList.add('theme-dark');
        break;
      case 'light':
        document.documentElement.classList.add('theme-light');
        break;
      default:
        break;
    }
  </script>
<meta content="第二次看過終於有辦法把原本看不懂的部分都看懂了 那些看不懂的大多是很抽象化的技巧 但是啊，看懂了這些語法 現在的我還是沒有能力，將這些抽象化應用在我自己的程式中 不過其他大部分比較簡單的在看過一次 還是提醒我在每一個眉眉角角都還要再更注意 上次看過的還沒有全部都應用到我寫程式的習慣中呢" name="description"/>
<meta content="Wei Lee" name="author"/>
<meta content="Python" name="tags"/>
<meta content="Note" name="tags"/>
<!-- Open Graph -->
<meta content="Those aren't written down are meant to be forgotten" prefix="og: http://ogp.me/ns#" property="og:site_name">
<meta content="[Note] Effective Python " prefix="og: http://ogp.me/ns#" property="og:title">
<meta content="第二次看過終於有辦法把原本看不懂的部分都看懂了 那些看不懂的大多是很抽象化的技巧 但是啊，看懂了這些語法 現在的我還是沒有能力，將這些抽象化應用在我自己的程式中 不過其他大部分比較簡單的在看過一次 還是提醒我在每一個眉眉角角都還要再更注意 上次看過的還沒有全部都應用到我寫程式的習慣中呢" prefix="og: http://ogp.me/ns#" property="og:description">
<meta content="zh-tw" prefix="og: http://ogp.me/ns#" property="og:locale">
<meta content="https://blog.wei-lee.me/posts/tech/2019/01/effective-python" prefix="og: http://ogp.me/ns#" property="og:url"/>
<meta content="article" prefix="og: http://ogp.me/ns#" property="og:type"/>
<meta content="2019-01-19 16:45:00+08:00" prefix="og: http://ogp.me/ns#" property="article:published_time"/>
<meta content="" prefix="og: http://ogp.me/ns#" property="article:modified_time"/>
<meta content="https://blog.wei-lee.me/author/wei-lee.html" prefix="og: http://ogp.me/ns#" property="article:author"/>
<meta content="Tech" prefix="og: http://ogp.me/ns#" property="article:section">
<meta content="Python" prefix="og: http://ogp.me/ns#" property="article:tag"/>
<meta content="Note" prefix="og: http://ogp.me/ns#" property="article:tag"/>
<meta content="https://blog.wei-lee.me//images/cover.jpeg" prefix="og: http://ogp.me/ns#" property="og:image"/>
<!-- Twitter Card -->
<meta content="summary_large_image" name="twitter:card"/>
<meta content="@clleew" name="twitter:site"/>
<meta content="[Note] Effective Python " name="twitter:title"/>
<meta content="https://blog.wei-lee.me/posts/tech/2019/01/effective-python" name="twitter:url"/>
<meta content="https://blog.wei-lee.me//images/cover.jpeg" name="twitter:image:src"/>
<meta content="第二次看過終於有辦法把原本看不懂的部分都看懂了 那些看不懂的大多是很抽象化的技巧 但是啊，看懂了這些語法 現在的我還是沒有能力，將這些抽象化應用在我自己的程式中 不過其他大部分比較簡單的在看過一次 還是提醒我在每一個眉眉角角都還要再更注意 上次看過的還沒有全部都應用到我寫程式的習慣中呢" name="twitter:description"/>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "name": "[Note] Effective Python",
  "headline": "[Note] Effective Python",
  "datePublished": "2019-01-19 16:45:00+08:00",
  "dateModified": "",
  "author": {
    "@type": "Person",
    "name": "Wei Lee",
    "url": "https://blog.wei-lee.me/author/wei-lee.html"
  },
  "image": "https://blog.wei-lee.me//images/cover.jpeg",
  "url": "https://blog.wei-lee.me/posts/tech/2019/01/effective-python",
  "description": "第二次看過終於有辦法把原本看不懂的部分都看懂了 那些看不懂的大多是很抽象化的技巧 但是啊，看懂了這些語法 現在的我還是沒有能力，將這些抽象化應用在我自己的程式中 不過其他大部分比較簡單的在看過一次 還是提醒我在每一個眉眉角角都還要再更注意 上次看過的還沒有全部都應用到我寫程式的習慣中呢"
}
</script>
</meta></meta></meta></meta></meta></link></meta><link href="https://blog.wei-lee.me/posts/tech/2019/01/effective-python" rel="canonical"/><script type="application/ld+json">{"@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [{"@type": "ListItem", "position": 1, "name": "Those aren't written down are meant to be forgotten", "item": "https://blog.wei-lee.me"}, {"@type": "ListItem", "position": 2, "name": "Posts", "item": "https://blog.wei-lee.me/posts"}, {"@type": "ListItem", "position": 3, "name": "Tech", "item": "https://blog.wei-lee.me/posts/tech"}, {"@type": "ListItem", "position": 4, "name": "2019", "item": "https://blog.wei-lee.me/posts/tech/2019"}, {"@type": "ListItem", "position": 5, "name": "01", "item": "https://blog.wei-lee.me/posts/tech/2019/01"}, {"@type": "ListItem", "position": 6, "name": "Effective python", "item": "https://blog.wei-lee.me/posts/tech/2019/01/effective-python"}, {"@type": "ListItem", "position": 7, "name": "Index", "item": "https://blog.wei-lee.me/posts/tech/2019/01/effective-python/index.html"}]}</script><script type="application/ld+json">{"@context": "https://schema.org", "@type": "Article", "author": {"@type": "Person", "name": "Wei Lee"}, "publisher": {"@type": "Organization", "name": "Those aren't written down are meant to be forgotten"}, "headline": "[Note] Effective Python", "about": "Tech", "datePublished": "2019-01-19 16:45"}</script></head>
<body class="category-template">
<div class="nav-header">
<nav aria-label="Main" class="nav-wrapper">
<ul>
<li class="nav-🏠 Home" role="presentation"><a href="/"><span>🏠 Home</span></a></li>
<li class="nav-About Me" role="presentation"><a href="/pages/about-me.html"><span>About Me</span></a></li>
<li class="nav-🗄️ Archives" role="presentation"><a href="/archives.html"><span>🗄️ Archives</span></a></li>
<li class="nav-📚 Series" role="presentation"><a href="/series_list.html"><span>📚 Series</span></a></li>
<li class="nav-🔍 Search" role="presentation"><a href="/search.html"><span>🔍 Search</span></a></li>
<li role="presentation"><a href="https://blog.wei-lee.me/category/book.html"><span>Book</span></a></li>
<li role="presentation"><a href="https://blog.wei-lee.me/category/gossiping.html"><span>Gossiping</span></a></li>
<li class="nav-tech active" role="presentation"><a href="https://blog.wei-lee.me/category/tech.html"><span>Tech</span></a></li>
</ul>
<ul class="nav-meta">
<li class="nav-linkedin"><a aria-label="Linkedin" href="https://tw.linkedin.com/in/clleew" target="_blank"><i aria-hidden="true" class="icon icon-linkedin"></i>
<span>Linkedin</span>
</a></li>
<li class="nav-github"><a aria-label="Github" href="https://github.com/Lee-W" target="_blank"><i aria-hidden="true" class="icon icon-github"></i>
<span>GitHub</span>
</a></li>
<li class="nav-twitter"><a aria-label="Twitter" href="https://twitter.com/clleew" target="_blank"><i aria-hidden="true" class="icon icon-twitter"></i>
<span>Twitter</span>
</a></li>
<li class="nav-search" style="display: none;">
<a title="Search">
<i aria-hidden="true" class="icon icon-search"></i>
<span>Search</span>
</a>
</li>
</ul> </nav>
<div class="nav-wrapper-control">
<div class="inner">
<a class="nav-menu" role="button"><i aria-hidden="true" class="icon icon-menu"></i>Menu</a>
<a class="nav-search" role="button" style="display: none;" title="Search"><i aria-hidden="true" class="icon icon-search"></i></a>
</div>
</div>
</div>
<div aria-label="Close" class="nav-close" role="button"></div>
<section class="page-wrapper" id="wrapper">
<!-- Progressbar -->
<div class="progress-container">
<span class="progress-bar"></span>
</div>
<!-- Page Header -->
<!-- Set your background image for this header on the line below. -->
<header class="post-header has-cover">
<div class="inner">
<span class="post-info">
<span class="post-type">Article</span>
<span class="post-count">Tech</span>
</span>
<h1 class="post-title">
            [Note] Effective Python
        </h1>
<div class="post-meta">
<div class="post-meta-avatars">
<figure class="post-meta-avatar avatar">
<a class="author-avatar" href="https://blog.wei-lee.me/author/wei-lee.html">
<img alt="Wei Lee" class="author-profile-image" src="https://blog.wei-lee.me//images/avatar.jpeg"/>
</a>
</figure>
</div>
<h4 class="post-meta-author">
            Wei Lee
          </h4>
<time datetime="2019/01/19 - Sat">2019/01/19 - Sat</time>
          • 5 min read
        </div>
<div class="post-cover cover">
<img alt="Category Tech" src="https://blog.wei-lee.me//images/cover.jpeg"/>
</div>
</div>
</header>
<!-- Post content -->
<main class="content" data-pagefind-body="" role="main">
<article class="post">
<div class="inner">
<section class="post-content">
<p><img alt="effective python" src="/images/books/aE00B2o.jpg"/></p>
<p>第二次看過終於有辦法把原本看不懂的部分都看懂了<br/>
那些看不懂的大多是很抽象化的技巧<br/>
但是啊，看懂了這些語法<br/>
現在的我還是沒有能力，將這些抽象化應用在我自己的程式中<br/>
不過其他大部分比較簡單的在看過一次<br/>
還是提醒我在每一個眉眉角角都還要再更注意<br/>
上次看過的還沒有全部都應用到我寫程式的習慣中呢</p>
<!--more-->
<div class="toc">
<ul>
<li><a href="#pythonic">第一章： Pythonic 思維</a><ul>
<li><a href="#02-pep8">作法02： 遵循 PEP8 風格指南</a></li>
<li><a href="#04">作法04： 撰寫輔助函式而非複雜的運算式</a></li>
<li><a href="#05">作法05: 知道如何切割序列</a></li>
<li><a href="#07-list-comprehension-map-filter">作法07: 使用 list comprehension 而非 map 和 filter</a></li>
<li><a href="#09-generator-list-comprehension">作法09: 考慮使用 generator 取代大型 list comprehension</a></li>
<li><a href="#11-zip-iterables">作法11: 使用 zip 來平行處理 iterables</a></li>
<li><a href="#12-for-while-else">作法12: 避免在 for 或 while 後面使用 else 區塊</a></li>
<li><a href="#13-tryexceptelsefinally">作法13: 善用 try/except/else/finally 中的每個區塊</a></li>
</ul>
</li>
<li><a href="#_1">第二章： 函式</a><ul>
<li><a href="#14-none">作法14: 優先選用例外處理而非回傳 None</a></li>
<li><a href="#20-none-docstrings-mutable-default-arguments">作法20: 使用 None 與 Docstrings 來指定 mutable default arguments</a></li>
<li><a href="#19-keyword-argument-related-to-21">作法19: 以 keyword argument 提供選擇性的行為 (Related to 作法21)</a></li>
<li><a href="#21-keyword-argument">作法21: 強制使用僅限 keyword argument 來讓程式碼更清楚易懂</a></li>
</ul>
</li>
<li><a href="#_2">第三章： 類別與繼承</a><ul>
<li><a href="#22-class-dictionary-tuple">作法22: 優先選用輔助 class 而非使用 dictionary 或 tuple 來管理紀錄</a></li>
<li><a href="#25-super">作法25: 使用 super 來初始化父類別</a></li>
<li><a href="#27">作法27: 優先選用公開屬性而非私有屬性</a></li>
</ul>
</li>
<li><a href="#_3">第四章： 元類別與屬性</a><ul>
<li><a href="#33-34-35">作法33, 34, 35</a></li>
</ul>
</li>
<li><a href="#_4">第五章： 共時與平行處理</a><ul>
<li><a href="#38-lock-data-race">作法38: 使用 Lock 來避免執行緒中的 data race</a></li>
<li><a href="#39-queue">作法39: 使用 Queue 來協調執行緒之間的工作</a></li>
<li><a href="#41-concurrentfutures">作法41: 考慮使用 concurrent.futures 來達成真正的平行處理</a></li>
</ul>
</li>
<li><a href="#_5">第六章： 內建模組</a><ul>
<li><a href="#34-contextlib-with-statement-tryfinally">作法34: 考慮使用 contextlib 與 with statement 來建立可重用的 try/finally 行為</a></li>
<li><a href="#45-datetime-time">作法45: 本地時鐘使用 datetime 而非 time</a></li>
</ul>
</li>
<li><a href="#_6">第七章： 協作</a><ul>
<li><a href="#49-function-class-module-docstrings">作法49: 為每個 function, class, module 撰寫 Docstrings</a></li>
<li><a href="#50-package-module-api">作法50: 使用 package 來組織 module 並提供穩定的 API</a></li>
<li><a href="#51-root-exception-api">作法51: 定義一個 root exception 來隔離呼叫者與 API</a></li>
<li><a href="#52">作法52: 知道如何打破循環依存性</a></li>
</ul>
</li>
<li><a href="#_7">第八章： 推出產品</a><ul>
<li><a href="#57-pdb">作法57: 考慮使用 pdb 來進行互動式除錯</a></li>
<li><a href="#58">作法58: 最佳化之前先進行效能評估</a></li>
<li><a href="#59-tracemalloc">作法59: 使用 tracemalloc 來了解記憶體用量或是否有洩漏</a></li>
</ul>
</li>
</ul>
</div>
<hr/>
<h2 id="pythonic">第一章： Pythonic 思維</h2>
<h3 id="02-pep8">作法02： 遵循 PEP8 風格指南</h3>
<p><a href="https://www.python.org/dev/peps/pep-0008/">PEP8</a><br/>
(我只把我認為容易被忽略或特別重要的幾點留下來)</p>
<ul>
<li>Whitespace<ul>
<li>過長的 expressions 要接續到其他文字行時，除了原本的縮排層次，應再加上額外的<strong>四個空格</strong>來縮排</li>
</ul>
</li>
<li>Naming<ul>
<li>protected instance attributes → _leading_underscore</li>
<li>private instance attributes → __double_leading_underscore</li>
<li>Class, exceptions → CapitalizedWord</li>
<li>model-level constant → ALL_CAPS</li>
</ul>
</li>
<li>
<p>Statements</p>
<ul>
<li>使用行內否定 (inline negation, e.g., <code>if a is not b</code>)，而非否定正向的運算式 (negation of positive expressions, e.g., <code>if not a is b</code>)</li>
<li>別用查驗長度的方式 (<code>if len(somelist) == 0</code>) 來檢查空值。使用 <code>if not somelist</code></li>
<li>避免單行 <code>if</code>, <code>for</code>, <code>while</code>, <code>except</code>，將它們分多行描述以清楚表達</li>
<li>import module 永遠用絕對名稱<ul>
<li>e.g., 用 <code>from bar import foo</code> 而不是 <code>import foo</code></li>
</ul>
</li>
<li>import 順序<ol>
<li>standard library modules</li>
<li>third-party modules</li>
<li>your own modules</li>
</ol>
</li>
</ul>
</li>
<li>
<p>用 <a href="https://www.pylint.org">pylint</a> 來檢查風格</p>
</li>
</ul>
<h3 id="04">作法04： 撰寫輔助函式而非複雜的運算式</h3>
<ul>
<li>將複雜的運算式移到輔助函式 (helper function) 內，特別是在你需要重複用到同樣的邏輯的時候</li>
<li>與其在運算式中使用 <code>or</code> 或 <code>and</code> ，不如使用 <code>if/else</code> 讓程式碼更易讀</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">my_values</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'red'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'5'</span><span class="p">],</span> <span class="n">green</span><span class="p">:</span> <span class="p">[</span><span class="s1">''</span><span class="p">]</span> <span class="p">}</span>

<span class="c1"># or, and</span>
<span class="n">red</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">my_values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'red'</span><span class="p">,</span> <span class="p">[</span><span class="s1">''</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># if/else</span>
<span class="n">red</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">red</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">red</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">else</span> <span class="mi">0</span>

<span class="c1"># even better if/else</span>
<span class="k">if</span> <span class="n">red</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
    <span class="n">red</span> <span class="o">=</span> <span class="n">red</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">red</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># helper function</span>
<span class="k">def</span> <span class="nf">get_first_int</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">found</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">[</span><span class="s1">''</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">found</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">found</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">found</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">found</span> <span class="o">=</span> <span class="n">default</span>
    <span class="k">return</span> <span class="n">found</span>

<span class="n">red</span> <span class="o">=</span> <span class="n">get_first_int</span><span class="p">(</span><span class="n">my_values</span><span class="p">,</span> <span class="s1">'red'</span><span class="p">)</span>
</code></pre></div>
<h3 id="05">作法05: 知道如何切割序列</h3>
<ul>
<li>省略 zero index, 最後的索引來降低視覺雜訊<ul>
<li>用 <code>a[:5]</code>, <code>a[5:]</code> 而不是 <code>a[0:5]</code>, <code>a[5:len(a)]</code></li>
</ul>
</li>
<li>copy value v.s. copy reference</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1"># copy value</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="p">[:]</span>
<span class="k">assert</span> <span class="n">b</span> <span class="o">==</span> <span class="n">a</span>
<span class="k">assert</span> <span class="n">b</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">a</span>

<span class="c1"># copy reference</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">a</span>
<span class="k">assert</span> <span class="n">b</span> <span class="ow">is</span> <span class="n">a</span>
</code></pre></div>
<h3 id="07-list-comprehension-map-filter">作法07: 使用 list comprehension 而非 map 和 filter</h3>
<ul>
<li>避免用 <code>map</code>, <code>filter</code> ，因為使用他們時需要建立一個 <code>lambda</code> ，這是種視覺雜訊</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>

<span class="c1"># list comprehension</span>
<span class="n">squares</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a</span><span class="p">]</span>

<span class="c1"># map</span>
<span class="n">squares</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</code></pre></div>
<h3 id="09-generator-list-comprehension">作法09: 考慮使用 generator 取代大型 list comprehension</h3>
<ul>
<li>對於大型輸入來說 list comprehension 可能耗用相當大量的記憶體</li>
</ul>
<h3 id="11-zip-iterables">作法11: 使用 zip 來平行處理 iterables</h3>
<div class="highlight"><pre><span></span><code><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'a'</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="s1">'c'</span><span class="p">,</span> <span class="s1">'d'</span><span class="p">]</span>

<span class="c1"># without zip</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="c1"># with zip</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div>
<ul>
<li>如果提供了不同長度的 iterables ， zip 會 truncate 掉較長的 input</li>
</ul>
<h3 id="12-for-while-else">作法12: 避免在 for 或 while 後面使用 else 區塊</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># avoid</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="o">...</span>
<span class="k">else</span><span class="p">:</span>
    <span class="o">...</span>
</code></pre></div>
<h3 id="13-tryexceptelsefinally">作法13: 善用 try/except/else/finally 中的每個區塊</h3>
<ul>
<li><code>finally</code><ul>
<li>即使例外發生，但也想要在例外發生時執行清理用的 cleanup code</li>
</ul>
</li>
<li><code>else</code><ul>
<li>如果 try 沒有丟出例外， else 區塊就會執行</li>
<li>用來最小化 try 區塊的程式碼量 → <strong>讓 try 區塊只出現會丟出例外的程式碼</strong></li>
</ul>
</li>
</ul>
<h2 id="_1">第二章： 函式</h2>
<h3 id="14-none">作法14: 優先選用例外處理而非回傳 None</h3>
<ul>
<li>回傳 <code>None</code> 帶有特殊意義的函式容易出錯，因為 <code>None</code> 與其他的值 (e.g., <code>0</code>, <code>[]</code>, <code>''</code>)，在做條件運算式運算的結果都是 <code>False</code></li>
</ul>
<h3 id="20-none-docstrings-mutable-default-arguments">作法20: 使用 None 與 Docstrings 來指定 mutable default arguments</h3>
<ul>
<li>default arguments 只會被 evaluate 一次：模組載入時、函式定義時。對於動態值 (e.g., <code>{}</code>, <code>[]</code>) 來說，這可能導致奇怪的行為</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>

<span class="c1"># The two results would be the same but should be different</span>
<span class="n">func</span><span class="p">()</span>
<span class="n">func</span><span class="p">()</span>
</code></pre></div>
<p><strong>Fix</strong></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Demonstration</span>

<span class="sd">    Args:</span>
<span class="sd">        default: current datetime</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">default</span><span class="p">:</span>
        <span class="n">default</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>
</code></pre></div>
<h3 id="19-keyword-argument-related-to-21">作法19: 以 keyword argument 提供選擇性的行為 (Related to 作法21)</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># original</span>
<span class="k">def</span> <span class="nf">flow_rate</span><span class="p">(</span><span class="n">weight_diff</span><span class="p">,</span> <span class="n">time_diff</span><span class="p">,</span> <span class="n">period</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">weight_diff</span> <span class="o">/</span> <span class="n">time_diff</span><span class="p">)</span> <span class="o">*</span> <span class="n">period</span>

<span class="c1"># with default argument</span>
<span class="k">def</span> <span class="nf">flow_rate</span><span class="p">(</span><span class="n">weight_diff</span><span class="p">,</span> <span class="n">time_diff</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">weight_diff</span> <span class="o">/</span> <span class="n">time_diff</span><span class="p">)</span> <span class="o">*</span> <span class="n">period</span>
</code></pre></div>
<p>不像「作法21」全面採取 keyword argement的原因是為了達到 backwards compatibility</p>
<h3 id="21-keyword-argument">作法21: 強制使用僅限 keyword argument 來讓程式碼更清楚易懂</h3>
<ul>
<li>使用 keyword-only arguments 來強制要求呼叫者提供 keyword argument 以避免混淆，特別是在接收多個 Boolean flag 的函式中</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1"># * indicates the end of positional arguments</span>
<span class="k">def</span> <span class="nf">safe_division</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">divisor</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                  <span class="n">ignore_overflow</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="o">...</span>
</code></pre></div>
<h2 id="_2">第三章： 類別與繼承</h2>
<h3 id="22-class-dictionary-tuple">作法22: 優先選用輔助 class 而非使用 dictionary 或 tuple 來管理紀錄</h3>
<ul>
<li>如果還不需要用到較有彈性的完整 class，請使用 <code>namedtuple</code> 來製作輕量化、不可變的資料容器<ul>
<li><code>namedtuple</code> 不能指定預設引數值，如果資料有許多 optional properties，則還是適合用 class</li>
</ul>
</li>
</ul>
<h3 id="25-super">作法25: 使用 super 來初始化父類別</h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Implicit</span><span class="p">(</span><span class="n">BaseClass</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">value</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
</code></pre></div>
<h3 id="27">作法27: 優先選用公開屬性而非私有屬性</h3>
<ul>
<li>為什麼私有屬性的語法不強制施行嚴格的可見性限制呢？<ul>
<li>We are all consenting adults here.</li>
</ul>
</li>
<li>選擇私有屬性，只會讓子類別的 overrides 或 extensions 動作變得更麻煩更容易出錯</li>
<li>一般來說最好選擇使用 protected attributes</li>
<li>唯一得認真考慮使用 private attributes 的時機，是擔心子類別會有名稱衝突的時候</li>
</ul>
<h2 id="_3">第四章： 元類別與屬性</h2>
<h3 id="33-34-35">作法33, 34, 35</h3>
<ul>
<li>Metaclass 的應用<ul>
<li>驗證 subclass 是否有被正確定義</li>
<li>註冊 class 的存在</li>
<li>在一個 class 被實際使用前，修改其特性</li>
</ul>
</li>
</ul>
<h2 id="_4">第五章： 共時與平行處理</h2>
<ul>
<li>共時 (concurrency): 作業系統會在單一處理器快速切換多個執行程式</li>
<li>平行處理 (parallelism): 真正在同一時間執行許多工作的處理方式</li>
</ul>
<h3 id="38-lock-data-race">作法38: 使用 Lock 來避免執行緒中的 data race</h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Count</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">increment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">+=</span> <span class="n">offset</span>
</code></pre></div>
<p>如果用 thread 去跑 <code>increment</code> 會造成 data race<br/>
原因是</p>
<div class="highlight"><pre><span></span><code><span class="n">counter</span><span class="o">.</span><span class="n">count</span> <span class="o">+=</span> <span class="n">offset</span>
</code></pre></div>
<p>實際上執行了三個 operation<br/>
等效於以下的程式碼</p>
<div class="highlight"><pre><span></span><code><span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">counter</span><span class="p">,</span> <span class="s1">'count'</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">value</span> <span class="o">+</span> <span class="n">offset</span>
<span class="nb">setattr</span><span class="p">(</span><span class="n">counter</span><span class="p">,</span> <span class="s1">'count'</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</code></pre></div>
<p>這時候必須在 <code>increment</code> 加上 <code>Lock</code> 避免 data race</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">LockingCounter</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock</span> <span class="o">=</span> <span class="n">Lock</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">increment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">+=</span> <span class="n">offset</span>
</code></pre></div>
<h3 id="39-queue">作法39: 使用 Queue 來協調執行緒之間的工作</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">queue</span> <span class="kn">import</span> <span class="n">Queue</span>

<span class="n">queue</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">consumer</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'consumer waiting'</span><span class="p">)</span>
    <span class="n">queue</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'consumer done'</span><span class="p">)</span>

<span class="n">thread</span> <span class="o">=</span> <span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">consumer</span><span class="p">)</span>
<span class="n">thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'Producer putting'</span><span class="p">)</span>
<span class="n">queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="nb">object</span><span class="p">())</span>
<span class="n">thread</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Producer done'</span><span class="p">)</span>
</code></pre></div>
<h3 id="41-concurrentfutures">作法41: 考慮使用 concurrent.futures 來達成真正的平行處理</h3>
<ul>
<li><code>from concurrent.futures import multiprocessing</code><ul>
<li>藉由執行額外的直譯器作為 child processes。因為這些 child processes 跟主直譯器是分開的，所以它們的 GIL 也是分開的</li>
</ul>
</li>
<li>使用 multiprocessing 的成本很高<ul>
<li>因為 main process 和 child processes 的溝通需要透過 serialization 和 deserialization</li>
</ul>
</li>
<li>multiprocessing 適合<ul>
<li>isolated: 不必與程式其他部分共用狀態的 function</li>
<li>high-leverage: 在 main process 和 child processes 只需要轉移少量的資料，就能進行大量計算的狀況</li>
</ul>
</li>
<li>multiprocessing 最好只用到 <code>concurrent.futures</code> 的 built-in module 和 <code>ProcessPoolExecutor</code> class<ul>
<li>其他部分過於複雜，建議避免</li>
</ul>
</li>
</ul>
<h2 id="_5">第六章： 內建模組</h2>
<h3 id="34-contextlib-with-statement-tryfinally">作法34: 考慮使用 contextlib 與 with statement 來建立可重用的 try/finally 行為</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">contextlib</span> <span class="kn">import</span> <span class="n">contextmanager</span>


<span class="nd">@contextmanager</span>
<span class="k">def</span> <span class="nf">log_level</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">old_level</span> <span class="o">=</span> <span class="n">logger</span><span class="o">.</span><span class="n">getEffectiveLevel</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">logger</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">old</span><span class="p">)</span>


<span class="k">with</span> <span class="n">log_level</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">,</span> <span class="s1">'mylog'</span><span class="p">)</span> <span class="k">as</span> <span class="n">logger</span><span class="p">:</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">'This is my message!'</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debut</span><span class="p">(</span><span class="s1">'This will not print'</span><span class="p">)</span>
</code></pre></div>
<ul>
<li><code>yield</code> 前是 contextmanager 的 <code>__enter__</code> 會執行的部分，之後則是 <code>__exit__</code></li>
</ul>
<h3 id="45-datetime-time">作法45: 本地時鐘使用 datetime 而非 time</h3>
<ul>
<li>搭配 <code>pytz</code> module 來使用 <code>datetime</code> built-in module 在不同時區的時間之間作轉換</li>
<li>處理過程中，永遠用 UTC 來記錄，呈現給使用者前才轉換</li>
</ul>
<h2 id="_6">第七章： 協作</h2>
<h3 id="49-function-class-module-docstrings">作法49: 為每個 function, class, module 撰寫 Docstrings</h3>
<ul>
<li>
<p>General Docstring Guide</p>
<ul>
<li>用3個 double quotes (<code>"""</code>) 開頭</li>
<li>第一行應該是單一句子，來描寫用途</li>
<li>接下來的文字含有使用者應該知道的作業細節</li>
</ul>
</li>
<li>
<p>class</p>
<ul>
<li>將重要的 public attribute 和 method 在 class level 的 docstring 寫出</li>
</ul>
</li>
<li>public function / method<ul>
<li>寫上 function 的特殊行為, argument 和 return value</li>
<li>如果沒有 argument, return value，單句描述應該就夠了</li>
<li>如果不會回傳任何東西，就不要提到 return value，而不是寫 "return None"</li>
<li>如果有用到數目不定的 argument , keyword-argument，應該用 <code>*args</code>, <code>**kwargs</code>來描述</li>
<li>如果有 default argument 都應該被提及</li>
<li>如果是一個 generator，應該描述 iterate 時會 yield 什麼</li>
<li>如果是 coroutine，應該描述<ul>
<li>會產生什麼</li>
<li>預期從 yield 收到什麼</li>
<li>什麼時候會停止</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="50-package-module-api">作法50: 使用 package 來組織 module 並提供穩定的 API</h3>
<ul>
<li>Python 可以透過 module 或 package 的 <code>__all__</code> 特殊屬性來限制要暴露給 API 使用者的「表面積」<ul>
<li>如此即使重構也不會影響到使用者</li>
<li>這在提供明確、穩定、給外部使用的 API 是個很好的做法</li>
<li>如果只是在建置自己 module 間使用的 API 則是應該避免的做法</li>
</ul>
</li>
<li>盡可能使用 <code>from x import y</code>，而不是 <code>import *</code><ul>
<li><code>import *</code> 可能造成變數名稱複寫，而且不容易被 debug</li>
</ul>
</li>
</ul>
<h3 id="51-root-exception-api">作法51: 定義一個 root exception 來隔離呼叫者與 API</h3>
<ul>
<li>為什麼要自定義一個 root exception?<ul>
<li>讓使用者知道他們以錯誤的用法使用了你的 API</li>
<li>幫助你找出 API 中的 bug → 只要不是提出這些自定義的例外，就很可能是 bug 的所在</li>
</ul>
</li>
</ul>
<h3 id="52">作法52: 知道如何打破循環依存性</h3>
<ul>
<li>
<p>最好的做法是重構程式碼</p>
<ul>
<li>但有時候清楚的劃分相當困難，或 cost 太高了，因此還是需要知道如何打破循環依存性</li>
</ul>
</li>
<li>
<p>解法一： 重新安排匯入順序</p>
<ul>
<li>這是一個比較不好的做法，違反了 PEP 8，且容易讓程式碼稍微的修改就造成問題</li>
</ul>
</li>
<li>解法二： import, configure and execute<ul>
<li>讓 module 只作定義 function, class 和 constant，不做實際執行</li>
<li>每個 module 提供一個 configure 函式，讓所有 module 都完成匯入後才呼叫</li>
<li>許多狀況下都能運作良好，並且讓 dependency injection 變得可能</li>
<li>缺點<ul>
<li>很難重新組織程式碼架構</li>
<li>因為物件的定義和 configuration 在不同的地方，造成程式碼更難閱讀</li>
</ul>
</li>
</ul>
</li>
<li>解法三： 動態匯入<ul>
<li>通常是最簡單的解法</li>
<li>在 function/method 中才使用 import</li>
<li>但一般來說來是最好避免， import 的 cost 並沒有小到可以被忽略</li>
</ul>
</li>
</ul>
<h2 id="_7">第八章： 推出產品</h2>
<h3 id="57-pdb">作法57: 考慮使用 pdb 來進行互動式除錯</h3>
<ul>
<li>
<p>在程式碼加入以下這行，就能讓程式執行到這一步時停下，開啟互動式的 python shell<br/>
<code>python
    import pdf; pdf.set_trace()</code></p>
</li>
<li>
<p>檢視執行中的程式</p>
<ul>
<li><code>bt</code>: 印出目前 call stack 的 traceback</li>
<li><code>up</code>: 上移 call stack</li>
<li><code>down</code>: 下移 call stack</li>
</ul>
</li>
<li>恢復程式的執行<ul>
<li><code>step</code>: 執行程式，直到下一行</li>
<li><code>next</code>: 執行程式，直到遇到目前函式的下一行</li>
<li><code>return</code>: 執行程式，直到目前函式回傳</li>
<li><code>continue</code>: 執行程式，直到下一個 breakpoint 或 set_trace 再被呼叫</li>
</ul>
</li>
</ul>
<h3 id="58">作法58: 最佳化之前先進行效能評估</h3>
<ul>
<li>使用 <code>cProfile</code> module 而非 <code>profile</code> module<ul>
<li>因為對程式效能的影響較小</li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">cProfile</span> <span class="kn">import</span> <span class="n">Profile</span>
<span class="kn">from</span> <span class="nn">pstats</span> <span class="kn">import</span> <span class="n">Stats</span>

<span class="c1"># some program to test</span>
<span class="kn">import</span> <span class="nn">test</span>

<span class="n">profiler</span> <span class="o">=</span> <span class="n">Profile</span><span class="p">()</span>
<span class="n">profiler</span><span class="o">.</span><span class="n">runcall</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>

<span class="n">stats</span> <span class="o">=</span> <span class="n">Stats</span><span class="p">(</span><span class="n">profiler</span><span class="p">)</span>
<span class="n">stats</span><span class="o">.</span><span class="n">strip_dirs</span><span class="p">()</span>
<span class="n">stats</span><span class="o">.</span><span class="n">sort_stats</span><span class="p">(</span><span class="s1">'cumulative'</span><span class="p">)</span>
<span class="n">stats</span><span class="o">.</span><span class="n">print_stats</span><span class="p">()</span>
</code></pre></div>
<h3 id="59-tracemalloc">作法59: 使用 tracemalloc 來了解記憶體用量或是否有洩漏</h3>
<ul>
<li>Python 的預設實作 CPython 中，記憶體管理的方式是使用 reference counting</li>
<li>Python 3.4 以後可以使用 tracemalloc</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">tracemalloc</span>
<span class="n">tracemalloc</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="n">time1</span> <span class="o">=</span> <span class="n">tracemalloc</span><span class="o">.</span><span class="n">take_snapshot</span><span class="p">()</span>

<span class="c1"># some code that waste memory</span>

<span class="n">time2</span> <span class="o">=</span> <span class="n">tracemallo</span><span class="o">.</span><span class="n">take_snapshot</span><span class="p">()</span>

<span class="n">stats</span> <span class="o">=</span> <span class="n">time2</span><span class="o">.</span><span class="n">compare_to</span><span class="p">(</span><span class="n">time1</span><span class="p">,</span> <span class="s1">'lineno'</span><span class="p">)</span>
<span class="k">for</span> <span class="n">stat</span> <span class="ow">in</span> <span class="n">stats</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">stat</span><span class="p">)</span>
</code></pre></div>
</section>
<section class="post-footer">
<div class="post-share">
<span class="post-info-label">Share</span>
<a aria-label="Twitter" class="twitter" href="https://twitter.com/share?text=[Note] Effective Python &amp;url=https://blog.wei-lee.me/posts/tech/2019/01/effective-python" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title="Twitter">
<i aria-hidden="true" class="icon icon-twitter"></i><span class="hidden">Twitter</span>
</a>
<a aria-label="Facebook" class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.wei-lee.me/posts/tech/2019/01/effective-python" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title="Facebook">
<i aria-hidden="true" class="icon icon-facebook"></i><span class="hidden">Facebook</span>
</a>
<a aria-label="LinkedIn" class="linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://blog.wei-lee.me/posts/tech/2019/01/effective-python&amp;title=[Note] Effective Python" onclick="window.open(this.href, 'linkedin-share', 'width=930,height=720');return false;" title="LinkedIn">
<i aria-hidden="true" class="icon icon-linkedin"></i><span class="hidden">LinkedIn</span>
</a>
<a aria-label="Email" class="email" href="mailto:?subject=[Note] Effective Python&amp;body=https://blog.wei-lee.me/posts/tech/2019/01/effective-python" title="Email">
<i aria-hidden="true" class="icon icon-mail"></i><span class="hidden">Email</span>
</a>
<div class="clear"></div>
</div>
<aside class="post-tags">
<a href="https://blog.wei-lee.me/tag/python.html">Python</a><a href="https://blog.wei-lee.me/tag/note.html">Note</a> </aside>
<div class="clear"></div>
</section>
<script type="text/javascript">var use_utterance = true;</script>
<section class="post-comments">
<script async="" crossorigin="anonymous" data-issue-term="https://blog.wei-lee.me/posts/tech/2019/01/effective-python" data-label="blog-comment" data-repo="Lee-W/main-blog" data-theme="github-light" src="https://utteranc.es/client.js">
</script>
</section>
<aside class="post-nav">
<div class="clear"></div>
</aside>
</div>
</article>
</main>
<div class="nav-footer">
<nav aria-label="Footer" class="nav-wrapper">
<span class="nav-copy">Those aren't written down are meant to be forgotten © 2023
          <a class="nav-rss" href="https://blog.wei-lee.me/feeds/all.atom.xml" target="_blank" title="RSS"><i class="icon icon-rss"></i></a>
</span>
<span class="nav-credits">



          Published with <a href="https://github.com/getpelican/pelican" rel="nofollow">Pelican</a> • Theme <a href="https://github.com/arulrajnet/attila" rel="nofollow">Attila</a> •
          <a class="menu-item js-theme" data-dark="Dark theme" data-light="Light theme" data-system="System theme" href="#">
<span class="theme-icon"></span><span class="theme-text">System theme</span>
</a>
</span>
</nav>
</div>
</section>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
<!-- TODO: minify -->
<script src="https://blog.wei-lee.me/theme/js/jquery.fitvids.js" type="text/javascript"></script>
<script src="https://blog.wei-lee.me/theme/js/script.js" type="text/javascript"></script>
<script src="https://blog.wei-lee.me/theme/js/clipboard.min.js" type="text/javascript"></script>
<script src="https://blog.wei-lee.me/theme/js/copy-to-clipboard.js" type="text/javascript"></script>
<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-3J7XQ46QH5"></script>
<script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-3J7XQ46QH5', { 'anonymize_ip': true });
    </script>
<script src="/pagefind/pagefind-ui.js"></script>
<script>
      window.addEventListener('DOMContentLoaded', (event) => {
          new PagefindUI({
              element: "#search",
              showImages: false,
          });
      });
  </script>
<!-- 	The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in article.html, but it needs to be included down here, after jQuery has already loaded. -->
<script>
  $(document).ready(function () {
    var viewport = $(window);
    var post = $('.post-content');
    // Responsive videos with fitVids
    post.fitVids();

    // Reading progress bar on window top
    function readingProgress() {
      var postBottom = post.offset().top + post.height();
      var viewportHeight = viewport.height();
      var progress = 100 - (((postBottom - (viewport.scrollTop() + viewportHeight) + viewportHeight / 3) / (postBottom - viewportHeight + viewportHeight / 3)) * 100);
      $('.progress-bar').css('width', progress + '%');
      (progress > 100) ? $('.progress-container').addClass('complete'): $('.progress-container').removeClass('complete');
    }
    readingProgress();
    // Trigger reading progress
    viewport.on({
      'scroll': function() {
        readingProgress();
      },
      'resize': function() {
        readingProgress();
      },
      'orientationchange': function() {
        readingProgress();
      }
    });

  });
</script>
</body>
</html>

<!DOCTYPE html>

<html lang="zh-tw">
<head>
<meta charset="utf-8"/>
<meta charset="utf-8" content="text/html" http-equiv="Content-Type">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"/>
<title>AIP-72 - Task Execution Interface aka Task SDK  - Airflow çš„ task è¦æ”¯æ´ Python ä»¥å¤–çš„èªè¨€äº†ï¼</title>
<meta content="True" name="HandheldFriendly"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="origin" name="referrer"/>
<meta content="Pelican" name="generator"/>
<link href="https://blog.wei-lee.me/posts/tech/2024/11/aip-72" rel="canonical"/>
<!-- Feed -->
<link href="https://blog.wei-lee.me/feeds/all.atom.xml" rel="alternate" title="Those aren't written down are meant to be forgotten Full Atom Feed" type="application/atom+xml"/>
<!-- TODO: combine -->
<link href="https://blog.wei-lee.me/theme/css/style.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/pygments.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/pagefind-ui-custom.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/code.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/code-copy.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/custom.css" rel="stylesheet" type="text/css"/>
<link href="/pagefind/pagefind-ui.css" rel="stylesheet"/>
<!-- Custom fonts -->
<link href="https://fonts.googleapis.com/css?family=Montserrat:400,300" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css"/>
<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
<script>
    var siteUrl = 'https://blog.wei-lee.me';
  </script>
<script>
    var localTheme = localStorage.getItem('attila_theme');
    switch (localTheme) {
      case 'dark':
        document.documentElement.classList.add('theme-dark');
        break;
      case 'light':
        document.documentElement.classList.add('theme-light');
        break;
      default:
        break;
    }
  </script>
<meta content="ä»¥å¾Œ Flyte ä¸èƒ½å†ä»¥é€™é»å˜´ Airflow äº† ğŸ˜†" name="description"/>
<meta content="Wei Lee" name="author"/>
<meta content="Python" name="tags"/>
<meta content="Airflow" name="tags"/>
<meta content="Airflow 3.0" name="tags"/>
<meta content="Airflow Improvement Proposal" name="tags"/>
<!-- Open Graph -->
<meta content="Those aren't written down are meant to be forgotten" prefix="og: http://ogp.me/ns#" property="og:site_name">
<meta content="AIP-72 - Task Execution Interface aka Task SDK  - Airflow çš„ task è¦æ”¯æ´ Python ä»¥å¤–çš„èªè¨€äº†ï¼" prefix="og: http://ogp.me/ns#" property="og:title">
<meta content="ä»¥å¾Œ Flyte ä¸èƒ½å†ä»¥é€™é»å˜´ Airflow äº† ğŸ˜†" prefix="og: http://ogp.me/ns#" property="og:description">
<meta content="zh-tw" prefix="og: http://ogp.me/ns#" property="og:locale">
<meta content="https://blog.wei-lee.me/posts/tech/2024/11/aip-72" prefix="og: http://ogp.me/ns#" property="og:url">
<meta content="article" prefix="og: http://ogp.me/ns#" property="og:type">
<meta content="2024-11-06 19:15:00+08:00" prefix="og: http://ogp.me/ns#" property="article:published_time"/>
<meta content="" prefix="og: http://ogp.me/ns#" property="article:modified_time"/>
<meta content="https://blog.wei-lee.me/author/wei-lee.html" prefix="og: http://ogp.me/ns#" property="article:author"/>
<meta content="Tech" prefix="og: http://ogp.me/ns#" property="article:section">
<meta content="Python" prefix="og: http://ogp.me/ns#" property="article:tag"/>
<meta content="Airflow" prefix="og: http://ogp.me/ns#" property="article:tag"/>
<meta content="Airflow 3.0" prefix="og: http://ogp.me/ns#" property="article:tag"/>
<meta content="Airflow Improvement Proposal" prefix="og: http://ogp.me/ns#" property="article:tag"/>
<meta content="https://blog.wei-lee.me//images/cover.jpeg" prefix="og: http://ogp.me/ns#" property="og:image"/>
<!-- Twitter Card -->
<meta content="summary_large_image" name="twitter:card"/>
<meta content="@clleew" name="twitter:site"/>
<meta content="AIP-72 - Task Execution Interface aka Task SDK  - Airflow çš„ task è¦æ”¯æ´ Python ä»¥å¤–çš„èªè¨€äº†ï¼" name="twitter:title"/>
<meta content="https://blog.wei-lee.me/posts/tech/2024/11/aip-72" name="twitter:url"/>
<meta content="https://blog.wei-lee.me//images/cover.jpeg" name="twitter:image:src"/>
<meta content="ä»¥å¾Œ Flyte ä¸èƒ½å†ä»¥é€™é»å˜´ Airflow äº† ğŸ˜†" name="twitter:description"/>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "name": "AIP-72 - Task Execution Interface aka Task SDK - Airflow çš„ task è¦æ”¯æ´ Python ä»¥å¤–çš„èªè¨€äº†ï¼",
  "headline": "AIP-72 - Task Execution Interface aka Task SDK - Airflow çš„ task è¦æ”¯æ´ Python ä»¥å¤–çš„èªè¨€äº†ï¼",
  "datePublished": "2024-11-06 19:15:00+08:00",
  "dateModified": "",
  "author": {
    "@type": "Person",
    "name": "Wei Lee",
    "url": "https://blog.wei-lee.me/author/wei-lee.html"
  },
  "image": "https://blog.wei-lee.me//images/cover.jpeg",
  "url": "https://blog.wei-lee.me/posts/tech/2024/11/aip-72",
  "description": "ä»¥å¾Œ Flyte ä¸èƒ½å†ä»¥é€™é»å˜´ Airflow äº† ğŸ˜†"
}
</script>
</meta></meta></meta></meta></meta></meta></meta></link></meta><link href="https://blog.wei-lee.me/posts/tech/2024/11/aip-72" rel="canonical"/><script type="application/ld+json">{"@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [{"@type": "ListItem", "position": 1, "name": "Those aren't written down are meant to be forgotten", "item": "https://blog.wei-lee.me"}, {"@type": "ListItem", "position": 2, "name": "Posts", "item": "https://blog.wei-lee.me/posts"}, {"@type": "ListItem", "position": 3, "name": "Tech", "item": "https://blog.wei-lee.me/posts/tech"}, {"@type": "ListItem", "position": 4, "name": "2024", "item": "https://blog.wei-lee.me/posts/tech/2024"}, {"@type": "ListItem", "position": 5, "name": "11", "item": "https://blog.wei-lee.me/posts/tech/2024/11"}, {"@type": "ListItem", "position": 6, "name": "Aip 72", "item": "https://blog.wei-lee.me/posts/tech/2024/11/aip-72"}, {"@type": "ListItem", "position": 7, "name": "Index", "item": "https://blog.wei-lee.me/posts/tech/2024/11/aip-72/index.html"}]}</script><script type="application/ld+json">{"@context": "https://schema.org", "@type": "Article", "author": {"@type": "Person", "name": "Wei Lee"}, "publisher": {"@type": "Organization", "name": "Those aren't written down are meant to be forgotten"}, "headline": "AIP-72 - Task Execution Interface aka Task SDK", "about": "Tech", "datePublished": "2024-11-06 19:15"}</script></head>
<body class="category-template">
<div class="nav-header">
<nav aria-label="Main" class="nav-wrapper">
<ul>
<li class="nav-ğŸ  Home" role="presentation"><a href="/"><span>ğŸ  Home</span></a></li>
<li class="nav-About Me" role="presentation"><a href="/pages/about-me.html"><span>About Me</span></a></li>
<li class="nav-ğŸ‘¨â€ğŸ’» Tech active" role="presentation"><a href="/category/tech.html"><span>ğŸ‘¨â€ğŸ’» Tech</span></a></li>
<li class="nav-ğŸ“š Book Digest" role="presentation"><a href="/category/book.html"><span>ğŸ“š Book Digest</span></a></li>
<li class="nav-ğŸ’¬ Gossiping" role="presentation"><a href="/category/gossiping.html"><span>ğŸ’¬ Gossiping</span></a></li>
<li class="nav-ğŸ·ï¸ Tags" role="presentation"><a href="/tags.html"><span>ğŸ·ï¸ Tags</span></a></li>
<li class="nav-ğŸ—„ï¸ Archives" role="presentation"><a href="/archives.html"><span>ğŸ—„ï¸ Archives</span></a></li>
<li class="nav-ğŸ“š Series" role="presentation"><a href="/series_list.html"><span>ğŸ“š Series</span></a></li>
<li class="nav-ğŸ” Search" role="presentation"><a href="/search.html"><span>ğŸ” Search</span></a></li>
</ul>
<ul class="nav-meta">
<li class="nav-linkedin"><a aria-label="Linkedin" href="https://tw.linkedin.com/in/clleew" target="_blank"><i aria-hidden="true" class="icon icon-linkedin"></i>
<span>Linkedin</span>
</a></li>
<li class="nav-github"><a aria-label="Github" href="https://github.com/Lee-W" target="_blank"><i aria-hidden="true" class="icon icon-github"></i>
<span>GitHub</span>
</a></li>
<li class="nav-twitter"><a aria-label="Twitter" href="https://twitter.com/clleew" target="_blank"><i aria-hidden="true" class="icon icon-twitter"></i>
<span>Twitter</span>
</a></li>
<li class="nav-search" style="display: none;">
<a title="Search">
<i aria-hidden="true" class="icon icon-search"></i>
<span>Search</span>
</a>
</li>
</ul> </nav>
<div class="nav-wrapper-control">
<div class="inner">
<a class="nav-menu" role="button"><i aria-hidden="true" class="icon icon-menu"></i>Menu</a>
<a class="nav-search" role="button" style="display: none;" title="Search"><i aria-hidden="true" class="icon icon-search"></i></a>
</div>
</div>
</div>
<div aria-label="Close" class="nav-close" role="button"></div>
<section class="page-wrapper" id="wrapper">
<!-- Progressbar -->
<div class="progress-container">
<span class="progress-bar"></span>
</div>
<!-- Page Header -->
<!-- Set your background image for this header on the line below. -->
<header class="post-header has-cover">
<div class="inner">
<span class="post-info">
<span class="post-type">Article</span>
<span class="post-count">Tech</span>
</span>
<h1 class="post-title">
            AIP-72 - Task Execution Interface aka Task SDK
            <br/>
<small class="post-subtitle-white">Airflow çš„ task è¦æ”¯æ´ Python ä»¥å¤–çš„èªè¨€äº†ï¼</small>
</h1>
<div class="post-meta">
<div class="post-meta-avatars">
<figure class="post-meta-avatar avatar">
<a class="author-avatar" href="https://blog.wei-lee.me/author/wei-lee.html">
<img alt="Wei Lee" class="author-profile-image" src="https://blog.wei-lee.me//images/avatar.jpeg"/>
</a>
</figure>
</div>
<h4 class="post-meta-author">
            Wei Lee
          </h4>
<time datetime="2024/11/06 - Wed">2024/11/06 - Wed</time>
          â€¢ 3 min read
        </div>
<div class="post-cover cover">
<img alt="Category Tech" src="https://blog.wei-lee.me//images/cover.jpeg"/>
</div>
</div>
</header>
<!-- Post content -->
<main class="content" data-pagefind-body="" role="main">
<article class="post">
<div class="inner">
<section class="post-content">
<p><del>ä»¥å¾Œ Flyte ä¸èƒ½å†ä»¥é€™é»å˜´ Airflow äº† ğŸ˜†</del></p>
<!--more-->
<div class="toc">
<ul>
<li><a href="#_1">å‰è¨€</a></li>
<li><a href="#_2">ä¸€è¨€ä»¥è”½ä¹‹</a></li>
<li><a href="#aip-72-task-execution-interface-aka-task-sdk">AIP-72 Task Execution Interface aka Task SDK</a><ul>
<li><a href="#definitions">Definitions</a></li>
<li><a href="#motivation">Motivation</a></li>
<li><a href="#changes-to-make">Changes to make</a></li>
<li><a href="#which-users-are-affected-by-the-change">Which users are affected by the change?</a></li>
</ul>
</li>
<li><a href="#distro-proposal-based-on-the-task-execution-interface">Distro proposal based on the Task Execution Interface</a><ul>
<li><a href="#task-context-incoming-to-tasks">Task Context: Incoming to Tasks</a></li>
<li><a href="#task-status-and-output-outgoing-from-tasks">Task Status and Output: Outgoing from Tasks</a></li>
<li><a href="#user-scenarios">User scenarios</a></li>
<li><a href="#distro-proposal">Distro proposal</a></li>
</ul>
</li>
</ul>
</div>
<h2 id="_1">å‰è¨€</h2>
<p>AIP çš„å…¨åæ˜¯ <a href="https://cwiki.apache.org/confluence/display/AIRFLOW/Airflow+Improvement+Proposals">Airflow Improvement Proposals</a><br/>
é¡§åæ€ç¾©ï¼Œè·Ÿ Python Enhancement Proposal (PEP) å·®ä¸å¤š<br/>
å°±æ˜¯è®“ Airflow è®Šå¾—æ›´å¥½çš„ææ¡ˆ</p>
<p>æœ€è¿‘é–‹ç™¼ <a href="https://cwiki.apache.org/confluence/display/AIRFLOW/AIP-75+New+Asset-Centric+Syntax">AIP-75</a> çš„åŠŸèƒ½ç™¼ç¾ï¼Œæœ‰äº› AIP çš„å…§å®¹æˆ‘çœ‹éåˆå¿˜äº†<br/>
ä¸å°å¿ƒåˆå•äº†è ¢å•é¡Œ<br/>
æ­£å¦‚åŒæˆ‘éƒ¨è½å€‹ç¾åœ¨çš„æ¨™é¡Œ "Those aren't written down are meant to be forgotten"<br/>
æ²’å¯«ä¸‹ä¾†çš„æ±è¥¿ï¼Œæœ€çµ‚éƒ½æœƒå¿˜è¨˜çš„<br/>
é‚£å°±ä¾†åšå€‹ç­†è¨˜å§</p>
<p>ç³»åˆ—åã€Œå¸¶æˆ‘è®€ AIPã€ç•¶ç„¶æ˜¯æä»– COSCUP çš„ã€Œå¸¶æ‚¨è®€æºç¢¼ã€<br/>
ä½ ä¹Ÿè¨±æœƒå•ï¼Œé‚£ä¸æ˜¯æ‡‰è©²è¦æ˜¯ã€Œå¸¶æ‚¨è®€ AIPã€å—ï¼Ÿ<br/>
é€™å•é¡Œå•å¾—å¥½<br/>
å› ç‚ºé€™æ˜¯å¯«çµ¦æˆ‘è‡ªå·±çš„ç­†è¨˜<br/>
ä¸éå¦‚æœå‰›å¥½å°ä½ æœ‰å¹«åŠ©çš„è©±å°±å¤ªå¥½äº† ğŸ˜‡<br/>
è®€èµ·ä¾†æ‡‰è©²å°±è·Ÿæˆ‘çš„æ›¸æ‘˜ç³»åˆ—å·®ä¸å¤š</p>
<p>æœ€è¿‘è¦é–‹å§‹åš <a href="https://github.com/apache/airflow/issues/43619">Move Asset user-facing components to task_sdk #43619</a><br/>
æŠŠ <a href="https://cwiki.apache.org/confluence/display/AIRFLOW/AIP-74+Introducing+Data+Assets">AIP-74</a> æ‰€æ”¹åçš„ Asset çš„ç›¸é—œæ±è¥¿ç§»å‹•åˆ° <a href="https://cwiki.apache.org/confluence/display/AIRFLOW/AIP-72+Task+Execution+Interface+aka+Task+SDK">AIP-72</a> æ‰€æå‡ºçš„ TaskSDK<br/>
æ‰€ä»¥é€™ç³»åˆ—çš„æ–‡ç« å°±å¾ <a href="https://cwiki.apache.org/confluence/display/AIRFLOW/AIP-72+Task+Execution+Interface+aka+Task+SDK">AIP-72</a> é–‹å§‹äº†</p>
<h2 id="_2">ä¸€è¨€ä»¥è”½ä¹‹</h2>
<h2 id="aip-72-task-execution-interface-aka-task-sdk">AIP-72 Task Execution Interface aka Task SDK</h2>
<ul>
<li><a href="https://cwiki.apache.org/confluence/display/AIRFLOW/AIP-72+Task+Execution+Interface+aka+Task+SDK">Link to AIP-72</a></li>
</ul>
<h3 id="definitions">Definitions</h3>
<ul>
<li>Airflow Core: the scheduler and API servers</li>
<li>User code: DAG files, but not necessarily plugins</li>
</ul>
<h3 id="motivation">Motivation</h3>
<ul>
<li>Reduces the interaction between the Task (user code) and Airflow Core â†’ <strong>Airflow Core and Task can be upgraded separately</strong></li>
<li>Avoid workers/tasks to Airflow DB access while still being able to get the information required â†’ task executions on local, trusted networks</li>
<li>Interface for remote workers to connect to Airflow Core service for information needed for task execution â†’ better remote execution</li>
<li>Language agnostic interface â†’ <strong>allowing Tasks in other languages</strong><ul>
<li><strong>DAGs will still be Python-based</strong></li>
</ul>
</li>
</ul>
<h3 id="changes-to-make">Changes to make</h3>
<ul>
<li>No extra components outside of Airflow and its metadata DB should be needed to run Airflow locally</li>
</ul>
<h4 id="disable-direct-db-access">Disable Direct DB access</h4>
<ul>
<li>Remove direct DB access from<ul>
<li>user code</li>
<li>workers</li>
<li>triggerers</li>
<li>triggers</li>
</ul>
</li>
<li><strong>All DB traffic goes through an API server</strong><ul>
<li>reduce the number of open connections to DB</li>
</ul>
</li>
</ul>
<h4 id="build-a-new-api-for-task-communication-from-the-ground-up">Build a new API for task communication from the ground up</h4>
<ul>
<li>Endpoints for all items in the "Airflow Task SDK"</li>
<li>Strongly versioned using <strong>CalVer</strong></li>
<li>Supports WebSockets or other "instant" push for low-latency<ul>
<li>in practice, Async web framework (e.g., FastAPI)</li>
</ul>
</li>
<li>Transport encoding: TBD</li>
</ul>
<h4 id="api-security-and-strong-per-task-try-identity">API security and Strong per-task-try identity</h4>
<ul>
<li>Strong identity for each <strong>task try</strong> â† authorization<ul>
<li>current choice: JWT token signed by the API server</li>
</ul>
</li>
</ul>
<h4 id="define-an-airflow-task-sdk">Define an "Airflow Task SDK"</h4>
<ul>
<li>Interface for<ul>
<li>Version introspection</li>
<li>Airflow Connections</li>
<li>Variables</li>
<li>Read and write<ul>
<li>XCom</li>
<li>Triggers</li>
</ul>
</li>
<li>heartbeat</li>
<li>logs</li>
<li>metrics</li>
<li>OpenLineage events</li>
<li>data about task expansion for downstream tasks<ul>
<li>values</li>
<li>lengths</li>
<li>names</li>
<li>etc.</li>
</ul>
</li>
<li>etc.</li>
</ul>
</li>
<li>Access to the Connections and Variables (detail TBD)</li>
<li>Read/Write task log or XCom<ul>
<li>consideration point<ul>
<li>avoid requiring every log line for every task execution to go over the API server due to performance</li>
<li>solution TBD</li>
</ul>
</li>
</ul>
</li>
<li>Out of scope<ul>
<li>handling custom callbacks</li>
</ul>
</li>
</ul>
<h4 id="extend-executor-interface">Extend Executor interface</h4>
<ul>
<li>Replace <del><code>queue_task_instance()</code>, <code>queue_command()</code>, <code>send_callback()</code></del> with <code>queue_activity()</code></li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">queue_activity</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="c1"># For now just "ExecuteTask", "RunCallback", but allows for "ParseDAGFile" etc. in future</span>
    <span class="n">kind</span><span class="p">:</span> <span class="n">ActivityType</span><span class="p">,</span>
    <span class="c1"># Contains TI for "ExecuteTask", so executor can get ti.queue out of this.</span>
    <span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
<span class="p">):</span> <span class="o">...</span>
</code></pre></div>
<ul>
<li>Key difference: what's passed between the scheduler and worker<ul>
<li>from <del>commands to run</del> to <em>better typed parameters</em></li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ExecuteTask"</span><span class="p">,</span>
<span class="w">  </span><span class="nt">"token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"eyJhb...."</span><span class="p">,</span>
<span class="w">  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"dag_id"</span><span class="p">,</span><span class="w"> </span><span class="s2">"task_id"</span><span class="p">,</span><span class="w"> </span><span class="s2">"run_id"</span><span class="p">,</span><span class="w"> </span><span class="s2">"attempt"</span><span class="p">,</span><span class="w"> </span><span class="s2">"map_index"</span><span class="p">],</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="err">Or</span><span class="w"> </span><span class="err">be</span><span class="kc">tter</span><span class="p">,</span><span class="w"> </span><span class="err">a</span><span class="w"> </span><span class="err">si</span><span class="kc">n</span><span class="err">gle</span><span class="w"> </span><span class="err">id</span><span class="p">,</span><span class="w"> </span><span class="err">bu</span><span class="kc">t</span><span class="w"> </span><span class="err">we</span><span class="w"> </span><span class="err">wa</span><span class="kc">nt</span><span class="w"> </span><span class="kc">t</span><span class="err">hese</span><span class="w"> </span><span class="err">de</span><span class="kc">ta</span><span class="err">ils</span><span class="w"> </span><span class="kc">t</span><span class="err">o</span><span class="w"> </span><span class="err">be</span><span class="w"> </span><span class="err">passed</span><span class="w"> </span><span class="err">alo</span><span class="kc">n</span><span class="err">g</span><span class="w"> </span><span class="err">regardless</span>
<span class="w">  </span><span class="nt">"context"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">  </span>
<span class="w">        </span><span class="nt">"connections"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"list"</span><span class="p">,</span><span class="w"> </span><span class="s2">"of"</span><span class="p">,</span><span class="w"> </span><span class="s2">"pre-injected"</span><span class="p">,</span><span class="w"> </span><span class="s2">"connections"</span><span class="p">],</span>
<span class="w">        </span><span class="s2">"..."</span><span class="p">,</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="dag-parsing-changes">Dag Parsing Changes</h4>
<ul>
<li>Strong identity for the source file being parsed</li>
<li>The same Task SDK during<ul>
<li>dag parsing</li>
<li>task execution</li>
</ul>
</li>
<li>Callback details TBD<ul>
<li>run in the parsing process and will need to be "passed down" to it</li>
</ul>
</li>
</ul>
<h4 id="connectionvariable-security-models">Connection/Variable security models</h4>
<ul>
<li>a.k.a. push/inject secrets into tasks or allow tasks to request secrets.</li>
<li>Details TBD</li>
</ul>
<h3 id="which-users-are-affected-by-the-change">Which users are affected by the change?</h3>
<ul>
<li>Operators that needed direct DB access need re-writing</li>
</ul>
<h2 id="distro-proposal-based-on-the-task-execution-interface">Distro proposal based on the Task Execution Interface</h2>
<p>é€™æ˜¯åœ¨ <a href="https://lists.apache.org/thread/gm2rj7s4vsnyt95bxbh1pjkht49zvb3t">Airflow dev mailing list</a> è·Ÿ <a href="https://cwiki.apache.org/confluence/display/AIRFLOW/AIP-72+Task+Execution+Interface+aka+Task+SDK">AIP-72</a> é«˜åº¦ç›¸é—œçš„ææ¡ˆ<br/>
æ‰€ä»¥æˆ‘å°±ä¸€èµ·è®€äº†</p>
<ul>
<li><a href="https://docs.google.com/document/d/1isjpMKYdgdYpEGQDtN2hKrJ-oq8qFWU9kqootRUHiX8/edit">link to the google doc</a></li>
</ul>
<h3 id="task-context-incoming-to-tasks">Task Context: Incoming to Tasks</h3>
<ul>
<li>Information obtained from the API server for task execution<ul>
<li>Connections</li>
<li>Secrets</li>
<li>XCom</li>
<li>Variables</li>
<li>Log output location reference</li>
<li>Composite TaskRunID</li>
</ul>
</li>
</ul>
<h3 id="task-status-and-output-outgoing-from-tasks">Task Status and Output: Outgoing from Tasks</h3>
<ul>
<li>information sent to the API server<ul>
<li>Tasks Completion status</li>
<li>XCom <em>(optional)</em></li>
<li>Variables (write) <em>(optional)</em></li>
<li>Log information <em>(optional)</em></li>
<li>Heartbeat<ul>
<li>The scheduler knows that this task is still running</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="user-scenarios">User scenarios</h3>
<blockquote>
<p>Worth reading, but I'm going to skip it in my digest</p>
</blockquote>
<h3 id="distro-proposal">Distro proposal</h3>
<ol>
<li>Server Distribution (based on Python)<ul>
<li>MetaDB handling</li>
<li>Scheduler / Executor</li>
<li>API server</li>
<li>Web server</li>
<li>DAG File processor</li>
<li>Executor providers (Celery / k8s / Edge)</li>
<li>Logging providers (<em>maybeâ“</em>)</li>
<li>Server providers (Secrets backend, AuthMgr backend, etc.) (<em>as needed</em>)</li>
</ul>
</li>
<li>Python Task SDK (python distribution)<ul>
<li>TEI serialization / deserialization</li>
<li>HTTP / REST client and token authentication capabilities</li>
<li>Default operators</li>
<li>Logging write provider (<em>maybeâ“</em>)</li>
<li>Providers (hooks / operators / sensors) (<em>as needed</em>)</li>
</ul>
</li>
<li>Consolidated Distribution (1 + 2)</li>
<li>Golang Task SDK (Go distribution)<ul>
<li>similar to 2 but in Go</li>
</ul>
</li>
</ol>
</section>
<section class="post-footer">
<div class="post-share">
<span class="post-info-label">Share</span>
<a aria-label="Twitter" class="twitter" href="https://twitter.com/share?text=AIP-72 - Task Execution Interface aka Task SDK  - Airflow çš„ task è¦æ”¯æ´ Python ä»¥å¤–çš„èªè¨€äº†ï¼&amp;url=https://blog.wei-lee.me/posts/tech/2024/11/aip-72" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title="Twitter">
<i aria-hidden="true" class="icon icon-twitter"></i><span class="hidden">Twitter</span>
</a>
<a aria-label="Facebook" class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.wei-lee.me/posts/tech/2024/11/aip-72" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title="Facebook">
<i aria-hidden="true" class="icon icon-facebook"></i><span class="hidden">Facebook</span>
</a>
<a aria-label="LinkedIn" class="linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://blog.wei-lee.me/posts/tech/2024/11/aip-72&amp;title=AIP-72 - Task Execution Interface aka Task SDK" onclick="window.open(this.href, 'linkedin-share', 'width=930,height=720');return false;" title="LinkedIn">
<i aria-hidden="true" class="icon icon-linkedin"></i><span class="hidden">LinkedIn</span>
</a>
<a aria-label="Email" class="email" href="mailto:?subject=AIP-72 - Task Execution Interface aka Task SDK&amp;body=https://blog.wei-lee.me/posts/tech/2024/11/aip-72" title="Email">
<i aria-hidden="true" class="icon icon-mail"></i><span class="hidden">Email</span>
</a>
<div class="clear"></div>
</div>
<aside class="post-tags">
<a href="https://blog.wei-lee.me/tag/python.html">Python</a><a href="https://blog.wei-lee.me/tag/airflow.html">Airflow</a><a href="https://blog.wei-lee.me/tag/airflow-30.html">Airflow 3.0</a><a href="https://blog.wei-lee.me/tag/airflow-improvement-proposal.html">Airflow Improvement Proposal</a> </aside>
<div class="clear"></div>
<div class="series">
<p>This post is part 1 of the "å¸¶æˆ‘è®€ AIP" series:</p>
<ol class="parts">
<li class="active">
<a href="https://blog.wei-lee.me/posts/tech/2024/11/aip-72">AIP-72 - Task Execution Interface aka Task SDK - Airflow çš„ task è¦æ”¯æ´ Python ä»¥å¤–çš„èªè¨€äº†ï¼</a>
</li>
</ol>
</div>
</section>
<script type="text/javascript">var use_utterance = true;</script>
<section class="post-comments">
<script async="" crossorigin="anonymous" data-issue-term="https://blog.wei-lee.me/posts/tech/2024/11/aip-72" data-label="blog-comment" data-repo="Lee-W/main-blog" data-theme="github-light" src="https://utteranc.es/client.js">
</script>
</section>
<aside class="post-nav">
<div class="clear"></div>
</aside>
</div>
</article>
</main>
<div class="nav-footer">
<nav aria-label="Footer" class="nav-wrapper">
<span class="nav-copy">Those aren't written down are meant to be forgotten Â© 2023
          <a class="nav-rss" href="https://blog.wei-lee.me/feeds/all.atom.xml" target="_blank" title="RSS"><i class="icon icon-rss"></i></a>
</span>
<span class="nav-credits">



          Published with <a href="https://github.com/getpelican/pelican" rel="nofollow">Pelican</a> â€¢ Theme <a href="https://github.com/arulrajnet/attila" rel="nofollow">Attila</a> â€¢
          <a class="menu-item js-theme" data-dark="Dark theme" data-light="Light theme" data-system="System theme" href="#">
<span class="theme-icon"></span><span class="theme-text">System theme</span>
</a>
</span>
</nav>
</div>
</section>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
<!-- TODO: minify -->
<script src="https://blog.wei-lee.me/theme/js/jquery.fitvids.js" type="text/javascript"></script>
<script src="https://blog.wei-lee.me/theme/js/script.js" type="text/javascript"></script>
<script src="https://blog.wei-lee.me/theme/js/clipboard.min.js" type="text/javascript"></script>
<script src="https://blog.wei-lee.me/theme/js/copy-to-clipboard.js" type="text/javascript"></script>
<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-3J7XQ46QH5"></script>
<script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-3J7XQ46QH5', { 'anonymize_ip': true });
    </script>
<script src="/pagefind/pagefind-ui.js"></script>
<script>
      window.addEventListener('DOMContentLoaded', (event) => {
          new PagefindUI({
              element: "#search",
              showImages: false,
          });
      });
  </script>
<!-- 	The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in article.html, but it needs to be included down here, after jQuery has already loaded. -->
<script>
  $(document).ready(function () {
    var viewport = $(window);
    var post = $('.post-content');
    // Responsive videos with fitVids
    post.fitVids();

    // Reading progress bar on window top
    function readingProgress() {
      var postBottom = post.offset().top + post.height();
      var viewportHeight = viewport.height();
      var progress = 100 - (((postBottom - (viewport.scrollTop() + viewportHeight) + viewportHeight / 3) / (postBottom - viewportHeight + viewportHeight / 3)) * 100);
      $('.progress-bar').css('width', progress + '%');
      (progress > 100) ? $('.progress-container').addClass('complete'): $('.progress-container').removeClass('complete');
    }
    readingProgress();
    // Trigger reading progress
    viewport.on({
      'scroll': function() {
        readingProgress();
      },
      'resize': function() {
        readingProgress();
      },
      'orientationchange': function() {
        readingProgress();
      }
    });

  });
</script>
</body>
</html>
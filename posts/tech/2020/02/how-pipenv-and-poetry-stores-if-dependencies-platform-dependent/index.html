
<!DOCTYPE html>

<html lang="zh-tw">
<head>
<meta charset="utf-8"/>
<meta charset="utf-8" content="text/html" http-equiv="Content-Type">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"/>
<title>pipenv 和 poerty 如何處理在不同作業系統下相依套件不同 </title>
<meta content="True" name="HandheldFriendly"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="origin" name="referrer"/>
<meta content="Pelican" name="generator"/>
<link href="https://blog.wei-lee.me/posts/tech/2020/02/how-pipenv-and-poetry-stores-if-dependencies-platform-dependent" rel="canonical"/>
<!-- Feed -->
<link href="https://blog.wei-lee.me/feeds/all.atom.xml" rel="alternate" title="Those aren't written down are meant to be forgotten Full Atom Feed" type="application/atom+xml"/>
<!-- TODO: combine -->
<link href="https://blog.wei-lee.me/theme/css/style.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/pygments.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/pagefind-ui-custom.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/code.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/code-copy.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/custom.css" rel="stylesheet" type="text/css"/>
<link href="/pagefind/pagefind-ui.css" rel="stylesheet"/>
<!-- Custom fonts -->
<link href="https://fonts.googleapis.com/css?family=Montserrat:400,300" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css"/>
<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
<script>
    var siteUrl = 'https://blog.wei-lee.me';
  </script>
<script>
    var localTheme = localStorage.getItem('attila_theme');
    switch (localTheme) {
      case 'dark':
        document.documentElement.classList.add('theme-dark');
        break;
      case 'light':
        document.documentElement.classList.add('theme-light');
        break;
      default:
        break;
    }
  </script>
<meta content="遇到的問題 問題的根源 pipenv 怎麼處理 Poetry 怎麼處理 總結 遇到的問題 用 twine 上傳 Python 套件 在 mac 的本地端測試有成功，但丟上 CI 跑 …" name="description"/>
<meta content="Wei Lee" name="author"/>
<meta content="Python" name="tags"/>
<meta content="Dependency" name="tags"/>
<!-- Open Graph -->
<meta content="Those aren't written down are meant to be forgotten" prefix="og: http://ogp.me/ns#" property="og:site_name">
<meta content="pipenv 和 poerty 如何處理在不同作業系統下相依套件不同 " prefix="og: http://ogp.me/ns#" property="og:title">
<meta content="遇到的問題 問題的根源 pipenv 怎麼處理 Poetry 怎麼處理 總結 遇到的問題 用 twine 上傳 Python 套件 在 mac 的本地端測試有成功，但丟上 CI 跑 …" prefix="og: http://ogp.me/ns#" property="og:description">
<meta content="zh-tw" prefix="og: http://ogp.me/ns#" property="og:locale">
<meta content="https://blog.wei-lee.me/posts/tech/2020/02/how-pipenv-and-poetry-stores-if-dependencies-platform-dependent" prefix="og: http://ogp.me/ns#" property="og:url"/>
<meta content="article" prefix="og: http://ogp.me/ns#" property="og:type"/>
<meta content="2020-02-12 11:45:00+08:00" prefix="og: http://ogp.me/ns#" property="article:published_time"/>
<meta content="" prefix="og: http://ogp.me/ns#" property="article:modified_time"/>
<meta content="https://blog.wei-lee.me/author/wei-lee.html" prefix="og: http://ogp.me/ns#" property="article:author"/>
<meta content="Tech" prefix="og: http://ogp.me/ns#" property="article:section">
<meta content="Python" prefix="og: http://ogp.me/ns#" property="article:tag"/>
<meta content="Dependency" prefix="og: http://ogp.me/ns#" property="article:tag"/>
<meta content="https://blog.wei-lee.me//images/cover.jpeg" prefix="og: http://ogp.me/ns#" property="og:image"/>
<!-- Twitter Card -->
<meta content="summary_large_image" name="twitter:card"/>
<meta content="@clleew" name="twitter:site"/>
<meta content="pipenv 和 poerty 如何處理在不同作業系統下相依套件不同 " name="twitter:title"/>
<meta content="https://blog.wei-lee.me/posts/tech/2020/02/how-pipenv-and-poetry-stores-if-dependencies-platform-dependent" name="twitter:url"/>
<meta content="https://blog.wei-lee.me//images/cover.jpeg" name="twitter:image:src"/>
<meta content="遇到的問題 問題的根源 pipenv 怎麼處理 Poetry 怎麼處理 總結 遇到的問題 用 twine 上傳 Python 套件 在 mac 的本地端測試有成功，但丟上 CI 跑 …" name="twitter:description"/>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "name": "pipenv 和 poerty 如何處理在不同作業系統下相依套件不同",
  "headline": "pipenv 和 poerty 如何處理在不同作業系統下相依套件不同",
  "datePublished": "2020-02-12 11:45:00+08:00",
  "dateModified": "",
  "author": {
    "@type": "Person",
    "name": "Wei Lee",
    "url": "https://blog.wei-lee.me/author/wei-lee.html"
  },
  "image": "https://blog.wei-lee.me//images/cover.jpeg",
  "url": "https://blog.wei-lee.me/posts/tech/2020/02/how-pipenv-and-poetry-stores-if-dependencies-platform-dependent",
  "description": "遇到的問題 問題的根源 pipenv 怎麼處理 Poetry 怎麼處理 總結 遇到的問題 用 twine 上傳 Python 套件 在 mac 的本地端測試有成功，但丟上 CI 跑 …"
}
</script>
</meta></meta></meta></meta></meta></link></meta><link href="https://blog.wei-lee.me/posts/tech/2020/02/how-pipenv-and-poetry-stores-if-dependencies-platform-dependent" rel="canonical"/><script type="application/ld+json">{"@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [{"@type": "ListItem", "position": 1, "name": "Those aren't written down are meant to be forgotten", "item": "https://blog.wei-lee.me"}, {"@type": "ListItem", "position": 2, "name": "Posts", "item": "https://blog.wei-lee.me/posts"}, {"@type": "ListItem", "position": 3, "name": "Tech", "item": "https://blog.wei-lee.me/posts/tech"}, {"@type": "ListItem", "position": 4, "name": "2020", "item": "https://blog.wei-lee.me/posts/tech/2020"}, {"@type": "ListItem", "position": 5, "name": "02", "item": "https://blog.wei-lee.me/posts/tech/2020/02"}, {"@type": "ListItem", "position": 6, "name": "How pipenv and poetry stores if dependencies platform dependent", "item": "https://blog.wei-lee.me/posts/tech/2020/02/how-pipenv-and-poetry-stores-if-dependencies-platform-dependent"}, {"@type": "ListItem", "position": 7, "name": "Index", "item": "https://blog.wei-lee.me/posts/tech/2020/02/how-pipenv-and-poetry-stores-if-dependencies-platform-dependent/index.html"}]}</script><script type="application/ld+json">{"@context": "https://schema.org", "@type": "Article", "author": {"@type": "Person", "name": "Wei Lee"}, "publisher": {"@type": "Organization", "name": "Those aren't written down are meant to be forgotten"}, "headline": "pipenv 和 poerty 如何處理在不同作業系統下相依套件不同", "about": "Tech", "datePublished": "2020-02-12 11:45"}</script></head>
<body class="category-template">
<div class="nav-header">
<nav aria-label="Main" class="nav-wrapper">
<ul>
<li class="nav-🏠 Home" role="presentation"><a href="/"><span>🏠 Home</span></a></li>
<li class="nav-About Me" role="presentation"><a href="/pages/about-me.html"><span>About Me</span></a></li>
<li class="nav-🗄️ Archives" role="presentation"><a href="/archives.html"><span>🗄️ Archives</span></a></li>
<li class="nav-📚 Series" role="presentation"><a href="/series_list.html"><span>📚 Series</span></a></li>
<li class="nav-🔍 Search" role="presentation"><a href="/search.html"><span>🔍 Search</span></a></li>
<li role="presentation"><a href="https://blog.wei-lee.me/category/book.html"><span>Book</span></a></li>
<li role="presentation"><a href="https://blog.wei-lee.me/category/gossiping.html"><span>Gossiping</span></a></li>
<li class="nav-tech active" role="presentation"><a href="https://blog.wei-lee.me/category/tech.html"><span>Tech</span></a></li>
</ul>
<ul class="nav-meta">
<li class="nav-linkedin"><a aria-label="Linkedin" href="https://tw.linkedin.com/in/clleew" target="_blank"><i aria-hidden="true" class="icon icon-linkedin"></i>
<span>Linkedin</span>
</a></li>
<li class="nav-github"><a aria-label="Github" href="https://github.com/Lee-W" target="_blank"><i aria-hidden="true" class="icon icon-github"></i>
<span>GitHub</span>
</a></li>
<li class="nav-twitter"><a aria-label="Twitter" href="https://twitter.com/clleew" target="_blank"><i aria-hidden="true" class="icon icon-twitter"></i>
<span>Twitter</span>
</a></li>
<li class="nav-search" style="display: none;">
<a title="Search">
<i aria-hidden="true" class="icon icon-search"></i>
<span>Search</span>
</a>
</li>
</ul> </nav>
<div class="nav-wrapper-control">
<div class="inner">
<a class="nav-menu" role="button"><i aria-hidden="true" class="icon icon-menu"></i>Menu</a>
<a class="nav-search" role="button" style="display: none;" title="Search"><i aria-hidden="true" class="icon icon-search"></i></a>
</div>
</div>
</div>
<div aria-label="Close" class="nav-close" role="button"></div>
<section class="page-wrapper" id="wrapper">
<!-- Progressbar -->
<div class="progress-container">
<span class="progress-bar"></span>
</div>
<!-- Page Header -->
<!-- Set your background image for this header on the line below. -->
<header class="post-header has-cover">
<div class="inner">
<span class="post-info">
<span class="post-type">Article</span>
<span class="post-count">Tech</span>
</span>
<h1 class="post-title">
            pipenv 和 poerty 如何處理在不同作業系統下相依套件不同
        </h1>
<div class="post-meta">
<div class="post-meta-avatars">
<figure class="post-meta-avatar avatar">
<a class="author-avatar" href="https://blog.wei-lee.me/author/wei-lee.html">
<img alt="Wei Lee" class="author-profile-image" src="https://blog.wei-lee.me//images/avatar.jpeg"/>
</a>
</figure>
</div>
<h4 class="post-meta-author">
            Wei Lee
          </h4>
<time datetime="2020/02/12 - Wed">2020/02/12 - Wed</time>
          • 2 min read
        </div>
<div class="post-cover cover">
<img alt="Category Tech" src="https://blog.wei-lee.me//images/cover.jpeg"/>
</div>
</div>
</header>
<!-- Post content -->
<main class="content" data-pagefind-body="" role="main">
<article class="post">
<div class="inner">
<section class="post-content">
<div class="toc">
<ul>
<li><a href="#_1">遇到的問題</a></li>
<li><a href="#_2">問題的根源</a></li>
<li><a href="#pipenv">pipenv 怎麼處理</a></li>
<li><a href="#poetry">Poetry 怎麼處理</a></li>
<li><a href="#_3">總結</a></li>
</ul>
</div>
<h2 id="_1">遇到的問題</h2>
<p>用 <a href="https://twine.readthedocs.io/en/latest/">twine</a> 上傳 Python 套件<br/>
在 mac 的本地端測試有成功，但丟上 CI 跑在 Ubuntu 的 image 內會缺少 <code>jeepney</code> 套件</p>
<h2 id="_2">問題的根源</h2>
<p>目前最新版 (3.1.1) 的 twine 相依於套件 <a href="https://github.com/jaraco/keyring">keyring</a> (<a href="https://github.com/pypa/twine/blob/3.1.1/setup.cfg#L44">setup.cfg#L44</a>)<br/>
而 keyring 在不同的作業系統中，相依的套件是不同的 (<a href="https://github.com/jaraco/keyring/blob/master/setup.cfg#L30">setup.cfg#L30</a>)</p>
<div class="highlight"><pre><span></span><code><span class="n">install_requires</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="err">pywin</span><span class="mi">32</span><span class="n">-ctypes</span><span class="err">!</span><span class="o">=</span><span class="mf">0.1</span><span class="p">.</span><span class="n">0</span><span class="err">,!</span><span class="o">=</span><span class="mf">0.1</span><span class="p">.</span><span class="n">1</span><span class="err">;</span><span class="w"> </span><span class="n">sys_platform</span><span class="o">=</span><span class="err">=</span><span class="s2">"win32"</span>
<span class="w">    </span><span class="n">SecretStorage</span><span class="err">&gt;</span><span class="o">=</span><span class="mi">3</span><span class="err">;</span><span class="w"> </span><span class="n">sys_platform</span><span class="o">=</span><span class="err">=</span><span class="s2">"linux"</span>
<span class="w">    </span><span class="n">jeepney</span><span class="err">&gt;</span><span class="o">=</span><span class="mf">0.4</span><span class="p">.</span><span class="n">2</span><span class="err">;</span><span class="w"> </span><span class="n">sys_platform</span><span class="o">=</span><span class="err">=</span><span class="s2">"linux"</span>
<span class="w">    </span><span class="n">importlib_metadata</span><span class="err">;</span><span class="w"> </span><span class="n">python_version</span><span class="w"> </span><span class="err">&lt;</span><span class="w"> </span><span class="s2">"3.8"</span>
</code></pre></div>
<p>我缺少的的確就是那幾個 <code>sys_platform=="linux"</code> 的套件</p>
<h2 id="pipenv">pipenv 怎麼處理</h2>
<p>基本上 <code>pipenv</code> 不算有解決這個問題， <code>pipenv</code> 只會將目前系統的所需套件寫進 <strong>Pipfile.lock</strong></p>
<p>以 twine 為例，在 macOS 透過 <code>pipenv</code> 安裝 ，跑 <code>pipenv graph</code>指令<br/>
就會發現 keyring 只會直接相依於 importlib-metadata</p>
<div class="highlight"><pre><span></span><code>  - keyring [required: &gt;=15.1, installed: 21.1.0]
    - importlib-metadata [required: Any, installed: 1.5.0]
      - zipp [required: &gt;=0.5, installed: 2.2.0]
</code></pre></div>
<p>但換到 Ubuntu 上跑，就會多了 SecretStorage 跟 jeepney</p>
<div class="highlight"><pre><span></span><code>  - keyring [required: &gt;=15.1, installed: 21.1.0]
    - importlib-metadata [required: Any, installed: 1.5.0]
      - zipp [required: &gt;=0.5, installed: 2.2.0]
    - jeepney [required: &gt;=0.4.2, installed: 0.4.2]
    - SecretStorage [required: &gt;=3, installed: 3.1.2]
      - cryptography [required: Any, installed: 2.8]
        - cffi [required: &gt;=1.8,!=1.11.3, installed: 1.14.0]
          - pycparser [required: Any, installed: 2.19]
        - six [required: &gt;=1.4.1, installed: 1.14.0]
      - jeepney [required: &gt;=0.4.2, installed: 0.4.2]
</code></pre></div>
<p>這個問題也有其他人提過 (<a href="https://github.com/pypa/pipenv/issues/3902">Cross-platform Pipenv.lock? #3902</a>)</p>
<p><code>pipenv</code> 貢獻者給的建議是使用 <code>pipenv install --keep-outdated</code><br/>
但這個指令的說明是 <strong>Keep out-dated dependencies from being updated in Pipfile.lock.</strong><br/>
總覺得好像不是在這個 use case 下使用的</p>
<p>最後我的解決方案是是把那幾個平台相依的套件安裝進去<br/>
原因是在 production 的環境就是需要這幾個多安裝的套件，我在 local 多裝幾個套件好像也沒什麼差<br/>
但如果今天是相反的狀況，我可能就會傾向 local 跑在 docker 裡</p>
<h2 id="poetry">Poetry 怎麼處理</h2>
<p><a href="https://python-poetry.org/">poerty</a> 對這個問題則是有比較好的解法</p>
<p>透過 poetry 安裝 twine 後<br/>
產生的 <strong>poetry.lock</strong> 會把 <code>marker = "sys_platform == \"linux\""</code> 記錄下來<br/>
實際 <code>poetry shell</code> 進去看，的確也沒多安裝這些套件</p>
<div class="highlight"><pre><span></span><code><span class="k">[[package]]</span>
<span class="n">category</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"main"</span>
<span class="n">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Store and access your passwords safely."</span>
<span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"keyring"</span>
<span class="n">optional</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
<span class="n">python-versions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"&gt;=3.6"</span>
<span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"21.1.0"</span>

<span class="k">[package.dependencies]</span>
<span class="n">SecretStorage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"&gt;=3"</span>
<span class="n">jeepney</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"&gt;=0.4.2"</span>
<span class="n">pywin32-ctypes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"&lt;0.1.0 || &gt;0.1.0,&lt;0.1.1 || &gt;0.1.1"</span>

<span class="p">......</span>

<span class="k">[[package]]</span>
<span class="n">category</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"main"</span>
<span class="n">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Python bindings to FreeDesktop.org Secret Service API"</span>
<span class="n">marker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"sys_platform == </span><span class="se">\"</span><span class="s2">linux</span><span class="se">\"</span><span class="s2">"</span>
<span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"secretstorage"</span>
<span class="n">optional</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
<span class="n">python-versions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"&gt;=3.5"</span>
<span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"3.1.2"</span>
</code></pre></div>
<h2 id="_3">總結</h2>
<p>poetry 在處理不同平台相依套件不同的狀況，處理得比較好<br/>
它會把所有需要的資訊記錄下來，在不同的平台進行不同的安裝</p>
<p>如果要用 pipenv 則可以使用 <code>pipenv install --keep-outdated</code><br/>
或者就直接多安裝這幾個不是每個平台都需要的套件</p>
</section>
<section class="post-footer">
<div class="post-share">
<span class="post-info-label">Share</span>
<a aria-label="Twitter" class="twitter" href="https://twitter.com/share?text=pipenv 和 poerty 如何處理在不同作業系統下相依套件不同 &amp;url=https://blog.wei-lee.me/posts/tech/2020/02/how-pipenv-and-poetry-stores-if-dependencies-platform-dependent" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title="Twitter">
<i aria-hidden="true" class="icon icon-twitter"></i><span class="hidden">Twitter</span>
</a>
<a aria-label="Facebook" class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.wei-lee.me/posts/tech/2020/02/how-pipenv-and-poetry-stores-if-dependencies-platform-dependent" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title="Facebook">
<i aria-hidden="true" class="icon icon-facebook"></i><span class="hidden">Facebook</span>
</a>
<a aria-label="LinkedIn" class="linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://blog.wei-lee.me/posts/tech/2020/02/how-pipenv-and-poetry-stores-if-dependencies-platform-dependent&amp;title=pipenv 和 poerty 如何處理在不同作業系統下相依套件不同" onclick="window.open(this.href, 'linkedin-share', 'width=930,height=720');return false;" title="LinkedIn">
<i aria-hidden="true" class="icon icon-linkedin"></i><span class="hidden">LinkedIn</span>
</a>
<a aria-label="Email" class="email" href="mailto:?subject=pipenv 和 poerty 如何處理在不同作業系統下相依套件不同&amp;body=https://blog.wei-lee.me/posts/tech/2020/02/how-pipenv-and-poetry-stores-if-dependencies-platform-dependent" title="Email">
<i aria-hidden="true" class="icon icon-mail"></i><span class="hidden">Email</span>
</a>
<div class="clear"></div>
</div>
<aside class="post-tags">
<a href="https://blog.wei-lee.me/tag/python.html">Python</a><a href="https://blog.wei-lee.me/tag/dependency.html">Dependency</a> </aside>
<div class="clear"></div>
</section>
<script type="text/javascript">var use_utterance = true;</script>
<section class="post-comments">
<script async="" crossorigin="anonymous" data-issue-term="https://blog.wei-lee.me/posts/tech/2020/02/how-pipenv-and-poetry-stores-if-dependencies-platform-dependent" data-label="blog-comment" data-repo="Lee-W/main-blog" data-theme="github-light" src="https://utteranc.es/client.js">
</script>
</section>
<aside class="post-nav">
<div class="clear"></div>
</aside>
</div>
</article>
</main>
<div class="nav-footer">
<nav aria-label="Footer" class="nav-wrapper">
<span class="nav-copy">Those aren't written down are meant to be forgotten © 2023
          <a class="nav-rss" href="https://blog.wei-lee.me/feeds/all.atom.xml" target="_blank" title="RSS"><i class="icon icon-rss"></i></a>
</span>
<span class="nav-credits">



          Published with <a href="https://github.com/getpelican/pelican" rel="nofollow">Pelican</a> • Theme <a href="https://github.com/arulrajnet/attila" rel="nofollow">Attila</a> •
          <a class="menu-item js-theme" data-dark="Dark theme" data-light="Light theme" data-system="System theme" href="#">
<span class="theme-icon"></span><span class="theme-text">System theme</span>
</a>
</span>
</nav>
</div>
</section>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
<!-- TODO: minify -->
<script src="https://blog.wei-lee.me/theme/js/jquery.fitvids.js" type="text/javascript"></script>
<script src="https://blog.wei-lee.me/theme/js/script.js" type="text/javascript"></script>
<script src="https://blog.wei-lee.me/theme/js/clipboard.min.js" type="text/javascript"></script>
<script src="https://blog.wei-lee.me/theme/js/copy-to-clipboard.js" type="text/javascript"></script>
<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-3J7XQ46QH5"></script>
<script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-3J7XQ46QH5', { 'anonymize_ip': true });
    </script>
<script src="/pagefind/pagefind-ui.js"></script>
<script>
      window.addEventListener('DOMContentLoaded', (event) => {
          new PagefindUI({
              element: "#search",
              showImages: false,
          });
      });
  </script>
<!-- 	The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in article.html, but it needs to be included down here, after jQuery has already loaded. -->
<script>
  $(document).ready(function () {
    var viewport = $(window);
    var post = $('.post-content');
    // Responsive videos with fitVids
    post.fitVids();

    // Reading progress bar on window top
    function readingProgress() {
      var postBottom = post.offset().top + post.height();
      var viewportHeight = viewport.height();
      var progress = 100 - (((postBottom - (viewport.scrollTop() + viewportHeight) + viewportHeight / 3) / (postBottom - viewportHeight + viewportHeight / 3)) * 100);
      $('.progress-bar').css('width', progress + '%');
      (progress > 100) ? $('.progress-container').addClass('complete'): $('.progress-container').removeClass('complete');
    }
    readingProgress();
    // Trigger reading progress
    viewport.on({
      'scroll': function() {
        readingProgress();
      },
      'resize': function() {
        readingProgress();
      },
      'orientationchange': function() {
        readingProgress();
      }
    });

  });
</script>
</body>
</html>

<!DOCTYPE html>

<html lang="zh-tw">
<head>
<meta charset="utf-8"/>
<meta charset="utf-8" content="text/html" http-equiv="Content-Type">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"/>
<title>Python Table Manners - æ¸¬è©¦ (äºŒ) </title>
<meta content="True" name="HandheldFriendly"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="origin" name="referrer"/>
<meta content="Pelican" name="generator"/>
<link href="https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-test-2" rel="canonical"/>
<!-- Feed -->
<link href="https://blog.wei-lee.me/feeds/all.atom.xml" rel="alternate" title="Those aren't written down are meant to be forgotten Full Atom Feed" type="application/atom+xml"/>
<!-- TODO: combine -->
<link href="https://blog.wei-lee.me/theme/css/style.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/pygments.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/pagefind-ui-custom.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/code.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/code-copy.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/custom.css" rel="stylesheet" type="text/css"/>
<link href="/pagefind/pagefind-ui.css" rel="stylesheet"/>
<!-- Custom fonts -->
<link href="https://fonts.googleapis.com/css?family=Montserrat:400,300" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css"/>
<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
<script>
    var siteUrl = 'https://blog.wei-lee.me';
  </script>
<script>
    var localTheme = localStorage.getItem('attila_theme');
    switch (localTheme) {
      case 'dark':
        document.documentElement.classList.add('theme-dark');
        break;
      case 'light':
        document.documentElement.classList.add('theme-light');
        break;
      default:
        break;
    }
  </script>
<meta content="æ¥çºŒå‰ä¸€ç¯‡æåˆ°çš„ pytestï¼Œç¹¼çºŒçœ‹å®ƒçš„å…¶ä»–åŠŸèƒ½å§" name="description"/>
<meta content="Wei Lee" name="author"/>
<meta content="Python" name="tags"/>
<meta content="Test" name="tags"/>
<!-- Open Graph -->
<meta content="Those aren't written down are meant to be forgotten" prefix="og: http://ogp.me/ns#" property="og:site_name">
<meta content="Python Table Manners - æ¸¬è©¦ (äºŒ) " prefix="og: http://ogp.me/ns#" property="og:title">
<meta content="æ¥çºŒå‰ä¸€ç¯‡æåˆ°çš„ pytestï¼Œç¹¼çºŒçœ‹å®ƒçš„å…¶ä»–åŠŸèƒ½å§" prefix="og: http://ogp.me/ns#" property="og:description">
<meta content="zh-tw" prefix="og: http://ogp.me/ns#" property="og:locale">
<meta content="https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-test-2" prefix="og: http://ogp.me/ns#" property="og:url"/>
<meta content="article" prefix="og: http://ogp.me/ns#" property="og:type"/>
<meta content="2020-02-25 18:05:00+08:00" prefix="og: http://ogp.me/ns#" property="article:published_time"/>
<meta content="2020-10-04 15:46:00+08:00" prefix="og: http://ogp.me/ns#" property="article:modified_time"/>
<meta content="https://blog.wei-lee.me/author/wei-lee.html" prefix="og: http://ogp.me/ns#" property="article:author"/>
<meta content="Tech" prefix="og: http://ogp.me/ns#" property="article:section">
<meta content="Python" prefix="og: http://ogp.me/ns#" property="article:tag"/>
<meta content="Test" prefix="og: http://ogp.me/ns#" property="article:tag"/>
<meta content="https://blog.wei-lee.me/images/cover.jpeg" prefix="og: http://ogp.me/ns#" property="og:image"/>
<!-- Twitter Card -->
<meta content="summary_large_image" name="twitter:card"/>
<meta content="@clleew" name="twitter:site"/>
<meta content="Python Table Manners - æ¸¬è©¦ (äºŒ) " name="twitter:title"/>
<meta content="https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-test-2" name="twitter:url"/>
<meta content="https://blog.wei-lee.me/images/cover.jpeg" name="twitter:image:src"/>
<meta content="æ¥çºŒå‰ä¸€ç¯‡æåˆ°çš„ pytestï¼Œç¹¼çºŒçœ‹å®ƒçš„å…¶ä»–åŠŸèƒ½å§" name="twitter:description"/>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "name": "Python Table Manners - æ¸¬è©¦ (äºŒ)",
  "headline": "Python Table Manners - æ¸¬è©¦ (äºŒ)",
  "datePublished": "2020-02-25 18:05:00+08:00",
  "dateModified": "2020-10-04 15:46:00+08:00",
  "author": {
    "@type": "Person",
    "name": "Wei Lee",
    "url": "https://blog.wei-lee.me/author/wei-lee.html"
  },
  "image": "https://blog.wei-lee.me//images/cover.jpeg",
  "url": "https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-test-2",
  "description": "æ¥çºŒå‰ä¸€ç¯‡æåˆ°çš„ pytestï¼Œç¹¼çºŒçœ‹å®ƒçš„å…¶ä»–åŠŸèƒ½å§"
}
</script>
</meta></meta></meta></meta></meta></link></meta><link href="https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-test-2" rel="canonical"/><script type="application/ld+json">{"@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [{"@type": "ListItem", "position": 1, "name": "Those aren't written down are meant to be forgotten", "item": "https://blog.wei-lee.me"}, {"@type": "ListItem", "position": 2, "name": "Posts", "item": "https://blog.wei-lee.me/posts"}, {"@type": "ListItem", "position": 3, "name": "Tech", "item": "https://blog.wei-lee.me/posts/tech"}, {"@type": "ListItem", "position": 4, "name": "2020", "item": "https://blog.wei-lee.me/posts/tech/2020"}, {"@type": "ListItem", "position": 5, "name": "02", "item": "https://blog.wei-lee.me/posts/tech/2020/02"}, {"@type": "ListItem", "position": 6, "name": "Python table manners test 2", "item": "https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-test-2"}, {"@type": "ListItem", "position": 7, "name": "Index", "item": "https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-test-2/index.html"}]}</script><script type="application/ld+json">{"@context": "https://schema.org", "@type": "Article", "author": {"@type": "Person", "name": "Wei Lee"}, "publisher": {"@type": "Organization", "name": "Those aren't written down are meant to be forgotten"}, "headline": "Python Table Manners - æ¸¬è©¦ (äºŒ)", "about": "Tech", "datePublished": "2020-02-25 18:05"}</script><meta content="summary" name="twitter:card"/><meta content="https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-test-2" property="og:url"/><meta content="article" property="og:type"/><meta content="Python Table Manners - æ¸¬è©¦ (äºŒ)" property="og:title"/><meta content="C" property="og:locale"/></head>
<body class="category-template">
<div class="nav-header">
<nav aria-label="Main" class="nav-wrapper">
<ul>
<li class="nav-ğŸ  Home" role="presentation"><a href="/"><span>ğŸ  Home</span></a></li>
<li class="nav-About Me" role="presentation"><a href="/pages/about-me.html"><span>About Me</span></a></li>
<li class="nav-ğŸ‘¨â€ğŸ’» Tech active" role="presentation"><a href="/category/tech.html"><span>ğŸ‘¨â€ğŸ’» Tech</span></a></li>
<li class="nav-ğŸ“š Book Digest" role="presentation"><a href="/category/book.html"><span>ğŸ“š Book Digest</span></a></li>
<li class="nav-ğŸ’¬ Gossiping" role="presentation"><a href="/category/gossiping.html"><span>ğŸ’¬ Gossiping</span></a></li>
<li class="nav-ğŸ·ï¸ Tags" role="presentation"><a href="/tags.html"><span>ğŸ·ï¸ Tags</span></a></li>
<li class="nav-ğŸ—„ï¸ Archives" role="presentation"><a href="/archives.html"><span>ğŸ—„ï¸ Archives</span></a></li>
<li class="nav-ğŸ“š Series" role="presentation"><a href="/series_list.html"><span>ğŸ“š Series</span></a></li>
<li class="nav-ğŸ” Search" role="presentation"><a href="/search.html"><span>ğŸ” Search</span></a></li>
</ul>
<ul class="nav-meta">
<li class="nav-linkedin"><a aria-label="Linkedin" href="https://tw.linkedin.com/in/clleew" target="_blank"><i aria-hidden="true" class="icon icon-linkedin"></i>
<span>Linkedin</span>
</a></li>
<li class="nav-github"><a aria-label="Github" href="https://github.com/Lee-W" target="_blank"><i aria-hidden="true" class="icon icon-github"></i>
<span>GitHub</span>
</a></li>
<li class="nav-twitter"><a aria-label="Twitter" href="https://twitter.com/clleew" target="_blank"><i aria-hidden="true" class="icon icon-twitter"></i>
<span>Twitter</span>
</a></li>
<li class="nav-search" style="display: none;">
<a title="Search">
<i aria-hidden="true" class="icon icon-search"></i>
<span>Search</span>
</a>
</li>
</ul> </nav>
<div class="nav-wrapper-control">
<div class="inner">
<a class="nav-menu" role="button"><i aria-hidden="true" class="icon icon-menu"></i>Menu</a>
<a class="nav-search" role="button" style="display: none;" title="Search"><i aria-hidden="true" class="icon icon-search"></i></a>
</div>
</div>
</div>
<div aria-label="Close" class="nav-close" role="button"></div>
<section class="page-wrapper" id="wrapper">
<!-- Progressbar -->
<div class="progress-container">
<span class="progress-bar"></span>
</div>
<!-- Page Header -->
<!-- Set your background image for this header on the line below. -->
<header class="post-header has-cover">
<div class="inner">
<span class="post-info">
<span class="post-type">Article</span>
<span class="post-count">Tech</span>
</span>
<h1 class="post-title">
            Python Table Manners - æ¸¬è©¦ (äºŒ)
        </h1>
<div class="post-meta">
<div class="post-meta-avatars">
<figure class="post-meta-avatar avatar">
<a class="author-avatar" href="https://blog.wei-lee.me/author/wei-lee.html">
<img alt="Wei Lee" class="author-profile-image" src="https://blog.wei-lee.me//images/avatar.jpeg"/>
</a>
</figure>
</div>
<h4 class="post-meta-author">
            Wei Lee
          </h4>
<time datetime="2020/02/25 - Tue">2020/02/25 - Tue</time>
          â€¢ <time datetime="2020/10/04 - Sun"> Updated on 2020/10/04 - Sun</time>
          â€¢ 3 min read
        </div>
<div class="post-cover cover">
<img alt="Category Tech" src="https://blog.wei-lee.me/images/cover.jpeg"/>
</div>
</div>
</header>
<!-- Post content -->
<main class="content" data-pagefind-body="" role="main">
<article class="post">
<div class="inner">
<section class="post-content">
<p>æ¥çºŒå‰ä¸€ç¯‡æåˆ°çš„ <a href="https://docs.pytest.org/en/6.1.1/">pytest</a>ï¼Œç¹¼çºŒçœ‹å®ƒçš„å…¶ä»–åŠŸèƒ½å§</p>
<!--more-->
<div class="toc">
<ul>
<li><a href="#fixture">fixture</a><ul>
<li><a href="#_1">æº–å‚™ / æ¸…é™¤è³‡æº</a></li>
<li><a href="#scope">scope</a></li>
<li><a href="#conftestpy">conftest.py</a></li>
<li><a href="#fixture_1">å¸¸ç”¨çš„å…§å»º fixture</a></li>
</ul>
</li>
<li><a href="#parameterize">åƒæ•¸åŒ– (parameterize)</a></li>
<li><a href="#marker">marker</a><ul>
<li><a href="#marker_1">å…§å»º marker</a></li>
<li><a href="#marker_2">è‡ªå®šç¾© marker</a></li>
</ul>
</li>
<li><a href="#_2">æ¸¬è©¦ä¾‹å¤–äº‹ä»¶</a></li>
<li><a href="#pytest">pytest å¸¸ç”¨å‘½ä»¤åˆ—åƒæ•¸</a></li>
<li><a href="#pytest-cov">pytest-cov æ¸¬è©¦è¦†è“‹ç‡</a></li>
<li><a href="#plugins">å…¶ä»–å¸¸ç”¨ plugins</a></li>
<li><a href="#_3">å…¶ä»–æ¸¬è©¦å·¥å…·</a></li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>
<h2 id="fixture">fixture</h2>
<p><a href="https://docs.pytest.org/en/6.1.1/fixture.html">fixture</a> å¹¾ä¹å¯ä»¥èªªæ˜¯ pytest æœ€é‡è¦çš„åŠŸèƒ½<br/>
å‰ä¸€ç¯‡çš„ä¾‹å­ä¸­åªæœ‰ç”¨åˆ°æº–å‚™è³‡æºçš„éƒ¨åˆ†<br/>
é€™è£¡å†èˆ‰ä¸€äº›ä¾‹å­ä¾†èªªæ˜å®ƒçš„å…¶ä»–æ‡‰ç”¨</p>
<h3 id="_1">æº–å‚™ / æ¸…é™¤è³‡æº</h3>
<p>å‡è¨­æˆ‘å€‘å·²ç¶“æœ‰äº†è™›æ§‹çš„ <code>db</code> å‡½å¼åº«ï¼Œå®ƒå¯ä»¥è™•ç†å„ç¨®è³‡æ–™åº«ç›¸é—œçš„åŠŸèƒ½</p>
<p>ç¾åœ¨å¯«ä¸€å€‹æ¸¬è©¦æ¡ˆä¾‹ä¾†é©—è­‰ <code>is_connected</code> å‡½å¼æ˜¯å¦èƒ½æ­£ç¢ºçš„åˆ¤æ–·è³‡æ–™åº«æœ‰é€£ç·š</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pytest</span>

<span class="kn">from</span> <span class="nn">db</span> <span class="kn">import</span> <span class="n">DB</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s2">"function"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">db</span><span class="p">():</span>
    <span class="c1"># åˆå§‹åŒ– DB çš„ instance</span>
    <span class="n">_db</span> <span class="o">=</span> <span class="n">DB</span><span class="p">()</span>
    <span class="c1"># é€£æ¥åˆ°è³‡æ–™åº«</span>
    <span class="n">_db</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>

    <span class="k">yield</span> <span class="n">_db</span>

    <span class="c1"># æ–·é–‹è³‡æ–™åº«é€£ç·š</span>
    <span class="n">_db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">test_db_is_connected</span><span class="p">(</span><span class="n">db</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">db</span><span class="o">.</span><span class="n">is_connected</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">True</span>
</code></pre></div>
<p>fixture <code>db</code> ä¸­ä¸ä½¿ç”¨ <code>return</code> è€Œæ˜¯ä½¿ç”¨ <code>yield</code><br/>
é€£ç·šè³‡æ–™åº«å¾Œï¼Œå°±å…ˆå°‡ <code>_db</code> instance å›å‚³<br/>
åœ¨ <code>test_db_is_connected</code> å¼•å…¥ fixture <code>db</code> æ™‚ï¼Œè³‡æ–™åº«æœƒè™•æ–¼é€£ç·šçš„ç‹€æ…‹<br/>
çµæŸå¾Œï¼Œå‰‡æœƒåŸ·è¡Œ <code>_db.close()</code> æ–·é–‹è³‡æ–™åº«çš„é€£ç·š<br/>
ï¼ˆä»€éº¼æ™‚å€™æ‰ç®—çµæŸå‰‡æ˜¯çœ‹ <code>fixture</code> çš„åƒæ•¸ <code>scope</code>ï¼Œé€™æœƒåœ¨å¾Œé¢èªªæ˜ï¼‰</p>
<p>æ¥ä¸‹ä¾†æˆ‘é‚„æƒ³è¦èªªæ˜å…©å€‹æ¦‚å¿µ</p>
<ol>
<li><code>fixture</code> ä¸­ä½¿ç”¨ <code>fixture</code></li>
<li>ç”¨ <code>fixture</code> æº–å‚™è·Ÿæ¸…é™¤è³‡æºï¼Œä½†ä¸ç›´æ¥å‘¼å«åˆ°è³‡æº (<code>pytest.mark.usefixtures</code>)</li>
</ol>
<p>ç¾åœ¨å‡è¨­å·²ç¶“å¯¦ä½œäº† <code>model</code>ï¼Œè£¡é¢æœ‰ <code>User</code> çš„å®šç¾©<br/>
æˆ‘å€‘æƒ³è¦é©—è­‰æ–°å¢äº†ä¸€ç­† admin çš„ä½¿ç”¨è€…å¾Œï¼Œæ˜¯å¦èƒ½æˆåŠŸæŸ¥è©¢åˆ°é€™ç­†è³‡æ–™</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pytest</span>

<span class="kn">from</span> <span class="nn">db</span> <span class="kn">import</span> <span class="n">DB</span>
<span class="kn">from</span> <span class="nn">model</span> <span class="kn">import</span> <span class="n">User</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s2">"function"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">db</span><span class="p">():</span>
    <span class="n">_db</span> <span class="o">=</span> <span class="n">DB</span><span class="p">()</span>
    <span class="n">_db</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>

    <span class="k">yield</span>

    <span class="n">_db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixtures</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s2">"function"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">insert_admin_user</span><span class="p">(</span><span class="n">db</span><span class="p">):</span>
    <span class="c1"># åˆå§‹åŒ– user</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"admin"</span><span class="p">)</span>
    <span class="c1"># å°‡ user æ–°å¢åˆ°è³‡æ–™åº«</span>
    <span class="n">db</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>

    <span class="k">yield</span>
    <span class="c1"># å°‡ user å¾è³‡æ–™åº«ç§»é™¤</span>
    <span class="n">db</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">usefixtures</span><span class="p">(</span><span class="s2">"insert_admin_user"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_admin_user_exists</span><span class="p">():</span>
    <span class="c1"># å¾è³‡æ–™åº«ä¸­æ‰¾å‡ºç¬¬ä¸€ç­† name æ˜¯ admin çš„ user</span>
    <span class="n">admin_user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">filter_by</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"admin"</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">admin_user</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</code></pre></div>
<p>æ–°å¢è³‡æ–™å‰ï¼Œå¿…é ˆå…ˆè·Ÿè³‡æ–™åº«å»ºç«‹é€£ç·š<br/>
å› æ­¤æº–å‚™è³‡æ–™çš„ fixture <code>insert_admin_user</code> æœƒä½¿ç”¨åˆ° <code>db</code> fixture</p>
<p>è€Œæ¸¬è©¦å‡½å¼ <code>test_admin_user_exists</code> ï¼Œéœ€è¦å·²ç¶“æœ‰ admin ä½¿ç”¨è€…çš„è³‡æ–™åº«ï¼Œä¾†æ¸¬è©¦ <code>User.query.filter(name="admin").first()</code> æ˜¯å¦èƒ½æˆåŠŸå–å¾—è³‡æ–™<br/>
ä½†å®ƒä¸éœ€è¦ç”¨åˆ° <code>insert_admin_user</code> é€™å€‹è®Šæ•¸ï¼Œå› æ­¤å°±èƒ½æ”¹æˆä½¿ç”¨ <code>pytest.mark.usefixtures</code><br/>
é€™æ¨£å°±èƒ½åœ¨ä¸å¼•å…¥åƒæ•¸çš„æƒ…æ³ä¸‹ï¼Œä½¿ç”¨ fixture è¨­å®šå¥½çš„ç’°å¢ƒ</p>
<h3 id="scope">scope</h3>
<p>fixture çš„ <a href="https://docs.pytest.org/en/6.1.1/fixture.html#scope-sharing-a-fixture-instance-across-tests-in-a-class-module-or-session">scope</a> å…±åˆ†ç‚ºäº”ç¨® ï¼ˆfunction, class, module, package, sessionï¼‰<br/>
è¡¨ç¤º fixture æœƒåœ¨å“ªå€‹éšæ®µå‰æº–å‚™è³‡æºï¼Œä¸¦åœ¨å“ªå€‹éšæ®µå¾Œæ¸…é™¤<br/>
å¦‚æœè¨­å®šæˆ functionï¼Œå°±æœƒåœ¨æ¯ä¸€å€‹æ¸¬è©¦å‡½å¼åŸ·è¡Œå‰å’Œå¾Œåšè³‡æºçš„è™•ç†</p>
<h3 id="conftestpy">conftest.py</h3>
<p><a href="https://docs.pytest.org/en/2.7.3/plugins.html?#conftest-py-local-per-directory-plugins">conftest.py</a> æ˜¯ pytest ä¸­çš„ä¸€å€‹ç‰¹æ®Šæª”æ¡ˆ<br/>
å¦‚æœæ˜¯æ•´å€‹å¥—ä»¶ï¼ˆåŒä¸€å€‹è³‡æ–™å¤¾ï¼‰éƒ½æœƒç”¨åˆ°çš„ fixture å°±èƒ½æ”¾åœ¨é€™ï¼Œ pytest åŸ·è¡Œæ™‚æœƒè‡ªå‹•è¼‰å…¥</p>
<p>ä»¥ä¸‹é¢çš„çµæ§‹ç‚ºä¾‹ï¼Œ <code>test_sponsor.py</code> å°±æœƒè‡ªå‹•è¼‰å…¥ä¸Šå±¤çš„ <code>conftest.py</code> ä¸­çš„ fixture</p>
<div class="highlight"><pre><span></span><code>â””â”€â”€ tests
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ conftest.py
    â”œâ”€â”€ test_sponsor.py
    â””â”€â”€ page
        â”œâ”€â”€ __init__.py
        â”œâ”€â”€ conftest.py
        â””â”€â”€ test_title.py
</code></pre></div>
<h3 id="fixture_1">å¸¸ç”¨çš„å…§å»º fixture</h3>
<ul>
<li><a href="https://docs.pytest.org/en/6.1.1/reference.html#std:fixture-caplog">caplog</a>: æŠ“ log è¨Šæ¯</li>
<li><a href="https://docs.pytest.org/en/6.1.1/reference.html#std:fixture-capsys">capsys</a>: æŠ“ std out, std err</li>
<li><a href="https://docs.pytest.org/en/6.1.1/reference.html#std:fixture-tmpdir">tmpdir</a>: æš«æ™‚è³‡æ–™å¤¾ï¼Œé€šå¸¸ç”¨ä¾†æ¸¬æª”æ¡ˆç›¸é—œçš„æ¸¬è©¦</li>
</ul>
<h2 id="parameterize">åƒæ•¸åŒ– (parameterize)</h2>
<p>åœ¨æ¸¬è©¦è³‡æ–™æ¯”è¼ƒç°¡å–®çš„æ™‚å€™ï¼Œå¯ä»¥ä½¿ç”¨ <a href="https://docs.pytest.org/en/6.1.1/parametrize.html">parameterize</a> ä¾†æ¸›å°‘æ’°å¯«é‡è¤‡çš„ç¨‹å¼ç¢¼</p>
<ul>
<li><code>@pytest.mark.parametrize(args1, arg2)</code><ul>
<li>ç¬¬ä¸€å€‹åƒæ•¸: æŒ‡å®šæ¸¬è©¦å‡½å¼è¦ä½¿ç”¨çš„åƒæ•¸åç¨±</li>
<li>ç¬¬äºŒå€‹åƒæ•¸: æ¸¬è©¦è³‡æ–™çš„é™£åˆ—</li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pytest</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span>
    <span class="s2">"x, y, expected_sum"</span><span class="p">,</span>
    <span class="p">(</span>
        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
    <span class="p">),</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">test_add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">expected_sum</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">==</span> <span class="n">expected_sum</span>
</code></pre></div>
<h2 id="marker">marker</h2>
<p>å‰é¢å·²ç¶“ä»‹ç´¹é <code>parameterize</code> å’Œ <code>usefixtures</code><br/>
é€™è£¡æœƒä»‹ç´¹ <a href="http://doc.pytest.org/en/6.1.1/example/markers.html">markers</a> é‚„å¯ä»¥åšä»€éº¼</p>
<h3 id="marker_1">å…§å»º marker</h3>
<ul>
<li><a href="http://doc.pytest.org/en/6.1.1/skipping.html#skip">skip</a>: è·³éé€™å€‹æ¸¬è©¦æ¡ˆä¾‹</li>
<li><a href="http://doc.pytest.org/en/6.1.1/skipping.html#skipif">skipif</a>: å¦‚æœç¬¦åˆæŸå€‹æ¢ä»¶ï¼Œå‰‡è·³éé€™å€‹æ¸¬è©¦æ¡ˆä¾‹</li>
<li><a href="http://doc.pytest.org/en/6.1.1/skipping.html#xfail">xfail</a>: é æœŸæœƒå¤±æ•— ï¼ˆå…¶å¯¦å‰ä¸€ç¯‡æƒ³è·³éæœƒå¤±æ•—çš„æ¡ˆä¾‹æ‡‰è©²è¦ç”¨ <code>xfail</code>ï¼Œè€Œä¸æ˜¯ <code>skip</code>ï¼‰</li>
</ul>
<h3 id="marker_2">è‡ªå®šç¾© marker</h3>
<p><code>@pytest.mark.[any custom marker]</code> çš„ç”¨é€”æ˜¯æ¨™è¨˜æ¸¬è©¦æ¡ˆä¾‹<br/>
åƒæ˜¯å¦‚æœæœ‰äº›æ¸¬è©¦æœƒç‰¹åˆ¥æ…¢ï¼Œå°±å¯ä»¥é€éæ¨™è¨˜ <code>@pytest.mark.slow</code></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">slow</span>
<span class="k">def</span> <span class="nf">test_super_slow_test</span><span class="p">():</span>
    <span class="n">sleep</span><span class="p">(</span><span class="mi">99999999999999</span><span class="p">)</span>
</code></pre></div>
<p>åŸ·è¡Œæ™‚åŠ ä¸Šåƒæ•¸ <code>-m</code> å°±èƒ½è·³éï¼ˆæˆ–åªåŸ·è¡Œï¼‰é€™äº›æ¡ˆä¾‹</p>
<div class="highlight"><pre><span></span><code>pipenv run pytest -m "not slow"
</code></pre></div>
<p>ä¸Šé¢çš„åšæ³•ï¼Œå¦‚æœæœ‰æ¸¬è©¦æ¡ˆä¾‹ä¸å°å¿ƒæ‰“æˆ <code>@pytest.mark.slwo</code>ï¼Œæœƒä¸å¤ªå®¹æ˜“è¢«ç™¼ç¾<br/>
ä½† pytest é‚„æ˜¯æœƒæ­£å¸¸åŸ·è¡Œ<br/>
é€™æ™‚å€™å¯ä»¥åœ¨å°ˆæ¡ˆåŠ å…¥è¨­å®šæª” <code>pyproject.toml</code> (pytest 6.0.0 ä¹‹å¾Œæ‰æ”¯æ´é€™ç¨®è¨­å®šæª”æ ¼å¼) å®šç¾© marker<br/>
p.s. ä¸å»ºè­°ä½¿ç”¨ <code>setup.cfg</code> åšç‚º pytest çš„è¨­å®šæª” (Read More ğŸ‘‰ <a href="https://github.com/pytest-dev/pytest/issues/3523">deprecate setup.cfg support #3523</a>)</p>
<div class="highlight"><pre><span></span><code><span class="k">[tool.pytest.ini_options]</span>
<span class="n">minversion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"6.0"</span>
<span class="n">markers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">"slow"</span>
<span class="p">]</span>
</code></pre></div>
<p>ä¸¦åœ¨åŸ·è¡Œæ™‚åŠ ä¸Š <code>--strict-markers</code> åƒæ•¸</p>
<div class="highlight"><pre><span></span><code>pipenv<span class="w"> </span>run<span class="w"> </span>pytest<span class="w"> </span>--strict-markers<span class="w"> </span>-m<span class="w"> </span><span class="s2">"not slow"</span>
</code></pre></div>
<p>pytest å°±æœƒå‘Šè¨´æˆ‘å€‘ <code>slwo</code> ä¸¦ä¸æ˜¯è¢«å®šç¾©éçš„ maker</p>
<p>æ›´é€²ä¸€æ­¥å¯ä»¥æŠŠ <code>--strict-markers</code> ç›´æ¥å¯«å…¥ <code>pyproject.toml</code></p>
<div class="highlight"><pre><span></span><code><span class="k">[tool.pytest.ini_options]</span>
<span class="n">minversion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"6.0"</span>
<span class="n">addopts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"--strict-markers"</span>
<span class="n">markers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">"slow"</span>
<span class="p">]</span>
</code></pre></div>
<h2 id="_2">æ¸¬è©¦ä¾‹å¤–äº‹ä»¶</h2>
<p>é€é <code>pytest.raise</code> ç¢ºèªæ¸¬è©¦æ¡ˆä¾‹æ˜¯å¦æœ‰ç¬¦åˆé æœŸçš„ä¸Ÿå‡ºä¾‹å¤–äº‹ä»¶</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pytest</span>


<span class="k">def</span> <span class="nf">test_index_error</span><span class="p">():</span>
    <span class="n">some_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">IndexError</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">some_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div>
<h2 id="pytest">pytest å¸¸ç”¨å‘½ä»¤åˆ—åƒæ•¸</h2>
<ul>
<li><code>-v</code> (<code>-vv</code>, <code>-vvv</code>): é¡¯ç¤ºæ›´å¤šè³‡è¨Š ï¼ˆè¶Šå¤š v å°±æœƒé¡¯ç¤ºè¶Šå¤šè³‡è¨Šï¼‰</li>
<li><code>--durations=N</code>: åªåˆ—å‡ºæœ€æ…¢çš„ <em>N</em> å€‹æ¸¬è©¦</li>
<li><code>-x</code> (<code>--exitfirst</code>): é‡åˆ°ç¬¬ä¸€å€‹å¤±æ•—å°±çµ‚æ­¢æ¸¬è©¦</li>
<li><code>--maxfail=num</code>: å¤±æ•—æ¬¡æ•¸é”åˆ° <em>num</em> æ¬¡ï¼Œç›´æ¥çµ‚æ­¢æ¸¬è©¦</li>
<li><code>--lf</code> (<code>--last-failed</code>): åªæ¸¬è©¦ä¸Šæ¬¡å¤±æ•—çš„æ¡ˆä¾‹</li>
<li><code>--ff</code> (<code>--failed-first</code>): å¾ä¸Šæ¬¡å¤±æ•—çš„æ¡ˆä¾‹é–‹å§‹æ¸¬è©¦</li>
<li><code>--nf</code> <code>--new-first</code>: å¾æ–°çš„æ¡ˆä¾‹é–‹å§‹æ¸¬è©¦</li>
<li><code>-k EXPRESSION</code>: åªæ¸¬è©¦åç¨±ç¬¦åˆ "EXPRESSION" çš„æ¡ˆä¾‹</li>
<li><code>-m MARKEXPR</code>: åªæ¸¬è©¦æœ‰ "MARKEXPR" maker çš„æ¡ˆä¾‹</li>
<li><code>--fixtures</code>: åˆ—å‡ºæ‰€æœ‰ <code>fixtures</code></li>
</ul>
<h2 id="pytest-cov">pytest-cov æ¸¬è©¦è¦†è“‹ç‡</h2>
<p><a href="https://github.com/pytest-dev/pytest-cov">pytest-cov</a> å¯ä»¥ç”¨ä¾†ç”¢ç”Ÿæ¸¬è©¦è¦†è“‹ç‡çš„å ±å‘Šï¼Œè®“æˆ‘å€‘çŸ¥é“ç¨‹å¼ç¢¼é‚„æœ‰å“ªäº›æ²’è¢«æ¸¬è©¦åˆ°</p>
<div class="highlight"><pre><span></span><code><span class="c1"># å®‰è£ pytest-cov</span>
pipenv<span class="w"> </span>install<span class="w"> </span>pytest-cov<span class="w"> </span>--dev
</code></pre></div>
<p>e.g.,</p>
<div class="highlight"><pre><span></span><code><span class="c1"># è¨ˆç®— myproj çš„è¦†è“‹ç‡</span>
pipenv<span class="w"> </span>run<span class="w"> </span>pytest<span class="w"> </span>--cov<span class="o">=</span>myproj<span class="w"> </span>tests/
</code></pre></div>
<p>æ¯”è¼ƒé‡è¦çš„åƒæ•¸æœ‰</p>
<ul>
<li><code>--cov=[SOURCE]</code>: æ¸¬è©¦åŒ…å«çš„ç¨‹å¼ç¢¼ç¯„åœ</li>
<li><code>--cov-report=TYPE</code>: æ¸¬è©¦è¦†è“‹ç‡å ±å‘Šçš„ç¨®é¡ (term, term-missing, annotate, html, xml)</li>
<li><code>--cov-fail-under=MIN</code>: å¦‚æœè¦†è“‹ç‡å°æ–¼ <em>MIN</em> å‰‡è·³å‡º</li>
</ul>
<p>å…¶ä¸­ <code>--cov</code>, <code>--cov-report</code> éƒ½å¯ä»¥åŠ å…¥å¤šå€‹åƒæ•¸</p>
<p>å›åˆ° <a href="https://github.com/pycontw/pycontw-postevent-report-generator">pycontw-postevent-report-generator</a> çš„ä¾‹å­<br/>
å…ˆ checkout å› <a href="https://github.com/pycontw/pycontw-postevent-report-generator/tree/1.0.2">1.0.2</a>ï¼Œä¾†æ¸¬è©¦ 1.0.2 ä¸Šçš„æ¸¬è©¦è¦†è“‹ç‡</p>
<div class="highlight"><pre><span></span><code>pipenv<span class="w"> </span>run<span class="w"> </span>pytest<span class="w"> </span>--cov<span class="o">=</span>report_generator<span class="w"> </span>--cov-report<span class="o">=</span>term-missing<span class="w"> </span>test/
</code></pre></div>
<p>å¾ä¸‹é¢çš„çµæœå¯ä»¥çœ‹åˆ°å“ªäº›æª”æ¡ˆçš„å“ªäº›éƒ¨åˆ†æ²’æœ‰è¢«æ¸¬è©¦åˆ°</p>
<p><img alt="test-coverage" src="/images/posts-image/2020-02-22-python-table-manner-series/test-coverage.jpg"/></p>
<p>å¦‚æœæƒ³çœ‹ç²¾ç¾çš„ç¶²é ç‰ˆå ±å‘Šï¼Œå¯ä»¥è©¦è©¦çœ‹ä»¥ä¸‹çš„æŒ‡ä»¤<br/>
å ±å‘Šæœƒç”¢ç”Ÿåœ¨å°ˆæ¡ˆè³‡æ–™å¤¾ä¸‹çš„ <code>htmlcov</code></p>
<div class="highlight"><pre><span></span><code>pipenv<span class="w"> </span>run<span class="w"> </span>pytest<span class="w"> </span>--cov<span class="o">=</span>report_generator<span class="w"> </span>--cov-report<span class="o">=</span>term-missing<span class="w"> </span>--cov-report<span class="o">=</span>html
</code></pre></div>
<p>ä¸€äº›æ›´é€²éšçš„è¨­å®šï¼Œå¯ä»¥å¯«å…¥è¨­å®šæª” <code>pyproject.toml</code> (æˆ– <code>.coveragerc</code>ï¼Œä½†èªæ³•æœƒä¸å¤ªä¸€æ¨£)<br/>
ä»¥ä¸‹æ˜¯æˆ‘è‡ªå·±ä½¿ç”¨çš„ <code>pyproject.toml</code></p>
<div class="highlight"><pre><span></span><code><span class="k">[tool.coverage]</span>
<span class="w">    </span><span class="k">[tool.coverage.report]</span>
<span class="w">    </span><span class="n">show_missing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="n">exclude_lines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="c1"># Have to re-enable the standard pragma</span>
<span class="w">        </span><span class="s1">'pragma: no cover'</span><span class="p">,</span>

<span class="w">        </span><span class="c1"># Don't complain about missing debug-only code:</span>
<span class="w">        </span><span class="s1">'def __repr__'</span><span class="p">,</span>
<span class="w">        </span><span class="s1">'if self\.debug'</span><span class="p">,</span>

<span class="w">        </span><span class="c1"># Don't complain if tests don't hit defensive assertion code:</span>
<span class="w">        </span><span class="s1">'raise AssertionError'</span><span class="p">,</span>
<span class="w">        </span><span class="s1">'raise NotImplementedError'</span><span class="p">,</span>

<span class="w">        </span><span class="c1"># Don't complain if non-runnable code isn't run:</span>
<span class="w">        </span><span class="s1">'if 0:'</span><span class="p">,</span>
<span class="w">        </span><span class="s1">'if __name__ == .__main__.:'</span>
<span class="w">    </span><span class="p">]</span>
</code></pre></div>
<p>Read More ğŸ‘‰ <a href="https://coverage.readthedocs.io/en/coverage-5.0.3/config.html">Configuration reference</a></p>
<h2 id="plugins">å…¶ä»–å¸¸ç”¨ plugins</h2>
<ul>
<li><a href="https://pypi.org/project/pytest-xdist/">pytest-xdist</a><ul>
<li>ç”¨å¹³è¡ŒåŒ–åŠ é€Ÿæ¸¬è©¦çš„åŸ·è¡Œ (<code>pipenv run pytest -n NUM</code>)</li>
</ul>
</li>
<li><a href="https://github.com/pytest-dev/pytest-mock">pytest-mock</a><ul>
<li>ä½¿ç”¨ mocking çš„æŠ€å·§å°‡éƒ¨åˆ†ä¸å¥½æ¸¬è©¦çš„ç‰©ä»¶æ›¿æ›æˆå‡çš„ç‰©ä»¶</li>
<li>æ¨è–¦åƒè€ƒ <a href="https://wei-lee.me/pycon-note/posts/pycon-us-2018/2020/01/demystifying-the-Patch-functionusing-python/">Demystifying the Patch Function - PyCon US 2018</a> ï¼ˆä¸éå¥¹ä¸æ˜¯ç”¨ pytestï¼‰</li>
</ul>
</li>
<li><a href="https://github.com/ESSS/pytest-regressions">pytest-regressions</a><ul>
<li>å°‡å†—é•·çš„æ¸¬è©¦çµæœå¯«æˆæª”æ¡ˆï¼Œæ¯æ¬¡æ¸¬è©¦éƒ½å»æ¯”å°è·Ÿä¸Šæ¬¡ç”¢ç”Ÿçš„çµæœæ˜¯å¦ç›¸åŒ</li>
</ul>
</li>
<li>å°‹æ‰¾å…¶ä»– plugins<ul>
<li><a href="https://docs.pytest.org/en/6.1.1/plugins.html">pytest - Installing and Using pluginsÂ¶</a></li>
<li><a href="https://github.com/pytest-dev">pytest-dev</a></li>
</ul>
</li>
</ul>
<h2 id="_3">å…¶ä»–æ¸¬è©¦å·¥å…·</h2>
<ul>
<li><a href="https://tox.readthedocs.io/en/latest/">tox</a><ul>
<li>åœ¨å„ç¨®ä¸åŒç‰ˆæœ¬çš„ Python ä¸­åšæ¸¬è©¦ï¼Œå¹¾ä¹æ˜¯é–‹æº Python å°ˆæ¡ˆçš„æ¨™æº–å·¥å…·</li>
</ul>
</li>
<li><a href="https://nox.thea.codes/en/stable/">nox</a><ul>
<li>åŸºæœ¬ä¸Šè·Ÿ tox çš„åŠŸèƒ½ç›¸ä¼¼ï¼Œä¸éçµ„æ…‹è¨­å®šæ˜¯ä½¿ç”¨ Python</li>
<li>tox è·Ÿ nox æ¨è–¦åƒè€ƒ <a href="https://wei-lee.me/pycon-note/posts/pycon-us-2019/2019/08/break-the-cycle-three-excellent-python-tools-to-automate-repetitive-tasks/">Break the Cycle: Three excellent Python tools to automate repetitive tasks - PyCon US 2019</a></li>
</ul>
</li>
<li><a href="https://github.com/HypothesisWorks/hypothesis">hypothesis</a><ul>
<li>æ¡ç”¨ Property-based testingï¼Œè·Ÿä»¥å¾€è¦è‡ªå·±ç”¢ç”Ÿæ¸¬è©¦è³‡æ–™ä¸åŒï¼Œæˆ‘å€‘åªéœ€è¦çµ¦äºˆè³‡æ–™çš„å®šç¾©ï¼ˆe.g., 0 ~ 10000 ä¹‹é–“çš„æ•´æ•¸ï¼‰ï¼Œ hypothsis æœƒæ ¹æ“šå®šç¾©ä¾†ç”¢ç”Ÿéš¨æ©Ÿçš„è³‡æ–™ï¼Œä¹Ÿå› æ­¤æ›´å®¹æ˜“åŒ…å«åˆ°æ¥µç«¯æ¡ˆä¾‹</li>
<li>æ¨è–¦åƒè€ƒ <a href="https://wei-lee.me/pycon-note/posts/pycon-us-2019/2019/08/escape-from-auto-manual-testing-with-yypothesis/">Escape from auto-manual testing with Hypothesis!</a> ï¼ˆPyCon US 2019ï¼Œ Zac æŠ•äº† talk, sprint, tutorial, posterï¼Œå¾ˆç”¨å¿ƒåœ¨æ¨å»£é€™å¥—å·¥å…·ï¼‰</li>
</ul>
</li>
</ul>
<h2 id="reference">Reference</h2>
<ul>
<li><a href="https://pragprog.com/book/bopytest/python-testing-with-pytest">Python Testing with pytest</a></li>
<li><a href="https://www.youtube.com/watch?time_continue=201&amp;v=pX1_I_sEi8k">å¿«å¿«æ¨‚æ¨‚æˆç‚º Coding Ninja (by pytest) - PyCon APAC 2015</a></li>
<li><a href="https://wei-lee.me/pycon-note/posts/swiss-python-summit-2016/2019/11/pytest-rapid-simple-testing/">Pytest: Rapid Simple Testing -  Swiss Python Summit 2016</a></li>
<li><a href="https://wei-lee.me/pycon-note/posts/pycon-us-2018/2020/01/demystifying-the-Patch-functionusing-python/">Demystifying the Patch Function - PyCon US 2018</a></li>
<li><a href="https://wei-lee.me/pycon-note/posts/pycon-us-2019/2019/08/escape-from-auto-manual-testing-with-yypothesis/">Escape from auto-manual testing with Hypothesis!</a></li>
<li><a href="https://wei-lee.me/pycon-note/posts/pycon-us-2019/2019/08/break-the-cycle-three-excellent-python-tools-to-automate-repetitive-tasks/">Break the Cycle: Three excellent Python tools to automate repetitive tasks - PyCon US 2019</a></li>
</ul>
</section>
<section class="post-footer">
<div class="post-share">
<span class="post-info-label">Share</span>
<a aria-label="Twitter" class="twitter" href="https://twitter.com/share?text=Python Table Manners - æ¸¬è©¦ (äºŒ) &amp;url=https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-test-2" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title="Twitter">
<i aria-hidden="true" class="icon icon-twitter"></i><span class="hidden">Twitter</span>
</a>
<a aria-label="Facebook" class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-test-2" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title="Facebook">
<i aria-hidden="true" class="icon icon-facebook"></i><span class="hidden">Facebook</span>
</a>
<a aria-label="LinkedIn" class="linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-test-2&amp;title=Python Table Manners - æ¸¬è©¦ (äºŒ)" onclick="window.open(this.href, 'linkedin-share', 'width=930,height=720');return false;" title="LinkedIn">
<i aria-hidden="true" class="icon icon-linkedin"></i><span class="hidden">LinkedIn</span>
</a>
<a aria-label="Email" class="email" href="mailto:?subject=Python Table Manners - æ¸¬è©¦ (äºŒ)&amp;body=https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-test-2" title="Email">
<i aria-hidden="true" class="icon icon-mail"></i><span class="hidden">Email</span>
</a>
<div class="clear"></div>
</div>
<aside class="post-tags">
<a href="https://blog.wei-lee.me/tag/python.html">Python</a><a href="https://blog.wei-lee.me/tag/test.html">Test</a> </aside>
<div class="clear"></div>
<div class="series">
<p>This post is part 4 of the "Python Table Manners" series:</p>
<ol class="parts">
<li>
<a href="https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-series">Python Table Manners ç³»åˆ—</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-dependency-mangement">Python Table Manners - è™›æ“¬ç’°å¢ƒå’Œå¥—ä»¶ç®¡ç†</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-test-1">Python Table Manners - æ¸¬è©¦ (ä¸€)</a>
</li>
<li class="active">
<a href="https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-test-2">Python Table Manners - æ¸¬è©¦ (äºŒ)</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-coding-style">Python Table Manners - ç¨‹å¼ç¢¼é¢¨æ ¼</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-manage-trivial-tasks">Python Table Manners - ç®¡ç†ç¹ç‘£ä»»å‹™</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-pre-commit">Python Table Manners - pre-commit: git commit å‰åšå®Œæª¢æŸ¥</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2020/03/python-table-manners-commitizen">Python Table Manners - Commitizen: è¦æ ¼åŒ– commit message</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2020/03/python-table-manners-security">Python Table Manners - å®‰å…¨æ€§æª¢æŸ¥</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2020/04/python-table-manners-documentation">Python Table Manners - æ–‡ä»¶</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2020/12/python-table-manner-continuous-integration">Python Table Manners - æŒçºŒæ•´åˆ/éƒ¨ç½²</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2021/01/python-table-manners-cookiecutter">Python Table Manners - Cookiecutter å°ˆæ¡ˆæ¨¡æ¿</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2021/01/python-table-manner-editor">Python Table Manners ç•ªå¤– - ç·¨è¼¯å™¨</a>
</li>
</ol>
</div>
</section>
<script type="text/javascript">var use_utterance = true;</script>
<section class="post-comments">
<script async="" crossorigin="anonymous" data-issue-term="https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-test-2" data-label="blog-comment" data-repo="Lee-W/main-blog" data-theme="github-light" src="https://utteranc.es/client.js">
</script>
</section>
<aside class="post-nav">
<div class="clear"></div>
</aside>
</div>
</article>
</main>
<div class="nav-footer">
<nav aria-label="Footer" class="nav-wrapper">
<span class="nav-copy">Those aren't written down are meant to be forgotten Â© 2023
          <a class="nav-rss" href="https://blog.wei-lee.me/feeds/all.atom.xml" target="_blank" title="RSS"><i class="icon icon-rss"></i></a>
</span>
<span class="nav-credits">



          Published with <a href="https://github.com/getpelican/pelican" rel="nofollow">Pelican</a> â€¢ Theme <a href="https://github.com/arulrajnet/attila" rel="nofollow">Attila</a> â€¢
          <a class="menu-item js-theme" data-dark="Dark theme" data-light="Light theme" data-system="System theme" href="#">
<span class="theme-icon"></span><span class="theme-text">System theme</span>
</a>
</span>
</nav>
</div>
</section>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.slim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"></script>
<!-- TODO: minify -->
<script src="https://blog.wei-lee.me/theme/js/jquery.fitvids.js" type="text/javascript"></script>
<script src="https://blog.wei-lee.me/theme/js/script.js" type="text/javascript"></script>
<script src="https://blog.wei-lee.me/theme/js/clipboard.min.js" type="text/javascript"></script>
<script src="https://blog.wei-lee.me/theme/js/copy-to-clipboard.js" type="text/javascript"></script>
<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-3J7XQ46QH5"></script>
<script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-3J7XQ46QH5', { 'anonymize_ip': true });
    </script>
<script src="/pagefind/pagefind-ui.js"></script>
<script>
      window.addEventListener('DOMContentLoaded', (event) => {
          new PagefindUI({
              element: "#search",
              showImages: false,
          });
      });
  </script>
<!-- 	The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in article.html, but it needs to be included down here, after jQuery has already loaded. -->
<!-- Add MathJax and FontAwesome for Asciidoc -->\
<script>
  $(document).ready(function () {
    var viewport = $(window);
    var post = $('.post-content');
    // Responsive videos with fitVids
    post.fitVids();

    var mdSelector=".highlight pre code";
    var rstSelector=".highlight pre code";
    // For ":source-highlighter: highlight.js`" in asciidoc
    var adocSelector="pre.highlight > code[data-lang]"
    var selector=mdSelector;
    // Format code blocks and add line numbers
    function codestyling() {
      $(selector).each(function(i, e) {
        // Code highlight
        hljs.highlightElement(e);
        // No lines for plain text blocks
        if (!$(this).hasClass('language-text')) {
          var code = $(this);
          // Calculate amount of lines
          var lines = code.html().split(/\n(?!$)/g).length;
          var numbers = [];
          if (lines > 1) {
            lines++;
          }
          for (i = 1; i < lines; i++) {
            numbers += '<span class="line" aria-hidden="true">' + i + '</span>';
          }
          code.parent().append('<div class="lines">' + numbers + '</div>');
        }
      });
    }

    // Format code blocks only
    function codestylingWithoutLineNumbers() {
      $(selector).each(function(i, e) {
        // Code highlight
        hljs.highlightElement(e);
      });
    }

    codestylingWithoutLineNumbers();
    // Reading progress bar on window top
    function readingProgress() {
      var postBottom = post.offset().top + post.height();
      var viewportHeight = viewport.height();
      var progress = 100 - (((postBottom - (viewport.scrollTop() + viewportHeight) + viewportHeight / 3) / (postBottom - viewportHeight + viewportHeight / 3)) * 100);
      $('.progress-bar').css('width', progress + '%');
      (progress > 100) ? $('.progress-container').addClass('complete'): $('.progress-container').removeClass('complete');
    }
    readingProgress();
    // Trigger reading progress
    viewport.on({
      'scroll': function() {
        readingProgress();
      },
      'resize': function() {
        readingProgress();
      },
      'orientationchange': function() {
        readingProgress();
      }
    });

  });
</script>
</body>
</html>
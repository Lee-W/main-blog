
<!DOCTYPE html>

<html lang="zh-tw">
<head>
<meta charset="utf-8"/>
<meta charset="utf-8" content="text/html" http-equiv="Content-Type">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"/>
<title>Python Table Manners - ç®¡ç†ç¹ç‘£ä»»å‹™ </title>
<meta content="True" name="HandheldFriendly"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="origin" name="referrer"/>
<meta content="Pelican" name="generator"/>
<link href="https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-manage-trivial-tasks" rel="canonical"/>
<!-- Feed -->
<link href="https://blog.wei-lee.me/feeds/all.atom.xml" rel="alternate" title="Those aren't written down are meant to be forgotten Full Atom Feed" type="application/atom+xml"/>
<!-- TODO: combine -->
<link href="https://blog.wei-lee.me/theme/css/style.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/pygments.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/pagefind-ui-custom.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/code.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/code-copy.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/custom.css" rel="stylesheet" type="text/css"/>
<link href="/pagefind/pagefind-ui.css" rel="stylesheet"/>
<!-- Custom fonts -->
<link href="https://fonts.googleapis.com/css?family=Montserrat:400,300" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css"/>
<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
<script>
    var siteUrl = 'https://blog.wei-lee.me';
  </script>
<script>
    var localTheme = localStorage.getItem('attila_theme');
    switch (localTheme) {
      case 'dark':
        document.documentElement.classList.add('theme-dark');
        break;
      case 'light':
        document.documentElement.classList.add('theme-light');
        break;
      default:
        break;
    }
  </script>
<meta content="å‰é¢å¹¾ç¯‡å¾å¥—ä»¶ç®¡ç†ã€è™›æ“¬ç’°å¢ƒã€æ¸¬è©¦ã€é¢¨æ ¼æª¢æŸ¥åˆ°è‡ªå‹•æ’ç‰ˆï¼Œæåˆ°äº†å¾ˆå¤šçš„å·¥å…· æ¯ä¸€å€‹å·¥å…·åˆæœ‰å„è‡ªçš„åƒæ•¸å’Œè¨­å®š é€™éº¼å¤šæŒ‡ä»¤æ€éº¼å¯èƒ½è¨˜å¾—èµ·ä¾† ğŸ˜±" name="description"/>
<meta content="Wei Lee" name="author"/>
<meta content="Python" name="tags"/>
<meta content="Task" name="tags"/>
<!-- Open Graph -->
<meta content="Those aren't written down are meant to be forgotten" prefix="og: http://ogp.me/ns#" property="og:site_name">
<meta content="Python Table Manners - ç®¡ç†ç¹ç‘£ä»»å‹™ " prefix="og: http://ogp.me/ns#" property="og:title">
<meta content="å‰é¢å¹¾ç¯‡å¾å¥—ä»¶ç®¡ç†ã€è™›æ“¬ç’°å¢ƒã€æ¸¬è©¦ã€é¢¨æ ¼æª¢æŸ¥åˆ°è‡ªå‹•æ’ç‰ˆï¼Œæåˆ°äº†å¾ˆå¤šçš„å·¥å…· æ¯ä¸€å€‹å·¥å…·åˆæœ‰å„è‡ªçš„åƒæ•¸å’Œè¨­å®š é€™éº¼å¤šæŒ‡ä»¤æ€éº¼å¯èƒ½è¨˜å¾—èµ·ä¾† ğŸ˜±" prefix="og: http://ogp.me/ns#" property="og:description">
<meta content="zh-tw" prefix="og: http://ogp.me/ns#" property="og:locale">
<meta content="https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-manage-trivial-tasks" prefix="og: http://ogp.me/ns#" property="og:url"/>
<meta content="article" prefix="og: http://ogp.me/ns#" property="og:type"/>
<meta content="2020-02-27 20:04:00+08:00" prefix="og: http://ogp.me/ns#" property="article:published_time"/>
<meta content="2022-02-03 16:12:00+08:00" prefix="og: http://ogp.me/ns#" property="article:modified_time"/>
<meta content="https://blog.wei-lee.me/author/wei-lee.html" prefix="og: http://ogp.me/ns#" property="article:author"/>
<meta content="Tech" prefix="og: http://ogp.me/ns#" property="article:section">
<meta content="Python" prefix="og: http://ogp.me/ns#" property="article:tag"/>
<meta content="Task" prefix="og: http://ogp.me/ns#" property="article:tag"/>
<meta content="https://blog.wei-lee.me//images/cover.jpeg" prefix="og: http://ogp.me/ns#" property="og:image"/>
<!-- Twitter Card -->
<meta content="summary_large_image" name="twitter:card"/>
<meta content="@clleew" name="twitter:site"/>
<meta content="Python Table Manners - ç®¡ç†ç¹ç‘£ä»»å‹™ " name="twitter:title"/>
<meta content="https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-manage-trivial-tasks" name="twitter:url"/>
<meta content="https://blog.wei-lee.me//images/cover.jpeg" name="twitter:image:src"/>
<meta content="å‰é¢å¹¾ç¯‡å¾å¥—ä»¶ç®¡ç†ã€è™›æ“¬ç’°å¢ƒã€æ¸¬è©¦ã€é¢¨æ ¼æª¢æŸ¥åˆ°è‡ªå‹•æ’ç‰ˆï¼Œæåˆ°äº†å¾ˆå¤šçš„å·¥å…· æ¯ä¸€å€‹å·¥å…·åˆæœ‰å„è‡ªçš„åƒæ•¸å’Œè¨­å®š é€™éº¼å¤šæŒ‡ä»¤æ€éº¼å¯èƒ½è¨˜å¾—èµ·ä¾† ğŸ˜±" name="twitter:description"/>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "name": "Python Table Manners - ç®¡ç†ç¹ç‘£ä»»å‹™",
  "headline": "Python Table Manners - ç®¡ç†ç¹ç‘£ä»»å‹™",
  "datePublished": "2020-02-27 20:04:00+08:00",
  "dateModified": "2022-02-03 16:12:00+08:00",
  "author": {
    "@type": "Person",
    "name": "Wei Lee",
    "url": "https://blog.wei-lee.me/author/wei-lee.html"
  },
  "image": "https://blog.wei-lee.me//images/cover.jpeg",
  "url": "https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-manage-trivial-tasks",
  "description": "å‰é¢å¹¾ç¯‡å¾å¥—ä»¶ç®¡ç†ã€è™›æ“¬ç’°å¢ƒã€æ¸¬è©¦ã€é¢¨æ ¼æª¢æŸ¥åˆ°è‡ªå‹•æ’ç‰ˆï¼Œæåˆ°äº†å¾ˆå¤šçš„å·¥å…· æ¯ä¸€å€‹å·¥å…·åˆæœ‰å„è‡ªçš„åƒæ•¸å’Œè¨­å®š é€™éº¼å¤šæŒ‡ä»¤æ€éº¼å¯èƒ½è¨˜å¾—èµ·ä¾† ğŸ˜±"
}
</script>
</meta></meta></meta></meta></meta></link></meta><link href="https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-manage-trivial-tasks" rel="canonical"/><script type="application/ld+json">{"@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [{"@type": "ListItem", "position": 1, "name": "Those aren't written down are meant to be forgotten", "item": "https://blog.wei-lee.me"}, {"@type": "ListItem", "position": 2, "name": "Posts", "item": "https://blog.wei-lee.me/posts"}, {"@type": "ListItem", "position": 3, "name": "Tech", "item": "https://blog.wei-lee.me/posts/tech"}, {"@type": "ListItem", "position": 4, "name": "2020", "item": "https://blog.wei-lee.me/posts/tech/2020"}, {"@type": "ListItem", "position": 5, "name": "02", "item": "https://blog.wei-lee.me/posts/tech/2020/02"}, {"@type": "ListItem", "position": 6, "name": "Python table manners manage trivial tasks", "item": "https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-manage-trivial-tasks"}, {"@type": "ListItem", "position": 7, "name": "Index", "item": "https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-manage-trivial-tasks/index.html"}]}</script><script type="application/ld+json">{"@context": "https://schema.org", "@type": "Article", "author": {"@type": "Person", "name": "Wei Lee"}, "publisher": {"@type": "Organization", "name": "Those aren't written down are meant to be forgotten"}, "headline": "Python Table Manners - ç®¡ç†ç¹ç‘£ä»»å‹™", "about": "Tech", "datePublished": "2020-02-27 20:04"}</script></head>
<body class="category-template">
<div class="nav-header">
<nav aria-label="Main" class="nav-wrapper">
<ul>
<li class="nav-ğŸ  Home" role="presentation"><a href="/"><span>ğŸ  Home</span></a></li>
<li class="nav-About Me" role="presentation"><a href="/pages/about-me.html"><span>About Me</span></a></li>
<li class="nav-ğŸ‘¨â€ğŸ’» Tech active" role="presentation"><a href="/category/tech.html"><span>ğŸ‘¨â€ğŸ’» Tech</span></a></li>
<li class="nav-ğŸ“š Book Digest" role="presentation"><a href="/category/book.html"><span>ğŸ“š Book Digest</span></a></li>
<li class="nav-ğŸ’¬ Gossiping" role="presentation"><a href="/category/gossiping.html"><span>ğŸ’¬ Gossiping</span></a></li>
<li class="nav-ğŸ·ï¸ Tags" role="presentation"><a href="/tags.html"><span>ğŸ·ï¸ Tags</span></a></li>
<li class="nav-ğŸ—„ï¸ Archives" role="presentation"><a href="/archives.html"><span>ğŸ—„ï¸ Archives</span></a></li>
<li class="nav-ğŸ“š Series" role="presentation"><a href="/series_list.html"><span>ğŸ“š Series</span></a></li>
<li class="nav-ğŸ” Search" role="presentation"><a href="/search.html"><span>ğŸ” Search</span></a></li>
</ul>
<ul class="nav-meta">
<li class="nav-linkedin"><a aria-label="Linkedin" href="https://tw.linkedin.com/in/clleew" target="_blank"><i aria-hidden="true" class="icon icon-linkedin"></i>
<span>Linkedin</span>
</a></li>
<li class="nav-github"><a aria-label="Github" href="https://github.com/Lee-W" target="_blank"><i aria-hidden="true" class="icon icon-github"></i>
<span>GitHub</span>
</a></li>
<li class="nav-twitter"><a aria-label="Twitter" href="https://twitter.com/clleew" target="_blank"><i aria-hidden="true" class="icon icon-twitter"></i>
<span>Twitter</span>
</a></li>
<li class="nav-search" style="display: none;">
<a title="Search">
<i aria-hidden="true" class="icon icon-search"></i>
<span>Search</span>
</a>
</li>
</ul> </nav>
<div class="nav-wrapper-control">
<div class="inner">
<a class="nav-menu" role="button"><i aria-hidden="true" class="icon icon-menu"></i>Menu</a>
<a class="nav-search" role="button" style="display: none;" title="Search"><i aria-hidden="true" class="icon icon-search"></i></a>
</div>
</div>
</div>
<div aria-label="Close" class="nav-close" role="button"></div>
<section class="page-wrapper" id="wrapper">
<!-- Progressbar -->
<div class="progress-container">
<span class="progress-bar"></span>
</div>
<!-- Page Header -->
<!-- Set your background image for this header on the line below. -->
<header class="post-header has-cover">
<div class="inner">
<span class="post-info">
<span class="post-type">Article</span>
<span class="post-count">Tech</span>
</span>
<h1 class="post-title">
            Python Table Manners - ç®¡ç†ç¹ç‘£ä»»å‹™
        </h1>
<div class="post-meta">
<div class="post-meta-avatars">
<figure class="post-meta-avatar avatar">
<a class="author-avatar" href="https://blog.wei-lee.me/author/wei-lee.html">
<img alt="Wei Lee" class="author-profile-image" src="https://blog.wei-lee.me//images/avatar.jpeg"/>
</a>
</figure>
</div>
<h4 class="post-meta-author">
            Wei Lee
          </h4>
<time datetime="2020/02/27 - Thu">2020/02/27 - Thu</time>
          â€¢ <time datetime="2022/02/03 - Thu"> Updated on 2022/02/03 - Thu</time>
          â€¢ 3 min read
        </div>
<div class="post-cover cover">
<img alt="Category Tech" src="https://blog.wei-lee.me//images/cover.jpeg"/>
</div>
</div>
</header>
<!-- Post content -->
<main class="content" data-pagefind-body="" role="main">
<article class="post">
<div class="inner">
<section class="post-content">
<p>å‰é¢å¹¾ç¯‡å¾å¥—ä»¶ç®¡ç†ã€è™›æ“¬ç’°å¢ƒã€æ¸¬è©¦ã€é¢¨æ ¼æª¢æŸ¥åˆ°è‡ªå‹•æ’ç‰ˆï¼Œæåˆ°äº†å¾ˆå¤šçš„å·¥å…·<br/>
æ¯ä¸€å€‹å·¥å…·åˆæœ‰å„è‡ªçš„åƒæ•¸å’Œè¨­å®š<br/>
é€™éº¼å¤šæŒ‡ä»¤æ€éº¼å¯èƒ½è¨˜å¾—èµ·ä¾† ğŸ˜±</p>
<p><img alt="too-many-commands" src="/images/posts-image/2020-02-22-python-table-manner-series/too-many-commands.jpg"/></p>
<!--more-->
<p>æ‰€ä»¥åœ¨é€™ç¯‡è¦ä»‹ç´¹å¦‚ä½•ç”¨ <a href="http://www.pyinvoke.org/">invoke</a> ç®¡ç†é€™äº›æŒ‡ä»¤</p>
<div class="toc">
<ul>
<li><a href="#invoke">invoke æ˜¯ä»€éº¼</a></li>
<li><a href="#invoke_1">å®‰è£ invoke</a></li>
<li><a href="#invoke_2">å¦‚ä½•ä½¿ç”¨ invoke</a></li>
<li><a href="#invoke_3">å¯¦ä½œ invoke ä»»å‹™</a></li>
<li><a href="#_1">ä»»å‹™ç›¸ä¾</a></li>
<li><a href="#_2">ä»»å‹™æ¨¡çµ„åŒ–</a></li>
<li><a href="#auto-completion">è‡ªå‹•è£œå®Œ ï¼ˆAuto-completionï¼‰</a></li>
<li><a href="#makefile">ç‚ºä»€éº¼ä¸ç”¨ Makefile å°±å¥½ï¼Ÿ</a></li>
<li><a href="#_3">å…¶ä»–é€²éšæ‡‰ç”¨</a></li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>
<h2 id="invoke">invoke æ˜¯ä»€éº¼</h2>
<p>invoke æ˜¯ä¸€å¥—ä»»å‹™åŸ·è¡Œå·¥å…· (task execution tool)ï¼Œä¸»è¦ç”¨ä¾†æ˜¯çµ±ä¸€ç®¡ç†å„ç¨®æŒ‡ä»¤<br/>
æœ‰é»åƒæ˜¯ Python çš„ <code>Makefile</code></p>
<h2 id="invoke_1">å®‰è£ invoke</h2>
<p>ä¸åŒæ–¼ pytest, flake8 ç­‰å¥—ä»¶ï¼Œæˆ‘æœƒåŒæ™‚å°‡ invoke å®‰è£åœ¨ç³»çµ±å’Œè™›æ“¬ç’°å¢ƒä¸­</p>
<div class="highlight"><pre><span></span><code><span class="c1"># å®‰è£ invoke åˆ°ç³»çµ±</span>
pipx<span class="w"> </span>install<span class="w"> </span>invoke

<span class="c1"># å®‰è£ invoke åˆ°è™›æ“¬ç’°å¢ƒä¸­</span>
pipenv<span class="w"> </span>install<span class="w"> </span>invoke<span class="w"> </span>--dev
</code></pre></div>
<p>è£åœ¨ç³»çµ±çš„åŸå› æ˜¯æƒ³æŠŠå®ƒç•¶æˆé¡ä¼¼ <code>make</code> çš„æŒ‡ä»¤ä¾†ä½¿ç”¨</p>
<p>åœ¨è™›æ“¬ç’°å¢ƒé‚„éœ€è¦è£çš„åŸå› æ˜¯ï¼Œéƒ¨ç½²æ™‚ç³»çµ±é€šå¸¸ä¸æœƒé è£ invoke<br/>
å¦‚æœæƒ³åœ¨éƒ¨ç½²æ™‚ä¹Ÿèƒ½ä½¿ç”¨ invoke çš„åŠŸèƒ½ï¼Œæœ€æ–¹ä¾¿çš„æ–¹æ³•é€é pipenv å®‰è£</p>
<h2 id="invoke_2">å¦‚ä½•ä½¿ç”¨ invoke</h2>
<p>å†å›åˆ° <a href="https://github.com/pycontw/pycontw-postevent-report-generator">pycontw-postevent-report-generator</a> çš„ä¾‹å­<br/>
checkout åˆ° <a href="https://github.com/pycontw/pycontw-postevent-report-generator/tree/83e48c6443303045ed1de2f020297c3110bb1300">commit 83e4</a>ï¼Œå›åˆ°ä½¿ç”¨ invoke ç®¡ç†æŒ‡ä»¤å‰<br/>
å¾ç•¶æ™‚çš„æ–‡ä»¶å¯ä»¥çœ‹åˆ°ï¼Œé‚„éœ€è¦ä½¿ç”¨ç›¸å°å†—é•·çš„æŒ‡ä»¤</p>
<p><img alt="before-invoke" src="/images/posts-image/2020-02-22-python-table-manner-series/before-invoke.jpg"/></p>
<p>åˆ°äº† <a href="https://github.com/pycontw/pycontw-postevent-report-generator/tree/72ad956fd200867dc292a156c97a99a09ebe0104">commit 72ad</a> (å¯¦ä½œå·²ç¶“åœ¨ <a href="https://github.com/pycontw/pycontw-postevent-report-generator/commit/bc98eec28037a9bed5063fef0f0f564893fce3ac">commit bc98</a> å®Œæˆï¼Œåªæ˜¯åœ¨ commit 72ad æ‰æ›´æ–°æ–‡ä»¶)ï¼Œå·²ç¶“å¯ä»¥ä½¿ç”¨è¼ƒçŸ­ä¸”è¼ƒç‚ºçµ±ä¸€çš„æŒ‡ä»¤ (ä»¥ <code>inv</code> ä½œç‚ºé–‹é ­)</p>
<p><img alt="after-invoke" src="/images/posts-image/2020-02-22-python-table-manner-series/after-invoke.jpg"/></p>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œå¼•å…¥ invoke å¾Œï¼Œä¹Ÿä¸ç”¨æ¯æ¬¡éƒ½å»ç¿»æ–‡ä»¶<br/>
<code>invoke --list</code> å¯ä»¥åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„æŒ‡ä»¤</p>
<div class="highlight"><pre><span></span><code><span class="c1"># åˆ—å‡ºå¯ç”¨çš„ invoke æŒ‡ä»¤</span>
<span class="c1"># p.s. invoke æŒ‡ä»¤å¯ä»¥ç¸®å¯«ç‚º inv</span>
$<span class="w"> </span>inv<span class="w"> </span>--list

Available<span class="w"> </span>tasks:

<span class="w">  </span>clean<span class="w">      </span>Remove<span class="w"> </span>all<span class="w"> </span>the<span class="w"> </span>tmp<span class="w"> </span>files<span class="w"> </span><span class="k">in</span><span class="w"> </span>.gitignore
<span class="w">  </span>develop<span class="w">    </span>Install<span class="w"> </span>script<span class="w"> </span><span class="k">in</span><span class="w"> </span>pipenv<span class="w"> </span>environment<span class="w"> </span><span class="k">in</span><span class="w"> </span>development<span class="w"> </span>mode
<span class="w">  </span>init-dev<span class="w">   </span>Install<span class="w"> </span>development<span class="w"> </span>dependencies
<span class="w">  </span>install<span class="w">    </span>Install<span class="w"> </span>script<span class="w"> </span><span class="k">in</span><span class="w"> </span>pipenv<span class="w"> </span>environment
<span class="w">  </span><span class="nb">test</span><span class="w">       </span>Run<span class="w"> </span>testcase
</code></pre></div>
<p>åŸ·è¡Œçš„æ–¹å¼å‰‡æ˜¯åœ¨ invoke å¾Œé¢ç›´æ¥åŠ ä¸Šä»»å‹™åç¨±</p>
<p>e.g.,</p>
<div class="highlight"><pre><span></span><code>inv<span class="w"> </span>clean
</code></pre></div>
<h2 id="invoke_3">å¯¦ä½œ invoke ä»»å‹™</h2>
<p>æˆ‘å€‘å…ˆè©¦è‘—å°‡å‰é¢çš„ <code>python setup.py develop</code> æ”¹æˆ invoke çš„ä»»å‹™</p>
<p>é è¨­ invoke æœƒå»æ‰¾ç›®éŒ„ä¸‹çš„ <code>tasks.py</code><br/>
æ‰€ä»¥ç¬¬ä¸€æ­¥è¦å…ˆåœ¨å°ˆæ¡ˆæœ€ä¸Šå±¤å»ºç«‹ <code>tasks.py</code><br/>
æ¥è‘—æ’°å¯«ä¸€å€‹å‡½å¼å« <code>develop</code> ï¼Œé€™å°±æœƒæ˜¯ä¹‹å¾Œçš„ä»»å‹™åç¨± (i.e., é€é <code>inv develop</code> åŸ·è¡Œ)<br/>
åœ¨å‡½å¼å‰åŠ ä¸Šè£é£¾å™¨ (decorator) <code>@task</code><br/>
invoke æœƒå‚³å…¥ä¸€å€‹ context åšç‚ºç¬¬ä¸€å€‹åƒæ•¸ (Read More ğŸ‘‰ <a href="http://docs.pyinvoke.org/en/stable/getting-started.html#aside-what-exactly-is-this-context-arg-anyway">what exactly is this â€˜contextâ€™ arg anyway?</a>)<br/>
(p.s. åŸæœ¬çš„ç¨‹å¼ç¢¼ä¸­æ˜¯ä½¿ç”¨ <code>cmd</code> ï¼Œé‚£æ˜¯éŒ¯èª¤çš„ç”¨æ³•)<br/>
æœ€å¾Œå°±å¯ä»¥ç”¨é€™å€‹ context ï¼ˆåƒæ•¸ <code>ctx</code>ï¼‰ åŸ·è¡ŒæŒ‡ä»¤</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">invoke</span> <span class="kn">import</span> <span class="n">task</span>


<span class="nd">@task</span>
<span class="k">def</span> <span class="nf">develop</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">"python setup.py develop"</span><span class="p">)</span>
</code></pre></div>
<p>å¦‚åŒå…ˆå‰æ‰€æåˆ°çš„ï¼Œæ“ä½œéƒ½æ‡‰è©²åœ¨è™›æ“¬ç’°å¢ƒå…§è¢«å®Œæˆ<br/>
æ‰€ä»¥æˆ‘å°‡ <code>pipenv run</code> çš„å‰ç¶´æå‡ºä¾†<br/>
é€™æ¨£å°±èƒ½ç¢ºä¿ä¹‹å¾Œçš„æ“ä½œä¸€å®šéƒ½æœƒåœ¨è™›æ“¬ç’°å¢ƒå…§åŸ·è¡Œ<br/>
å¦‚æœä¹‹å¾Œæ›´æ›äº†ç®¡ç†è™›æ“¬ç’°å¢ƒçš„å·¥å…·ï¼ˆe.g. <code>poetry run</code>ï¼‰ï¼Œä¹Ÿå¯ä»¥æ›´è¼•æ˜“çš„æ”¹å‹• <code>tasks.py</code></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">invoke</span> <span class="kn">import</span> <span class="n">task</span>

<span class="n">PIPENV_PREFIX</span> <span class="o">=</span> <span class="s2">"pipenv run"</span>


<span class="nd">@task</span>
<span class="k">def</span> <span class="nf">develop</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">PIPENV_PREFIX</span><span class="si">}</span><span class="s2"> python setup.py develop"</span><span class="p">)</span>
</code></pre></div>
<h2 id="_1">ä»»å‹™ç›¸ä¾</h2>
<p>å¦‚æœä»»å‹™ä¹‹é–“æœ‰ç›¸ä¾æ€§ï¼Œå¯ä»¥åœ¨ <code>@task</code> å¾ŒåŠ å…¥ <code>pre</code> æˆ– <code>post</code><br/>
è¡¨ç¤ºä»»å‹™åŸ·è¡Œå‰æˆ–å¾Œé‚„è¦åŸ·è¡Œå…¶ä»–ä»»å‹™</p>
<p>e.g., åœ¨åˆå§‹ç’°å¢ƒ (<code>init</code>) å‰ï¼Œå¸¸æœƒå…ˆæ¸…é™¤ä¸å¿…è¦çš„æª”æ¡ˆ (<code>clean</code>)</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">invoke</span> <span class="kn">import</span> <span class="n">task</span>


<span class="nd">@task</span>
<span class="k">def</span> <span class="nf">clean</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"clean up"</span><span class="p">)</span>


<span class="nd">@task</span><span class="p">(</span><span class="n">pre</span><span class="o">=</span><span class="p">[</span><span class="n">clean</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">init</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"initial"</span><span class="p">)</span>
</code></pre></div>
<h2 id="_2">ä»»å‹™æ¨¡çµ„åŒ–</h2>
<p>ç•¶ä»»å‹™ä¾¿å¤šæ™‚ï¼Œç‚ºäº†æ–¹ä¾¿ç¶­è­·ï¼Œå°±æœƒå‚¾å‘å°‡ç›¸ä¼¼çš„ä»»å‹™æ¨¡çµ„åŒ–<br/>
é€™æ™‚å€™å°±å¯ä»¥ä½¿ç”¨åˆ° <code>namespace</code> çš„æ¦‚å¿µ<br/>
(Read More ğŸ‘‰ <a href="http://docs.pyinvoke.org/en/stable/concepts/namespaces.html">Constructing namespaces</a>)</p>
<p>ä¸éæˆ‘ä¸æœƒåœ¨é€™ç¯‡æ–‡ç« æ·±å…¥æ¢è¨è¦æ€éº¼èªª<br/>
ä¸€èˆ¬ä¾†èªªï¼Œé™¤éä»»å‹™çœŸçš„éå¸¸å¤šï¼Œé€™æ˜¯ä¸å¤ªå¿…è¦çš„</p>
<p>å¦‚æœæœ‰èˆˆè¶£çœ‹æˆ‘æ€éº¼æŠŠ <a href="https://github.com/pycontw/pycontw-postevent-report-generator">pycontw-postevent-report-generator</a> çš„ä»»å‹™æ¨¡çµ„åŒ–<br/>
å¯ä»¥åƒè€ƒ <a href="https://github.com/pycontw/pycontw-postevent-report-generator/commit/f1050eabf44a8b8e662370bd97b2a79ad57723c2">commit f105</a></p>
<p>æœ€å¾Œä¿®æ”¹å¾Œ <code>tasks</code> å¥—ä»¶ä¸­æœ‰é€™äº›æ¨¡çµ„</p>
<div class="highlight"><pre><span></span><code>â”œâ”€â”€ tasks
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ build.py
â”‚   â”œâ”€â”€ common.py
â”‚   â”œâ”€â”€ env.py
â”‚   â”œâ”€â”€ style.py
â”‚   â””â”€â”€ test.py
</code></pre></div>
<p>å’Œå„å€‹æ¨¡çµ„ä¸‹çš„æŒ‡ä»¤</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>inv<span class="w"> </span>--list

Available<span class="w"> </span>tasks:

<span class="w">  </span>secure<span class="w">              </span>Check<span class="w"> </span>package<span class="w"> </span>security
<span class="w">  </span>build.clean<span class="w">         </span>Remove<span class="w"> </span>all<span class="w"> </span>the<span class="w"> </span>tmp<span class="w"> </span>files<span class="w"> </span><span class="k">in</span><span class="w"> </span>.gitignore
<span class="w">  </span>build.develop<span class="w">       </span>Install<span class="w"> </span>script<span class="w"> </span><span class="k">in</span><span class="w"> </span>pipenv<span class="w"> </span>environment<span class="w"> </span><span class="k">in</span><span class="w"> </span>development<span class="w"> </span>mode
<span class="w">  </span>build.install<span class="w">       </span>Install<span class="w"> </span>script<span class="w"> </span><span class="k">in</span><span class="w"> </span>pipenv<span class="w"> </span>environment
<span class="w">  </span>build.test-cli<span class="w">      </span>Test<span class="w"> </span>whether<span class="w"> </span>the<span class="w"> </span>cli<span class="w"> </span>is<span class="w"> </span>runnable
<span class="w">  </span>env.clean<span class="w">           </span>Remove<span class="w"> </span>virtual<span class="w"> </span>environment
<span class="w">  </span>env.init<span class="w">            </span>Install<span class="w"> </span>production<span class="w"> </span>dependencies
<span class="w">  </span>env.init-dev<span class="w">        </span>Install<span class="w"> </span>development<span class="w"> </span>dependencies
<span class="w">  </span>style.flake8<span class="w">        </span>Check<span class="w"> </span>style<span class="w"> </span>through<span class="w"> </span>flake8
<span class="w">  </span>style.mypy<span class="w">          </span>Check<span class="w"> </span>style<span class="w"> </span>through<span class="w"> </span>mypy
<span class="w">  </span>style.pylint<span class="w">        </span>Check<span class="w"> </span>style<span class="w"> </span>through<span class="w"> </span>pylint
<span class="w">  </span>style.reformat<span class="w">      </span>Reformat<span class="w"> </span>python<span class="w"> </span>files<span class="w"> </span>through<span class="w"> </span>black
<span class="w">  </span>style.run<span class="w"> </span><span class="o">(</span>style<span class="o">)</span><span class="w">   </span>Check<span class="w"> </span>style<span class="w"> </span>through<span class="w"> </span>linter<span class="w"> </span><span class="o">(</span>Note<span class="w"> </span>that<span class="w"> </span>pylint<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>included<span class="o">)</span>
<span class="w">  </span>test.cov<span class="w">            </span>Run<span class="w"> </span><span class="nb">test</span><span class="w"> </span>coverage<span class="w"> </span>check
<span class="w">  </span>test.run<span class="w"> </span><span class="o">(</span><span class="nb">test</span><span class="o">)</span><span class="w">     </span>Run<span class="w"> </span><span class="nb">test</span><span class="w"> </span>cases
</code></pre></div>
<h2 id="auto-completion">è‡ªå‹•è£œå®Œ ï¼ˆAuto-completionï¼‰</h2>
<p>å·¥ç¨‹å¸«æ˜¯å¾ˆæ‡¶æƒ°çš„<br/>
é€™ç¨®æŒ‡ä»¤åˆ—å·¥å…·æ²’æœ‰è‡ªå‹•è£œå®Œæ€éº¼è¡Œ<br/>
invoke ç•¶ç„¶ä¹Ÿæƒ³åˆ°äº†<br/>
é€éåƒæ•¸ <code>--print-completion-script=[shell]</code> å°±èƒ½å–å¾— invoke é å…ˆå¯«å¥½çš„è‡ªå‹•è£œå®Œè…³æ­¥<br/>
ç›®å‰æ”¯æ´ bash, zsh, fish ä¸‰ç¨® shell</p>
<p>e.g., å°‡ invoke ç”¢ç”Ÿçš„ zsh è‡ªå‹•è£œå®Œè…³æœ¬å¯«å…¥ <code>~/.zsh</code></p>
<div class="highlight"><pre><span></span><code>inv<span class="w"> </span>--print-completion-script<span class="o">=</span>zsh<span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.zshrc
</code></pre></div>
<h2 id="makefile">ç‚ºä»€éº¼ä¸ç”¨ Makefile å°±å¥½ï¼Ÿ</h2>
<p>å› ç‚ºæœ‰äº› shell script ä¸¦ä¸è¦‹å¾—é‚£éº¼å¥½å¯«<br/>
ï¼ˆä¹Ÿå¯èƒ½åªæ˜¯æˆ‘ä¸ç†Ÿ...ï¼‰</p>
<p>e.g.,</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">invoke</span> <span class="kn">import</span> <span class="n">task</span>


<span class="n">PIPENV_PREFIX</span> <span class="o">=</span> <span class="s2">"pipenv run"</span>


<span class="nd">@task</span>
<span class="k">def</span> <span class="nf">clean</span><span class="p">(</span><span class="n">cmd</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Remove all the tmp files in .gitignore"""</span>
    <span class="n">files_to_remove</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">".gitignore"</span><span class="p">)</span> <span class="k">as</span> <span class="n">input_file</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">input_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">"#"</span><span class="p">):</span>
                <span class="n">files_to_remove</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>

    <span class="n">cmd</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="sa">f</span><span class="s2">"rm -rf </span><span class="si">{</span><span class="s1">' '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">files_to_remove</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div>
<p>ï¼ˆé›–ç„¶å¾Œä¾†ç™¼ç¾ä¸Šé¢çš„ä¸€ä¸²ï¼Œå¯ä»¥ç”¨ <code>git clean -Xdf</code> å–ä»£...ï¼‰</p>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œinvoke ä¹Ÿå¯ä»¥è®“ shell script çš„çµæœï¼Œç›´æ¥è·Ÿ Python äº’å‹•<br/>
æ›´å®¹æ˜“å¯¦ä½œå‡ºæƒ³è¦çš„åŠŸèƒ½</p>
<p>å¦å¤–ï¼Œæ¨è–¦é–±è®€ <a href="https://interrupt.memfault.com/blog/building-a-cli-for-firmware-projects">Building a CLI for Firmware Projects using Invoke</a></p>
<h2 id="_3">å…¶ä»–é€²éšæ‡‰ç”¨</h2>
<ul>
<li>å¦‚ä½•åœ¨ä»»å‹™åŠ ä¸Šåƒæ•¸ï¼Ÿ<ul>
<li>ä»»å‹™çš„å‡½å¼å¾Œé¢åŠ ä¸Šé™¤äº† context æ„å¤–çš„åƒæ•¸</li>
<li>ğŸ‘‰ <a href="http://docs.pyinvoke.org/en/stable/getting-started.html#task-parameters">Task parameters</a></li>
</ul>
</li>
<li>ç‚ºä»€éº¼ç”¨ invoke çš„çµæœè·ŸæŒ‡ä»¤åˆ—ä¸Šçš„åŸ·è¡Œçµæœä¸å®Œå…¨ç›¸åŒï¼Ÿ<ul>
<li>åœ¨ <code>run</code> å‡½å¼ä¸­åŠ ä¸Š <code>pty=True</code> åƒæ•¸é€šå¸¸èƒ½è§£æ±ºï¼Œä½†å»ºè­°å¯ä»¥çœ‹çœ‹ invoke ç‚ºä»€éº¼ä¸å°‡é€™è¨­å®šç‚ºé è¨­è¡Œç‚º</li>
<li>ğŸ‘‰ <a href="http://www.pyinvoke.org/faq.html#why-is-my-command-behaving-differently-under-invoke-versus-being-run-by-hand">Why is my command behaving differently under Invoke versus being run by hand?</a></li>
</ul>
</li>
<li>å¦‚ä½•åœ¨ä»»å‹™åŸ·è¡Œå¤±æ•—æ™‚ï¼Œåªåšè­¦å‘Šï¼Œä¸è¦è·³éŒ¯<ul>
<li>åœ¨ <code>run</code> å‡½å¼åŠ ä¸Š <code>warn=True</code> (é è¨­æ˜¯ <code>False</code>)</li>
<li>ğŸ‘‰ <a href="http://docs.pyinvoke.org/en/1.2/api/runners.html#invoke.runners.Runner.run">invoke.runners.Runner.run</a></li>
</ul>
</li>
</ul>
<h2 id="reference">Reference</h2>
<ul>
<li><a href="https://wei-lee.me/pycon-note/posts/pycon-us-2019/2019/08/break-the-cycle-three-excellent-python-tools-to-automate-repetitive-tasks/">Break the Cycle: Three excellent Python tools to automate repetitive tasks - PyCon US 2019</a></li>
</ul>
</section>
<section class="post-footer">
<div class="post-share">
<span class="post-info-label">Share</span>
<a aria-label="Twitter" class="twitter" href="https://twitter.com/share?text=Python Table Manners - ç®¡ç†ç¹ç‘£ä»»å‹™ &amp;url=https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-manage-trivial-tasks" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title="Twitter">
<i aria-hidden="true" class="icon icon-twitter"></i><span class="hidden">Twitter</span>
</a>
<a aria-label="Facebook" class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-manage-trivial-tasks" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title="Facebook">
<i aria-hidden="true" class="icon icon-facebook"></i><span class="hidden">Facebook</span>
</a>
<a aria-label="LinkedIn" class="linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-manage-trivial-tasks&amp;title=Python Table Manners - ç®¡ç†ç¹ç‘£ä»»å‹™" onclick="window.open(this.href, 'linkedin-share', 'width=930,height=720');return false;" title="LinkedIn">
<i aria-hidden="true" class="icon icon-linkedin"></i><span class="hidden">LinkedIn</span>
</a>
<a aria-label="Email" class="email" href="mailto:?subject=Python Table Manners - ç®¡ç†ç¹ç‘£ä»»å‹™&amp;body=https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-manage-trivial-tasks" title="Email">
<i aria-hidden="true" class="icon icon-mail"></i><span class="hidden">Email</span>
</a>
<div class="clear"></div>
</div>
<aside class="post-tags">
<a href="https://blog.wei-lee.me/tag/python.html">Python</a><a href="https://blog.wei-lee.me/tag/task.html">Task</a> </aside>
<div class="clear"></div>
<div class="series">
<p>This post is part 6 of the "Python Table Manners" series:</p>
<ol class="parts">
<li>
<a href="https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-series">Python Table Manners ç³»åˆ—</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-dependency-mangement">Python Table Manners - è™›æ“¬ç’°å¢ƒå’Œå¥—ä»¶ç®¡ç†</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-test-1">Python Table Manners - æ¸¬è©¦ (ä¸€)</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-test-2">Python Table Manners - æ¸¬è©¦ (äºŒ)</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-coding-style">Python Table Manners - ç¨‹å¼ç¢¼é¢¨æ ¼</a>
</li>
<li class="active">
<a href="https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-manage-trivial-tasks">Python Table Manners - ç®¡ç†ç¹ç‘£ä»»å‹™</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-pre-commit">Python Table Manners - pre-commit: git commit å‰åšå®Œæª¢æŸ¥</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2020/03/python-table-manners-commitizen">Python Table Manners - Commitizen: è¦æ ¼åŒ– commit message</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2020/03/python-table-manners-security">Python Table Manners - å®‰å…¨æ€§æª¢æŸ¥</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2020/04/python-table-manners-documentation">Python Table Manners - æ–‡ä»¶</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2020/12/python-table-manner-continuous-integration">Python Table Manners - æŒçºŒæ•´åˆ/éƒ¨ç½²</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2021/01/python-table-manners-cookiecutter">Python Table Manners - Cookiecutter å°ˆæ¡ˆæ¨¡æ¿</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2021/01/python-table-manner-editor">Python Table Manners ç•ªå¤– - ç·¨è¼¯å™¨</a>
</li>
</ol>
</div>
</section>
<script type="text/javascript">var use_utterance = true;</script>
<section class="post-comments">
<script async="" crossorigin="anonymous" data-issue-term="https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-manage-trivial-tasks" data-label="blog-comment" data-repo="Lee-W/main-blog" data-theme="github-light" src="https://utteranc.es/client.js">
</script>
</section>
<aside class="post-nav">
<div class="clear"></div>
</aside>
</div>
</article>
</main>
<div class="nav-footer">
<nav aria-label="Footer" class="nav-wrapper">
<span class="nav-copy">Those aren't written down are meant to be forgotten Â© 2023
          <a class="nav-rss" href="https://blog.wei-lee.me/feeds/all.atom.xml" target="_blank" title="RSS"><i class="icon icon-rss"></i></a>
</span>
<span class="nav-credits">



          Published with <a href="https://github.com/getpelican/pelican" rel="nofollow">Pelican</a> â€¢ Theme <a href="https://github.com/arulrajnet/attila" rel="nofollow">Attila</a> â€¢
          <a class="menu-item js-theme" data-dark="Dark theme" data-light="Light theme" data-system="System theme" href="#">
<span class="theme-icon"></span><span class="theme-text">System theme</span>
</a>
</span>
</nav>
</div>
</section>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
<!-- TODO: minify -->
<script src="https://blog.wei-lee.me/theme/js/jquery.fitvids.js" type="text/javascript"></script>
<script src="https://blog.wei-lee.me/theme/js/script.js" type="text/javascript"></script>
<script src="https://blog.wei-lee.me/theme/js/clipboard.min.js" type="text/javascript"></script>
<script src="https://blog.wei-lee.me/theme/js/copy-to-clipboard.js" type="text/javascript"></script>
<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-3J7XQ46QH5"></script>
<script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-3J7XQ46QH5', { 'anonymize_ip': true });
    </script>
<script src="/pagefind/pagefind-ui.js"></script>
<script>
      window.addEventListener('DOMContentLoaded', (event) => {
          new PagefindUI({
              element: "#search",
              showImages: false,
          });
      });
  </script>
<!-- 	The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in article.html, but it needs to be included down here, after jQuery has already loaded. -->
<script>
  $(document).ready(function () {
    var viewport = $(window);
    var post = $('.post-content');
    // Responsive videos with fitVids
    post.fitVids();

    // Reading progress bar on window top
    function readingProgress() {
      var postBottom = post.offset().top + post.height();
      var viewportHeight = viewport.height();
      var progress = 100 - (((postBottom - (viewport.scrollTop() + viewportHeight) + viewportHeight / 3) / (postBottom - viewportHeight + viewportHeight / 3)) * 100);
      $('.progress-bar').css('width', progress + '%');
      (progress > 100) ? $('.progress-container').addClass('complete'): $('.progress-container').removeClass('complete');
    }
    readingProgress();
    // Trigger reading progress
    viewport.on({
      'scroll': function() {
        readingProgress();
      },
      'resize': function() {
        readingProgress();
      },
      'orientationchange': function() {
        readingProgress();
      }
    });

  });
</script>
</body>
</html>
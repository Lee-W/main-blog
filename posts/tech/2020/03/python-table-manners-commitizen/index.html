
<!DOCTYPE html>

<html lang="zh-tw">
<head>
<meta charset="utf-8"/>
<meta charset="utf-8" content="text/html" http-equiv="Content-Type">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"/>
<title>Python Table Manners - Commitizen: 規格化 commit message </title>
<meta content="True" name="HandheldFriendly"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="origin" name="referrer"/>
<meta content="Pelican" name="generator"/>
<link href="https://blog.wei-lee.me/posts/tech/2020/03/python-table-manners-commitizen" rel="canonical"/>
<!-- Feed -->
<link href="https://blog.wei-lee.me/feeds/all.atom.xml" rel="alternate" title="Those aren't written down are meant to be forgotten Full Atom Feed" type="application/atom+xml"/>
<!-- TODO: combine -->
<link href="https://blog.wei-lee.me/theme/css/style.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/pygments.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/pagefind-ui-custom.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/code.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/code-copy.css" rel="stylesheet" type="text/css"/>
<link href="https://blog.wei-lee.me/theme/css/custom.css" rel="stylesheet" type="text/css"/>
<link href="/pagefind/pagefind-ui.css" rel="stylesheet"/>
<!-- Custom fonts -->
<link href="https://fonts.googleapis.com/css?family=Montserrat:400,300" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css"/>
<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
<script>
    var siteUrl = 'https://blog.wei-lee.me';
  </script>
<script>
    var localTheme = localStorage.getItem('attila_theme');
    switch (localTheme) {
      case 'dark':
        document.documentElement.classList.add('theme-dark');
        break;
      case 'light':
        document.documentElement.classList.add('theme-light');
        break;
      default:
        break;
    }
  </script>
<meta content="接續著前一篇的 pre-commit ，繼續談 git 相關的工具 這篇來聊聊如何透過 commitizen 規範 commit message 還有規範過的 commit message 能拿來做什麼" name="description"/>
<meta content="Wei Lee" name="author"/>
<meta content="Python" name="tags"/>
<meta content="Git" name="tags"/>
<!-- Open Graph -->
<meta content="Those aren't written down are meant to be forgotten" prefix="og: http://ogp.me/ns#" property="og:site_name">
<meta content="Python Table Manners - Commitizen: 規格化 commit message " prefix="og: http://ogp.me/ns#" property="og:title">
<meta content="接續著前一篇的 pre-commit ，繼續談 git 相關的工具 這篇來聊聊如何透過 commitizen 規範 commit message 還有規範過的 commit message 能拿來做什麼" prefix="og: http://ogp.me/ns#" property="og:description">
<meta content="zh-tw" prefix="og: http://ogp.me/ns#" property="og:locale">
<meta content="https://blog.wei-lee.me/posts/tech/2020/03/python-table-manners-commitizen" prefix="og: http://ogp.me/ns#" property="og:url"/>
<meta content="article" prefix="og: http://ogp.me/ns#" property="og:type"/>
<meta content="2020-03-01 00:45:00+08:00" prefix="og: http://ogp.me/ns#" property="article:published_time"/>
<meta content="2020-07-19 16:47:00+08:00" prefix="og: http://ogp.me/ns#" property="article:modified_time"/>
<meta content="https://blog.wei-lee.me/author/wei-lee.html" prefix="og: http://ogp.me/ns#" property="article:author"/>
<meta content="Tech" prefix="og: http://ogp.me/ns#" property="article:section">
<meta content="Python" prefix="og: http://ogp.me/ns#" property="article:tag"/>
<meta content="Git" prefix="og: http://ogp.me/ns#" property="article:tag"/>
<meta content="https://blog.wei-lee.me//images/cover.jpeg" prefix="og: http://ogp.me/ns#" property="og:image"/>
<!-- Twitter Card -->
<meta content="summary_large_image" name="twitter:card"/>
<meta content="@clleew" name="twitter:site"/>
<meta content="Python Table Manners - Commitizen: 規格化 commit message " name="twitter:title"/>
<meta content="https://blog.wei-lee.me/posts/tech/2020/03/python-table-manners-commitizen" name="twitter:url"/>
<meta content="https://blog.wei-lee.me//images/cover.jpeg" name="twitter:image:src"/>
<meta content="接續著前一篇的 pre-commit ，繼續談 git 相關的工具 這篇來聊聊如何透過 commitizen 規範 commit message 還有規範過的 commit message 能拿來做什麼" name="twitter:description"/>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "name": "Python Table Manners - Commitizen: 規格化 commit message",
  "headline": "Python Table Manners - Commitizen: 規格化 commit message",
  "datePublished": "2020-03-01 00:45:00+08:00",
  "dateModified": "2020-07-19 16:47:00+08:00",
  "author": {
    "@type": "Person",
    "name": "Wei Lee",
    "url": "https://blog.wei-lee.me/author/wei-lee.html"
  },
  "image": "https://blog.wei-lee.me//images/cover.jpeg",
  "url": "https://blog.wei-lee.me/posts/tech/2020/03/python-table-manners-commitizen",
  "description": "接續著前一篇的 pre-commit ，繼續談 git 相關的工具 這篇來聊聊如何透過 commitizen 規範 commit message 還有規範過的 commit message 能拿來做什麼"
}
</script>
</meta></meta></meta></meta></meta></link></meta><link href="https://blog.wei-lee.me/posts/tech/2020/03/python-table-manners-commitizen" rel="canonical"/><script type="application/ld+json">{"@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [{"@type": "ListItem", "position": 1, "name": "Those aren't written down are meant to be forgotten", "item": "https://blog.wei-lee.me"}, {"@type": "ListItem", "position": 2, "name": "Posts", "item": "https://blog.wei-lee.me/posts"}, {"@type": "ListItem", "position": 3, "name": "Tech", "item": "https://blog.wei-lee.me/posts/tech"}, {"@type": "ListItem", "position": 4, "name": "2020", "item": "https://blog.wei-lee.me/posts/tech/2020"}, {"@type": "ListItem", "position": 5, "name": "03", "item": "https://blog.wei-lee.me/posts/tech/2020/03"}, {"@type": "ListItem", "position": 6, "name": "Python table manners commitizen", "item": "https://blog.wei-lee.me/posts/tech/2020/03/python-table-manners-commitizen"}, {"@type": "ListItem", "position": 7, "name": "Index", "item": "https://blog.wei-lee.me/posts/tech/2020/03/python-table-manners-commitizen/index.html"}]}</script><script type="application/ld+json">{"@context": "https://schema.org", "@type": "Article", "author": {"@type": "Person", "name": "Wei Lee"}, "publisher": {"@type": "Organization", "name": "Those aren't written down are meant to be forgotten"}, "headline": "Python Table Manners - Commitizen: 規格化 commit message", "about": "Tech", "datePublished": "2020-03-01 00:45"}</script><meta content="summary" name="twitter:card"/><meta content="https://blog.wei-lee.me/posts/tech/2020/03/python-table-manners-commitizen" property="og:url"/><meta content="article" property="og:type"/><meta content="Python Table Manners - Commitizen: 規格化 commit message" property="og:title"/><meta content="C" property="og:locale"/></head>
<body class="category-template">
<div class="nav-header">
<nav aria-label="Main" class="nav-wrapper">
<ul>
<li class="nav-🏠 Home" role="presentation"><a href="/"><span>🏠 Home</span></a></li>
<li class="nav-About Me" role="presentation"><a href="/pages/about-me.html"><span>About Me</span></a></li>
<li class="nav-👨‍💻 Tech active" role="presentation"><a href="/category/tech.html"><span>👨‍💻 Tech</span></a></li>
<li class="nav-📚 Book Digest" role="presentation"><a href="/category/book.html"><span>📚 Book Digest</span></a></li>
<li class="nav-💬 Gossiping" role="presentation"><a href="/category/gossiping.html"><span>💬 Gossiping</span></a></li>
<li class="nav-🏷️ Tags" role="presentation"><a href="/tags.html"><span>🏷️ Tags</span></a></li>
<li class="nav-🗄️ Archives" role="presentation"><a href="/archives.html"><span>🗄️ Archives</span></a></li>
<li class="nav-📚 Series" role="presentation"><a href="/series_list.html"><span>📚 Series</span></a></li>
<li class="nav-🔍 Search" role="presentation"><a href="/search.html"><span>🔍 Search</span></a></li>
</ul>
<ul class="nav-meta">
<li class="nav-linkedin"><a aria-label="Linkedin" href="https://tw.linkedin.com/in/clleew" target="_blank"><i aria-hidden="true" class="icon icon-linkedin"></i>
<span>Linkedin</span>
</a></li>
<li class="nav-github"><a aria-label="Github" href="https://github.com/Lee-W" target="_blank"><i aria-hidden="true" class="icon icon-github"></i>
<span>GitHub</span>
</a></li>
<li class="nav-twitter"><a aria-label="Twitter" href="https://twitter.com/clleew" target="_blank"><i aria-hidden="true" class="icon icon-twitter"></i>
<span>Twitter</span>
</a></li>
<li class="nav-search" style="display: none;">
<a title="Search">
<i aria-hidden="true" class="icon icon-search"></i>
<span>Search</span>
</a>
</li>
</ul> </nav>
<div class="nav-wrapper-control">
<div class="inner">
<a class="nav-menu" role="button"><i aria-hidden="true" class="icon icon-menu"></i>Menu</a>
<a class="nav-search" role="button" style="display: none;" title="Search"><i aria-hidden="true" class="icon icon-search"></i></a>
</div>
</div>
</div>
<div aria-label="Close" class="nav-close" role="button"></div>
<section class="page-wrapper" id="wrapper">
<!-- Progressbar -->
<div class="progress-container">
<span class="progress-bar"></span>
</div>
<!-- Page Header -->
<!-- Set your background image for this header on the line below. -->
<header class="post-header has-cover">
<div class="inner">
<span class="post-info">
<span class="post-type">Article</span>
<span class="post-count">Tech</span>
</span>
<h1 class="post-title">
            Python Table Manners - Commitizen: 規格化 commit message
        </h1>
<div class="post-meta">
<div class="post-meta-avatars">
<figure class="post-meta-avatar avatar">
<a class="author-avatar" href="https://blog.wei-lee.me/author/wei-lee.html">
<img alt="Wei Lee" class="author-profile-image" src="https://blog.wei-lee.me//images/avatar.jpeg"/>
</a>
</figure>
</div>
<h4 class="post-meta-author">
            Wei Lee
          </h4>
<time datetime="2020/03/01 - Sun">2020/03/01 - Sun</time>
          • <time datetime="2020/07/19 - Sun"> Updated on 2020/07/19 - Sun</time>
          • 4 min read
        </div>
<div class="post-cover cover">
<img alt="Category Tech" src="https://blog.wei-lee.me//images/cover.jpeg"/>
</div>
</div>
</header>
<!-- Post content -->
<main class="content" data-pagefind-body="" role="main">
<article class="post">
<div class="inner">
<section class="post-content">
<p>接續著前一篇的 pre-commit ，繼續談 git 相關的工具<br/>
這篇來聊聊如何透過 <a href="https://github.com/commitizen-tools/commitizen">commitizen</a> 規範 commit message<br/>
還有規範過的 commit message 能拿來做什麼</p>
<!--more-->
<div class="toc">
<ul>
<li><a href="#commit-message">為什麼要好好寫 commit message</a></li>
<li><a href="#commitizen">Commitizen</a></li>
<li><a href="#commitizen_1">安裝與設定 Commitizen</a></li>
<li><a href="#commitizen_2">使用 Commitizen</a></li>
<li><a href="#commit-message_1">強制檢查 commit message</a></li>
<li><a href="#_1">自動提升版本號</a></li>
<li><a href="#commit">客製化 commit 規範</a><ul>
<li><a href="#_2">直接在設定檔設定</a></li>
<li><a href="#commit-python">將客製化的 commit 規範寫成 Python 套件發佈</a></li>
</ul>
</li>
<li><a href="#changelog">自動產生更新日誌（Changelog）</a></li>
<li><a href="#commitizen_3">其他 commitizen 指令和常用參數</a></li>
<li><a href="#commitizen_4">關於 commitizen 的雜談</a><ul>
<li><a href="#java-script-commitizen">為什麼不用 Java Script 的 commitizen 就好了</a></li>
<li><a href="#_3">持續貢獻</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>
<h2 id="commit-message">為什麼要好好寫 commit message</h2>
<p><img alt="no-good-commit" src="/images/posts-image/2020-02-22-python-table-manner-series/no-good-commit.jpg"/></p>
<p>如果不好好寫有意義的 commit message，每次都只用 "update" 當訊息<br/>
當你下了 <code>git log</code> 指令，就會看到一堆 "update"<br/>
然後哪天系統出錯的時候，你也會不知道要回朔到哪一個版本</p>
<p><img alt="bad-commit" src="/images/posts-image/2020-02-22-python-table-manner-series/bad-commit.jpg"/><br/>
(from <a href="https://github.com/hackjutsu/bad-commit-example/commits/master">hackjutsu/bad-commit-example</a>)</p>
<p>撰寫好的 commit message，除了讓未來的自己知道自己在幹嘛<br/>
也能讓團隊之間的溝通更順利</p>
<ul>
<li>送 Pull Request / Merge Request 時，審核者能更快速地知道增加了哪些功能</li>
<li>新進人員可以從過往的 commit message 找到整個專案發展的脈絡，更容易上手專案</li>
</ul>
<h2 id="commitizen">Commitizen</h2>
<p>除了提供的 commit message 撰寫建議和規範 （👉 <a href="https://commitizen-tools.github.io/commitizen/tutorials/writing_commits/">Writing commits</a>）<br/>
<a href="https://commitizen-tools.github.io/commitizen/">commitizen</a> 更進一步提供互動式介面，讓使用者可以夠輕鬆地產生符合規範的 commit message<br/>
同時也整合了前一篇所提到的 pre-commit hook，避免使用者將不符合規範的 commit message 寫入<br/>
除了採用來自 Angular 社群的 <a href="https://www.conventionalcommits.org/en/v1.0.0/">Conventional Commits</a> (約定式提交) 外， commitizen 提供了高度的客製化，讓每個團隊或專案都可以依照自己的需求，撰寫相對應的規範<br/>
規範了 commit message 後，除了增加可讀性增加外，也讓訊息有可以被解析做其他運用<br/>
e.g., 提升版本號, 產生更新日誌</p>
<h2 id="commitizen_1">安裝與設定 Commitizen</h2>
<p>跟 invoke 一樣，我會把 commitizen 同時安裝在系統和虛擬環境<br/>
安裝在虛擬環境主要是為了能在 CI/CD 伺服器上自動升版</p>
<div class="highlight"><pre><span></span><code><span class="c1"># 安裝 commitizen 到系統</span>
pipx<span class="w"> </span>install<span class="w"> </span>commitizen

<span class="c1"># 安裝 commitizen 到虛擬環境中</span>
pipenv<span class="w"> </span>install<span class="w"> </span>commitizen<span class="w"> </span>--dev
</code></pre></div>
<p>在專案中第一次使用 commitizen 可以使用初始化指令來完成基本的設定</p>
<div class="highlight"><pre><span></span><code>cz<span class="w"> </span>init
</code></pre></div>
<p>一開始會先問想使用哪種設定檔</p>
<p><img alt="cz-init-1" src="/images/posts-image/2020-02-22-python-table-manner-series/cz-init-1.png"/></p>
<p>接著要選擇一套 commit 規範，預設有三種<br/>
如果有安裝其他的 commit 規範，它們也會出現在選項中（See more 👉 <a href="https://commitizen-tools.github.io/commitizen/third-party-commitizen/">Third-Party Commitizen Templates</a>）</p>
<p><img alt="cz-init-2" src="/images/posts-image/2020-02-22-python-table-manner-series/cz-init-2.png"/></p>
<p>再來會問最新的 git tag 是否為最新的版本號<br/>
如果不是，就會列出 <code>git tag</code> 所有的結果<br/>
如果完全沒有用過 git tag，預設會是 <code>0.0.1</code></p>
<p><img alt="cz-init-3" src="/images/posts-image/2020-02-22-python-table-manner-series/cz-init-3.jpg"/></p>
<p>之後會詢問版本的格式要是如何<br/>
常用的格式有 <code>$version</code> (e.g., <code>1.0.0</code>) 或 <code>v$version</code> (e.g., <code>v1.0.0</code>)</p>
<p><img alt="cz-init-4" src="/images/posts-image/2020-02-22-python-table-manner-series/cz-init-4.jpg"/></p>
<p>最後會確認要不要將驗證 commit message 的 pre-commit hook 設定好</p>
<p><img alt="cz-init-5.jpg" src="/images/posts-image/2020-02-22-python-table-manner-series/cz-init-5.jpg"/></p>
<p>完成後就會看到以下畫面</p>
<p><img alt="cz-init-6.jpg" src="/images/posts-image/2020-02-22-python-table-manner-series/cz-init-6.jpg"/></p>
<p>相對應的設定也會加入到設定檔 <code>pyproject.toml</code> (或 <code>.cz.toml</code>)</p>
<div class="highlight"><pre><span></span><code><span class="k">[tool.commitizen]</span>
<span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"cz_conventional_commits"</span>
<span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"1.0.2"</span>
<span class="n">tag_format</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"$version"</span>
</code></pre></div>
<h2 id="commitizen_2">使用 Commitizen</h2>
<div class="highlight"><pre><span></span><code><span class="c1"># 使用 commitizen 做 commit</span>
<span class="c1"># (也可以用簡短版的 cz c)</span>
cz<span class="w"> </span>commit
</code></pre></div>
<p>以 <code>cz_conventional_commits</code> 這套規則為例<br/>
會先詢問這次的 commit 做了哪一種改動</p>
<p><img alt="commitizen-1" src="/images/posts-image/2020-02-22-python-table-manner-series/commitizen-1.jpg"/></p>
<p>接著會要求輸入這次改動各項細節</p>
<ul>
<li>Scope： 改動範圍</li>
<li>Subject： 簡短敘述這次的改動</li>
<li>Body： 詳細敘述這次的改動</li>
<li>Is this a BREAKING CHANGE？： 這是否是一個重大改動</li>
<li>Footer： 其他參考資訊，通常可以將 Issue 的編號寫在這</li>
</ul>
<p><img alt="commitizen-2-w1024" src="/images/posts-image/2020-02-22-python-table-manner-series/commitizen-2.jpg"/></p>
<p>回答完，就會產生 commit message <strong>feat(blog-post): update python table manners series</strong><br/>
最下方則是 pre-commit hook 的 commit message 格式檢查通過</p>
<h2 id="commit-message_1">強制檢查 commit message</h2>
<p>剛開始引入 commitizen 時，可能會常常忘記要使用它來做 commit<br/>
這時候就能使用到前一篇提到的 <a href="https://pre-commit.com/">pre-commit</a><br/>
雖然在 2.0.0 後可以透過 <code>cz init</code> 初始設定好，但還是說明如果事後才想設定要怎麼做</p>
<p>我在 <a href="https://github.com/commitizen-tools/commitizen">commitizen</a> 中有加入 <a href="https://github.com/commitizen-tools/commitizen/blob/master/.pre-commit-hooks.yaml">.pre-commit-hooks.yaml</a><br/>
因此只要在專案的 <code>.pre-commit-config.yaml</code> 加入以下這段</p>
<div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">repos</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">- repo</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/commitizen-tools/commitizen</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">rev</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1.23.1</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">hooks</span><span class="p p-Indicator">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">commitizen</span>
<span class="w">        </span><span class="nt">stages</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">commit-msg</span><span class="p p-Indicator">]</span>
</code></pre></div>
<p>並透過 pre-commit 設定 commit-msg 階段的 git hook</p>
<div class="highlight"><pre><span></span><code>pipenv<span class="w"> </span>run<span class="w"> </span>pre-commit<span class="w"> </span>install<span class="w"> </span>-t<span class="w"> </span>commit-msg
</code></pre></div>
<p>在 commit 執行完，要進訊息寫入前<br/>
git 會執行 <code>cz check</code> 來確認輸入的訊息是否符合規範<br/>
如果不符合規範就會拒絕這次的 commit</p>
<p>需要注意的是檢查會在產生 commit message 後才能執行<br/>
因此要設定 commit-msg 階段的 git hook （i.e., <code>.git/hooks/commit-msg</code>）<br/>
如果只下 <code>pipenv run pre-commit install</code> 是不會成功的</p>
<p>接著可以開始聊勞，這些 commit message 能做什麼應用了</p>
<h2 id="_1">自動提升版本號</h2>
<p>與 commit message 規範可以做客製化不同<br/>
commitizen 目前並沒有提供不同版本表示方式的客製化<br/>
一律都會遵守 <a href="https://semver.org/">Semantic Version</a> （語意化版本）<br/>
這種版本號採用 <code>MAJOR.MINOR.PATCH</code> (e.g., <code>1.10.20</code>) 的格式</p>
<ul>
<li><code>MAJOR</code>： 重大改動，不向後相容</li>
<li><code>MINOR</code>： 新增功能，必須向後相容</li>
<li><code>PATCH</code>： 修正功能，必須向後相容</li>
</ul>
<p>以 commitizen 預設使用的 <code>cz_conventional_commits</code> 來說，相對應的 commit 種類和應該提升的版本號如下</p>
<ul>
<li><code>MAJOR</code>: BREAKING CHANGE (每次 commit 都會問的，這次是否為重大改動)</li>
<li><code>MINOR</code>: feat</li>
<li><code>PATCH</code>: fix, refactor, perf</li>
</ul>
<p>p.s. conventional commit 可以有很多種延伸，這裡指的只是 commitizen 採用的版本</p>
<p>每次提升版本號只會提升 1 ，而且以最前面的為主<br/>
e.g., 要 merge 回 master 的改動中出現 BREAKING CHANGE，不管其他有多少 feat 或 fix ，都只會讓 <code>MAJOR</code> 提升 1</p>
<p>目前只有 <code>cz_conventional_commits</code> 有預設的版本對應<br/>
如果為 <code>cz_jira</code>, <code>cz_customize</code> 或自己客製化規則加上提升版本的功能，可以參考commitizen 文件中 <a href="https://commitizen-tools.github.io/commitizen/customization/">customization</a> ，並加上 <code>bump_pattern</code>（比對 commit 是哪個種類） 和 <code>bump_map</code> （哪個種類的 commit 要提升哪個版本號）</p>
<p>稍微解釋了一下提升版本的規則，接下來要來講該如何使用了</p>
<div class="highlight"><pre><span></span><code>cz<span class="w"> </span>bump
</code></pre></div>
<p>第一次提升版本的時候，會先確認目前在設定檔 (e.g., <code>pyproject.toml</code>）中的版本是否已經有相對應的 git tag</p>
<p>如果沒有則會確認這是否是第一次為這個專案加上 git tag</p>
<div class="highlight"><pre><span></span><code>Tag v0.0.1 could not be found.
Possible causes:
- version in configuration is not the current version
- tag_format is missing, check them using 'git tag --list'

? Is this the first tag created?  (Y/n)
</code></pre></div>
<p>如果想跳過這個確認可以在後面加上參數 <code>--yes</code></p>
<div class="highlight"><pre><span></span><code>cz<span class="w"> </span>bump<span class="w"> </span>--yes
</code></pre></div>
<p>接著 commitizen 就會新增一個相對應的 git tag 和更新設定檔中的版本號<br/>
因為要將設定檔中的改動儲存， commitizen 這時會再新增一個 commit<br/>
(e.g., <code>bump: version 0.0.1 → 0.0.2</code>)</p>
<p>除了設定檔中的版本號外，有時候專案本身也有其他地方會使用到版本號<br/>
如果每次透過 commitizen 提升版本號後，還要手動更新其他部分，就失去了自動的好處了<br/>
所以 commitizen 另外提供了 <code>version_files</code> 這個設定，將需要改動的檔案也寫進來<br/>
commitizen 提升版本號時，就會一併更新檔案的內容<br/>
（Read More 👉 <a href="https://commitizen-tools.github.io/commitizen/bump/">bump</a> ）</p>
<p>透過 <code>cz bump</code> 指令雖然可以省下很多步驟<br/>
但更好的做法是將自動升版加入到加入到持續整合（Continuous Integration）<br/>
在 git repo 上將分支 merge 到 master 時，自動提升版本號<br/>
因為會牽涉到各個不同平台的做法，不會敘述太多<br/>
這裡附上 commitizen 文件中 <a href="https://commitizen-tools.github.io/commitizen/tutorials/github_actions/">Github Actions</a>, <a href="https://commitizen-tools.github.io/commitizen/tutorials/gitlab_ci/">Gitlab CI</a> 還有 <a href="https://commitizen-tools.github.io/commitizen/tutorials/jenkins_pipeline/">Jenkins Pipeline</a> 的做法</p>
<h2 id="commit">客製化 commit 規範</h2>
<p>目前 commitizen 提供兩種方式</p>
<ol>
<li>直接在設定檔設定 → 適合只需要改動問題，不需要使用到複雜的功能</li>
<li>將 commit 規範寫成 Python 套件發佈 → 適合需要加入複雜的驗證</li>
</ol>
<h3 id="_2">直接在設定檔設定</h3>
<p>首先必須先將 name 指定到 <code>cz_customize</code> 這套 commit 規範</p>
<div class="highlight"><pre><span></span><code><span class="k">[tool.commitizen]</span>
<span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"cz_customize"</span>
</code></pre></div>
<p>再來要設定下面的欄位<br/>
其中最重要的是 <code>message_template</code>（支援<a href="https://jinja.palletsprojects.com/en/2.11.x/">Jinja</a>）<br/>
以 <code>"{{change_type}}:{% if show_message %} {{message}}{% endif %}"</code> 這個例子來說<br/>
需要 <code>change_type</code>, <code>show_message</code>, <code>message</code> 三個變數來產生 commit message</p>
<p>（p.s. 如果想要使用驗證 commit message 的功能，則要更新 <code>schema_pattern</code>）</p>
<div class="highlight"><pre><span></span><code><span class="k">[tool.commitizen.customize]</span>
<span class="n">message_template</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"{{change_type}}:{% if show_message %} {{message}}{% endif %}"</span>
<span class="n">example</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"feature: this feature enable customize through config file"</span>
<span class="n">schema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"&lt;type&gt;: &lt;body&gt;"</span>
<span class="n">schema_pattern</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"(feature|bug fix):(</span><span class="se">\\</span><span class="s2">s.*)"</span>
<span class="n">bump_pattern</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"^(break|new|fix|hotfix)"</span>
<span class="n">bump_map</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="s2">"break"</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">"MAJOR"</span><span class="p">,</span><span class="w"> </span><span class="s2">"new"</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">"MINOR"</span><span class="p">,</span><span class="w"> </span><span class="s2">"fix"</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">"PATCH"</span><span class="p">,</span><span class="w"> </span><span class="s2">"hotfix"</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">"PATCH"</span><span class="p">}</span>
<span class="n">info_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"cz_customize_info.txt"</span>
<span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"""</span>
<span class="s2">This is customized info</span>
<span class="s2">"""</span>
</code></pre></div>
<p>變數要在 <code>[[tool.commitizen.customize.questions]]</code> 的區段作定義<br/>
背後所使用的套件是 <a href="https://github.com/tmbo/questionary">questionary</a></p>
<ul>
<li><code>name</code>： 必須跟前面 <code>message_template</code> 定義的一模一樣，而且裡面用到的變數都要有對應的問題能取得值</li>
<li><code>message</code>： 顯示給使用者的問題</li>
<li><code>type</code>： <a href="https://github.com/tmbo/questionary">questionary</a> 中的問題型態</li>
<li>其他欄位 (e.g., <code>choice</code>) 則是靠 <code>type</code> 來決定是否需要</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">[[tool.commitizen.customize.questions]]</span>
<span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"list"</span>
<span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"change_type"</span>
<span class="n">choices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">"feature"</span><span class="p">,</span><span class="w"> </span><span class="s2">"bug fix"</span><span class="p">]</span>
<span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Select the type of change you are committing"</span>

<span class="k">[[tool.commitizen.customize.questions]]</span>
<span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"input"</span>
<span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"message"</span>
<span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Body."</span>

<span class="k">[[tool.commitizen.customize.questions]]</span>
<span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"confirm"</span>
<span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"show_message"</span>
<span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Do you want to add body message in commit?"</span>
</code></pre></div>
<p>設定完之後，再使用 <code>cz commit</code> 就可以看到客製化過後的問題了<br/>
<img alt="customize" src="/images/posts-image/2020-02-22-python-table-manner-series/customize.jpg"/></p>
<h3 id="commit-python">將客製化的 commit 規範寫成 Python 套件發佈</h3>
<p>這個做法比較複雜，也比較不常會用到，所以我只會概略地講<br/>
（Read More 👉 <a href="https://commitizen-tools.github.io/commitizen/customization/">Customization</a>）</p>
<p>我已經先將套件的架構驟寫成一個 <a href="https://cookiecutter.readthedocs.io/en/1.7.0/">cookiecutter</a> 範本<br/>
透過以下指令，可以進入 cookiecutter 的互動式介面，並初始化專案</p>
<div class="highlight"><pre><span></span><code>cookiecutter<span class="w"> </span>gh:Lee-W/commitizen_cz_template
</code></pre></div>
<p>最主要需要實作的函式有 <code>questions</code>, <code>message</code><br/>
實作完成後，必須在要使用這個 commit 規範的環境安裝這個套件<br/>
安裝之後會在 <code>cz ls</code> 看到這個新的 commit 規範<br/>
在設定檔中設定 <code>name</code> 或在指令列加上參數 <code>-n name</code> (e.g., <code>cz -n cz_test commit</code>) 就可以開始使用</p>
<h2 id="changelog">自動產生更新日誌（Changelog）</h2>
<p>commitizen 可以透過過往的 commit message 產生 <a href="https://keepachangelog.com/en/1.1.0/">keep a changelog</a> 格式的更新日誌</p>
<p>透過以下指令，就能從最舊到最新的 commit message 產生更新日誌（預設是 <code>CHANGELOG.md</code>）</p>
<div class="highlight"><pre><span></span><code>cz<span class="w"> </span>changelog
</code></pre></div>
<p>如果已經有現成的 <code>CHANGELOG.md</code>， 則可以使用 <code>cz changelog --incremental</code> 指令</p>
<p>commitizen 會試著找出文件中最新釋出版本 (e.g., <code>1.0.5</code>) 的位置，將最新釋出版本以後的 commit 加入到更新日誌的最頂端</p>
<p>例如目前有一個專案，最新的版本是 1.0.5，之後有 2 個 commit</p>
<ul>
<li>feat: cool new features</li>
<li>ci: update jenkins file</li>
</ul>
<p>原本的更新日誌</p>
<div class="highlight"><pre><span></span><code><span class="gu">## 1.0.5</span>
<span class="gu">### Feat</span>
<span class="k">-</span><span class="w"> </span>old features
</code></pre></div>
<p>則 commitizen 在釋出 1.1.0 時，就會產生如下的更新日誌</p>
<div class="highlight"><pre><span></span><code><span class="gu">## 1.1.0 (2020-07-19)</span>

<span class="gu">### Feat</span>

<span class="k">-</span><span class="w"> </span>new cool new features

<span class="gu">## 1.0.5</span>
<span class="gu">### Feat</span>
<span class="k">-</span><span class="w"> </span>some old features
</code></pre></div>
<p>因為產生更新日誌，通常適合在升版後執行<br/>
在 <code>cz bump</code> 加上 <code>--changelog</code> 參數就可以提升版本的同時，產生更新日誌</p>
<h2 id="commitizen_3">其他 commitizen 指令和常用參數</h2>
<ul>
<li><code>cz bump</code>： 提升版本號<ul>
<li><code>--dry-run</code>： 將提升版本號的訊息輸出到終端機，不會實際產生 tag 和改變檔案</li>
<li><code>--increment {MAJOR,MINOR,PATCH}</code>： 提升特定版本號</li>
</ul>
</li>
<li><code>cz changelog</code>: 產生更新日誌<ul>
<li><code>--dry-run</code>: 將產生的更新日誌書處到終端機，不產生或更新 <code>CHANGELOG.md</code></li>
</ul>
</li>
<li><code>cz -n NAME [command]</code>： 使用不同的 commit 規則 （e.g., <code>cz -n cz_jira commit</code>）</li>
<li><code>cz version</code>： 顯示版本<ul>
<li><code>-p</code>（<code>--project</code>）： 顯示專案版本</li>
<li><code>-c</code>（<code>--commitizen</code>）： 顯示 commitizen 版本（預設）</li>
</ul>
</li>
</ul>
<h2 id="commitizen_4">關於 commitizen 的雜談</h2>
<p>我在 Taipei.py 第一次試講 Python Table Manners 時<br/>
有一頁就提到了，雖然 Python 也有 commitizen 這個工具，但還不太成熟</p>
<p><img alt="commitizen is not mature" src="/images/posts-image/2020-02-22-python-table-manner-series/not-mature-1.jpg"/></p>
<p>沒想到在 PyCon CA 的前一個禮拜我認真測試時<br/>
才發現其實 commitizen 已經很夠用了，該有的功能都有<br/>
只是我剛好都用一些奇怪的測試方式，測到一些 edge case<br/>
這時就覺得信奉 Python （？？？）的我，好像應該好好的介紹 Python 的工具<br/>
而不是 JavaScript 的 <a href="https://github.com/commitizen">commitizen</a></p>
<p><img alt="i am the one who's not mature" src="/images/posts-image/2020-02-22-python-table-manner-series/not-mature-2.jpg"/></p>
<p>於是我就在 PyCon CA 前一個禮拜，開始貢獻起 <a href="https://github.com/commitizen-tools/commitizen">commitizen</a><br/>
把我遇到的 issues 都修了，就順便把投影片中相關的內容一起翻新了</p>
<p>貢獻的過程中也發現了很多還能再增加的新功能，於是就在 PyCon CA 2019 帶了這個專案去 Develop Sprint<br/>
第一次當 Sprint Leader 還蠻好玩的，也蠻有成就感的<br/>
（Read More 👉 <a href="https://blog.wei-lee.me/posts/tech/2019/12/pycon-ca-2019">PyCon CA 2019</a>）</p>
<h3 id="java-script-commitizen">為什麼不用 Java Script 的 commitizen 就好了</h3>
<p><del>因為我是 Python 的開發者啊！！！</del></p>
<p>起初我也是從 JavaScript 的版本開始使用 （畢竟兩個專案 star 的數量差了一百倍）<br/>
原本我就有寫好 commit message 的習慣<br/>
能有工具幫助我把這件事做得更好，當然就再好不過了</p>
<p>用了一段時間後，我開始覺得我明明都已經認真寫好 commit message 了<br/>
為什麼每次 Pull Request / Merge Request 還是花那麼多時間寫<br/>
是不是有什麼工具可以自動透過寫好的 commit 產生一些訊息？<br/>
再來就找到了 <a href="https://github.com/commitizen/cz-conventional-changelog">cz-conventional-changelog</a></p>
<p>但 <a href="https://github.com/commitizen/cz-conventional-changelog">cz-conventional-changelog</a> 不能跟 <a href="https://github.com/leonardoanalista/cz-customizable">cz-customizable</a> 同時使用<br/>
（Read More 👉 <a href="https://github.com/commitizen/cz-cli/issues/434">Possible to use multiple adapters? #434</a>）</p>
<p>而且這些擴充常常要用到 <code>package.json</code> 來做設定<br/>
可是我就不是 Java Script 的專案，就不想加入這個檔案來設定啊 🤷‍♂️<br/>
所以才開始來找是不是有 Python 版本的替代方案<br/>
（Python 的 <a href="https://github.com/commitizen-tools/commitizen">commitizen</a> 支援的 toml （<code>.cz.toml</code>）是通用的格式，裡面 Python 相關的內容，適用於各語言）</p>
<h3 id="_3">持續貢獻</h3>
<p>整體來說， commitizen 是一個讓我貢獻得很有成就感的專案<br/>
最主要的原因之一就是這是我想用的工具</p>
<p>貢獻的過程，也會很快就收到作者 <a href="https://github.com/Woile">Woile</a> 的回饋<br/>
它也會用很友善的文字，讓我覺得貢獻 commitizen 所花的時間，是有受到重視的</p>
<p><img alt="friendly-response-1" src="/images/posts-image/2020-02-22-python-table-manner-series/friendly-response-1.jpg"/></p>
<p><img alt="friendly-response-2" src="/images/posts-image/2020-02-22-python-table-manner-series/friendly-response-2.jpg"/></p>
<p>除此之外， commitizen 測試覆蓋率很高，比較不需要怕改錯了會不會弄壞舊有的功能<br/>
程式碼風格上，透過 black 跟 flake8 來規範，讓程式碼閱讀起來輕鬆很多<br/>
在貢獻的過程中，也學到了不少很實用的工具（e.g., pre-commit, cookiecutter）</p>
<p>所以<strong>一起來貢獻 <a href="https://github.com/commitizen-tools/commitizen">commitizen</a> 吧 💪</strong></p>
<h2 id="reference">Reference</h2>
<ul>
<li><a href="https://medium.com/@klauskpm/how-to-create-good-commit-messages-67943d30cced">how to create a good commit message</a></li>
<li><a href="https://www.freecodecamp.org/news/writing-good-commit-messages-a-practical-guide/">How to Write Good Commit Messages: A Practical Git Guide</a></li>
<li><a href="https://www.conventionalcommits.org/en/v1.0.0/">Conventional Commit</a></li>
<li><a href="https://semver.org/">Semantic Version</a></li>
</ul>
</section>
<section class="post-footer">
<div class="post-share">
<span class="post-info-label">Share</span>
<a aria-label="Twitter" class="twitter" href="https://twitter.com/share?text=Python Table Manners - Commitizen: 規格化 commit message &amp;url=https://blog.wei-lee.me/posts/tech/2020/03/python-table-manners-commitizen" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title="Twitter">
<i aria-hidden="true" class="icon icon-twitter"></i><span class="hidden">Twitter</span>
</a>
<a aria-label="Facebook" class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.wei-lee.me/posts/tech/2020/03/python-table-manners-commitizen" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title="Facebook">
<i aria-hidden="true" class="icon icon-facebook"></i><span class="hidden">Facebook</span>
</a>
<a aria-label="LinkedIn" class="linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://blog.wei-lee.me/posts/tech/2020/03/python-table-manners-commitizen&amp;title=Python Table Manners - Commitizen: 規格化 commit message" onclick="window.open(this.href, 'linkedin-share', 'width=930,height=720');return false;" title="LinkedIn">
<i aria-hidden="true" class="icon icon-linkedin"></i><span class="hidden">LinkedIn</span>
</a>
<a aria-label="Email" class="email" href="mailto:?subject=Python Table Manners - Commitizen: 規格化 commit message&amp;body=https://blog.wei-lee.me/posts/tech/2020/03/python-table-manners-commitizen" title="Email">
<i aria-hidden="true" class="icon icon-mail"></i><span class="hidden">Email</span>
</a>
<div class="clear"></div>
</div>
<aside class="post-tags">
<a href="https://blog.wei-lee.me/tag/python.html">Python</a><a href="https://blog.wei-lee.me/tag/git.html">Git</a> </aside>
<div class="clear"></div>
<div class="series">
<p>This post is part 8 of the "Python Table Manners" series:</p>
<ol class="parts">
<li>
<a href="https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-series">Python Table Manners 系列</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-dependency-mangement">Python Table Manners - 虛擬環境和套件管理</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-test-1">Python Table Manners - 測試 (一)</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-test-2">Python Table Manners - 測試 (二)</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-coding-style">Python Table Manners - 程式碼風格</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-manage-trivial-tasks">Python Table Manners - 管理繁瑣任務</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2020/02/python-table-manners-pre-commit">Python Table Manners - pre-commit: git commit 前做完檢查</a>
</li>
<li class="active">
<a href="https://blog.wei-lee.me/posts/tech/2020/03/python-table-manners-commitizen">Python Table Manners - Commitizen: 規格化 commit message</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2020/03/python-table-manners-security">Python Table Manners - 安全性檢查</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2020/04/python-table-manners-documentation">Python Table Manners - 文件</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2020/12/python-table-manner-continuous-integration">Python Table Manners - 持續整合/部署</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2021/01/python-table-manners-cookiecutter">Python Table Manners - Cookiecutter 專案模板</a>
</li>
<li>
<a href="https://blog.wei-lee.me/posts/tech/2021/01/python-table-manner-editor">Python Table Manners 番外 - 編輯器</a>
</li>
</ol>
</div>
</section>
<script type="text/javascript">var use_utterance = true;</script>
<section class="post-comments">
<script async="" crossorigin="anonymous" data-issue-term="https://blog.wei-lee.me/posts/tech/2020/03/python-table-manners-commitizen" data-label="blog-comment" data-repo="Lee-W/main-blog" data-theme="github-light" src="https://utteranc.es/client.js">
</script>
</section>
<aside class="post-nav">
<div class="clear"></div>
</aside>
</div>
</article>
</main>
<div class="nav-footer">
<nav aria-label="Footer" class="nav-wrapper">
<span class="nav-copy">Those aren't written down are meant to be forgotten © 2023
          <a class="nav-rss" href="https://blog.wei-lee.me/feeds/all.atom.xml" target="_blank" title="RSS"><i class="icon icon-rss"></i></a>
</span>
<span class="nav-credits">



          Published with <a href="https://github.com/getpelican/pelican" rel="nofollow">Pelican</a> • Theme <a href="https://github.com/arulrajnet/attila" rel="nofollow">Attila</a> •
          <a class="menu-item js-theme" data-dark="Dark theme" data-light="Light theme" data-system="System theme" href="#">
<span class="theme-icon"></span><span class="theme-text">System theme</span>
</a>
</span>
</nav>
</div>
</section>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
<!-- TODO: minify -->
<script src="https://blog.wei-lee.me/theme/js/jquery.fitvids.js" type="text/javascript"></script>
<script src="https://blog.wei-lee.me/theme/js/script.js" type="text/javascript"></script>
<script src="https://blog.wei-lee.me/theme/js/clipboard.min.js" type="text/javascript"></script>
<script src="https://blog.wei-lee.me/theme/js/copy-to-clipboard.js" type="text/javascript"></script>
<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-3J7XQ46QH5"></script>
<script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-3J7XQ46QH5', { 'anonymize_ip': true });
    </script>
<script src="/pagefind/pagefind-ui.js"></script>
<script>
      window.addEventListener('DOMContentLoaded', (event) => {
          new PagefindUI({
              element: "#search",
              showImages: false,
          });
      });
  </script>
<!-- 	The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in article.html, but it needs to be included down here, after jQuery has already loaded. -->
<script>
  $(document).ready(function () {
    var viewport = $(window);
    var post = $('.post-content');
    // Responsive videos with fitVids
    post.fitVids();

    // Reading progress bar on window top
    function readingProgress() {
      var postBottom = post.offset().top + post.height();
      var viewportHeight = viewport.height();
      var progress = 100 - (((postBottom - (viewport.scrollTop() + viewportHeight) + viewportHeight / 3) / (postBottom - viewportHeight + viewportHeight / 3)) * 100);
      $('.progress-bar').css('width', progress + '%');
      (progress > 100) ? $('.progress-container').addClass('complete'): $('.progress-container').removeClass('complete');
    }
    readingProgress();
    // Trigger reading progress
    viewport.on({
      'scroll': function() {
        readingProgress();
      },
      'resize': function() {
        readingProgress();
      },
      'orientationchange': function() {
        readingProgress();
      }
    });

  });
</script>
</body>
</html>
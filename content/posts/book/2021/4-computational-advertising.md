Title: [Book] 計算廣告：互聯網商業變現的市場與技術
Date: 2021-02-13 22:35
Category: Book
Tags: Learning, Advertising
Slug: computational-advertising
Authors: Lee-W
Status: draft

因為原文就是簡體的，所以整個筆記會有中國用語
我用 [opencc-python](https://github.com/yichen0831/opencc-python) 簡轉繁

<!--more-->

[TOC]

## Note

### 常見名詞
* 千次曝光付費（Cost per Mille，CPM)
* 千次曝光期望收入（expected Cost per Mille, eCPM）
* 點擊付費（Cost per Click，CPC）
* 千次曝光收益（Revenue per Mille，RPM）
* 點擊率（Click Through Rate，CTR）: 廣告點擊與廣告展現的比率
* 轉化率（Conversion Rate，CVR）:  轉化次數與到達次數的比例
    * 轉化： 使用者從 landing page 開始，進一步完成下單等操作

### 前言
* If you can't measure it, you can't manage it.

### Ch 1 線上廣告概述

#### 免費模式
* 免費模式： 將能規模化、客製化傳播資訊的商品，以邊際成本的價格出售
    * 狹義案例： 軟體產品不收費（多一個使用者的邊際成本很小）
    * 廣義案例： 硬體以毛利爲零左右的價格出售（邊際成本 = 量產成本）
* 變現核心資產
    1. 流量
        * e.g., 有人使用你的產品時，你在產品夾帶付費內容（sponsored content）
    2. 資料
    3. 影響力
        * e.g., 近年來迅速崛起的網紅和自媒體

#### 廣告的目的
* 為什麼需要廣告？
    * 通過媒體達到低成本的使用者接觸（"低成本"是與市場或銷售人員的成本相對而言的）
* 廣告分類
    * 品牌廣告（brand awareness）
        * 快速接觸大量使用者，宣傳品牌形象，提升中長期購買率
        * 傳統廣告的主要目的之一
    * 直接效果廣告（direct response）
        * 利用廣告馬上帶來大量的購買或其他轉化行爲

#### 廣告形式
01. 橫幅廣告（banner ad）
02. 文字廣告（textual ad）
    * 提供連到廣告主 landing page 的連結
    * 搜尋廣告的主流形式
03. 富媒體廣告（rich media ad）
    * e.g., 彈跳視窗
    * 適合在高品質的媒體做品牌廣告投放，對使用者的使用體驗影響較大
04. 影片廣告（video ad）
05. 互動式廣告（playable ad）
06. 社交廣告（social ad）
    * 在社交網絡中嵌入的廣告
07. 行動廣告（mobile ad）
    * 嚴格來說與桌面廣告沒有本質的區別
08. 郵件營銷廣告（Email Direct Marketing，EDM）
    * 非常容易變成垃圾郵件的主要來源
    * 需要精準地把握使用者興趣，有節制地提供相關資訊
09. 激勵廣告（incentive ad）
    * e.g., 平台提供折扣或積分
    * 優點： 提高轉化效率
    * 缺點
        * 使用者對產品的需求並不強，因此後續效果會快速降低
        * 取得新客戶的忠誠度較差
10. 團購
11. 遊戲聯運
    * 根據使用者最終遊戲內消費在推廣管道和遊戲開發商之間分成的商業產品
12. 固定位導航
    * e.g., 入口網站的付費廣告

#### 線上廣告的歷史
* 擔保式投送（Guaranteed Delivery，GD）
    * 主要客戶： 品牌廣告主
    * 收費方式： CPM
    * 核心概念： 保證滿足各合約目標量的同時，儘可能爲廣告主分配到效果更好的流量
    * 挑戰
        1. 如何將流量分配到各個合約重疊的受眾上
        2. 如何在線上即時決定要曝光的廣告
* 競價廣告（auction-based advertising）
    * 供給方只保證單位流量的成本
* 廣告網絡（AD Network，ADN）
    * 按人群或上下文標籤賣廣告給需求方，用競價的方式分配流量
    * 收費方式： CPC
* 即時競價（Real Time Bidding，RTB）
    * 需求方按自己的人群定義來挑選流量

### Ch 2 計算廣告基礎
* 廣告產品能最佳化的主要是**收入**
    * **eCPM** 是計算廣告中最核心的量化指標之一

#### 廣告有效性原理及其最佳化的方式
1. 曝光階段
    * 有效程度與廣告位的物理屬性有關，沒有太多最佳化的空間
2. 關注階段
    * 明確傳達向使用者推送此廣告的原因
3. 理解階段
    * 集中強調一個主要訴求以吸引使用者的注意力
4. 接受階段
    * 廣告安全（ad safety）： 如何讓合適的廣告出現在合適的媒體上
5. 保持階段
6. 決策階段

越前面的階段對 CTR 影響越大，越後面對 CVR 影響越大

#### 廣告計費模式
* 常見的模式
    1. CPT（Cost per Time）
        * 有額外的品牌效果和櫥窗效應，但不利於受衆定位和自動化交易
    2. CPM（Cost per Mille）
    3. CPC（Cost per Click）
    4. CPS（Cost per Sale）/ CPA（Cost per Action）/ ROI
        * 即按照銷售訂單、轉化行爲或投入產出比來結算
    5. oCPM（optimized CPM）
        * Facebook主推的一種新結算方式
        * 仍照 CPM 結算，但會根據轉化率進行最佳化→ 平台方會承擔點擊率和點擊價值估計的任務
* 使用時機
    * 效果廣告： CPC
    * 品牌廣告： CPM
    * CPS / CPA / ROI 在特定的環境下才會使用
    * oCPM 則是資料能力較強的廣告平臺走向 CPA 的過渡

### Ch 3 線上廣告產品概覽
* 常見廣告產品的分層
    1. 廣告計劃 (campaign)
        * 廣告主的一次投放合約，包括預算、時間範圍等基本資訊
    2. 廣告組 (ad group)
        * 具體的廣告投放策略
        * 主要是設定**受衆定向條件**和出價 → 廣告效果最佳化的關鍵層級
    3. 廣告創意 (creative)
        * 最終曝光出來的素材

### Ch 4 合約位廣告
* 決定使用定向方法的考量點
    1. 效果： 流量是否高出平均效果的水準
    2. 規模： 流量佔整體廣告庫存流量的比例

#### 受衆定向方法概覽
1. 地域定向（geo-targeting）
2. 人口屬性定向（demographical targeting）
    * e.g., 年齡、性別、教育程度、收入
3. 上下文定向（contextual targeting）
    * e.g., 關鍵詞、主題、廣告主的分類
    * 覆蓋率比較高
4. 行爲定向（behavioral targeting）
    * e.g., 使用者的歷史瀏覽行爲
5. 精確位置定向（hyper-local targeting）
    * 在行動裝置上投放廣告時，可能獲得精準的地理位置
    * 適合區域性非常強的小廣告主（e.g., 餐飲、美容）
6. 重定向（retargeting）
    * 對廣告主過去一段時間內的訪客投放廣告以提升效果
    * 精準程度最高、效果最突出，但人群覆蓋量較小
7. 新客推薦定向（look-alike targeting）
    * 基於廣告主過往的訪客，基於平台的標籤找出行為類似的潛在客戶
    * 目的是在同等使用者覆蓋率的情況下，達到比通用的興趣標籤更好的效果
8. 動態定價（dynamic pricing）
    * e.g, 團購（隨著一起購買的人數改變價錢）
9. 場景定向（scenario targeting）

#### 受衆定向標籤體系
* 標籤體系
    1. 層級標籤體系（結構化）
        * 上層的標籤是下一層的父節點
    2. 興趣標籤體系（非結構化）
        * 所有的標籤不在同個分類，沒有明確的父子節點關係
* gotcha
    * 隨着標籤數量的增加，每個節點的流量會迅速收縮
        * 當節點流量過小時，對其進行預測就變得相當困難
    * 廣告產品聲稱自己的標籤體系複雜是沒有意義的，標籤背後的人群規模才有價值

#### 流量預測
*  流量預測的個主要用途
    1. 售前指導
    2. 線上流量分配
        * 一次曝光同時滿足兩個以上合約的要求時，怎樣決策將它分配給哪個合約以達到整體滿足所有合約的
    3. 出價指導
        * 在競價廣告中，由於沒有了量的保證，廣告主往往需要根據自己預計的出價先了解一下可能獲得多少流量，以判斷自己的出價是否合理

### Ch 5 搜尋廣告與競價廣告

* 廣告網路中的競價標的
    1. 上下文頁面中的**關鍵詞**，從搜尋廣告衍生
    2. 根據使用者行為加工**興趣標籤**，從曝光廣告的定向邏輯衍生

#### 搜尋廣告
* 產品形態
    * 競價標的： 競價關鍵詞（bid term）
        * 使用者輸入的查詢（query）透過與關鍵詞匹配，來確定是否可以觸發該條廣告
    * 結算方式：  CPC
    * 曝光區一般分為北、東、南3個部分，其中南區較為少用
        * ![ad-loc](/images/posts-image/2021-computational-advertising/ad-loc.jpg)
* 產品策略
    * 查詢擴充： 為廣告主自動拓展相關的查詢詞，擴大匹配流量
        * 精確匹配
        * 短語匹配： 當查詢完全包含廣告主關鍵詞或關鍵詞（包括關鍵詞的同義詞）的集合時
        * 廣泛匹配： 當查詢詞與關鍵詞高度相關時
            * e.g., 英語培訓 → 外語學習班、四級證書
        * 否定匹配： 明確指出哪些詞是不能被匹配的
    * 檢索
    * 排序
        * 將候選廣告根據eCPM排序
    * 放置
        * 考量因素
            1. 廣告相關性 → 確保使用者體驗
            2. 廣告的RPM → 有效利用曝光位置
    * 定價
* 產品案例： Google AdWords

#### 位置拍賣與機制設計

* 市場保留價（Market Reserve Price，MRP）
    * a.k.a. 起價, 底價
    * 贏得拍賣位置的最低價格，用以控制廣告的品質和保持一定的出售單價
* 定價策略
    * 廣義第二高價（GSP）
        * 對每一個贏得位置的廣告主，都按照他下一位的廣告主出價來收取費用
        * 競價廣告系統的主流定價策略
            * 不是最佳策略，但最容易實作、解釋
    * VCG 定價
        * 贏得了某個位置的廣告主，其所付出的成本應該等於他佔據這個位置給其他市場參與者帶來的價值損害
        * 邏輯過於複雜，比較難以向廣告主解釋清楚，「給其他市場參與者帶來的價值損害」也很難驗證
* Myerson 最佳拍賣
    * 對於期望收益很可能比較高的大玩家，會透過虛擬出價的變換對其進行一定程度的懲罰，以刺激其出更高的價格
    * 實作上大多平台都會採用部分的概念（e.g., 對出價能力強的買家進行一定程度的價格歧視），但不會公開宣稱

#### 競價廣告網路
* 批次聚合各媒體的剩餘流量，按照人群或上下文標籤的流量切割方式售賣給廣告主
    * 對媒體而言，只需要在廣告位的剩餘流量上呼叫廣告網路的投放程式碼或SDK，而不用關心每次曝光的投放結果
* 主流計價方式： CPC
* 關鍵的產品特點
    1. 不向廣告主做量的約定，而是根據 eCPM 來決定每次曝光分配給哪個廣告主
    2. 極力淡化媒體和廣告位的概念，很難拿到品牌溢價高的廣告位，一般不適合品牌廣告
    3. 由於廣告網路根據實際消耗來結算，通常要求廣告主先儲值，因而改善平台方的財務
* 產品案例： Google Display Network

#### 競價廣告需求方產品 → SEM
* 透過競價採買搜尋引擎關鍵詞來做推廣
* 進行關鍵詞選擇的目的是提高廣告主採買流量的ROI
    * compare to 搜尋引擎進行查詢擴充套件的目的是為了提高自己的營收
* 服務對象通常是中型以上的廣告主
* 產品案例： Efficient Frontier
    * 透過關鍵詞選擇和出價，為搜尋廣告主提供大量關鍵詞情形下的ROI 最佳化
    * 透過計算的方法確定一個投資組合中各個品種的投資比例，以達到期望收益最佳情況下風險最小的理論。在各個投資期望收益水平下，相應的最小組合風險對應的曲線就稱為efficient frontier。

### Ch 6 - 程式化交易廣告

#### 即時競價
* 客製化使用者標籤（customized audience segmentation）: 在做人群選擇時，需要利用廣告主自有的資料 ← **即時競價的關鍵產品目標**

* 流程
    1. 使用者標識映射（cookie 映射）
        1. 從`廣告主網站`向 `DSP 伺服器` 發起 cookie 映射請求
        2. `DSP` 與 `ADX 伺服器`之間通信完成 cookie 映射
    2. 廣告請求（ad call）
        1. 當`使用者`接觸到`媒體網站`的廣告位時，前端向 `ADX` 發起廣告請求
        2. `ADX` 向各 `DSP` 傳送 URL（或應用 ID ）和使用者標識，發起詢價請求
        3. `媒體網站` 從勝出的 `DSP` 拿到廣告創意並展示

```mermaid
flowchart LR
    User --2.1-->Media
    Media --2.2--> ADX
    ADX <--2.3--> DSP
    Ad -.1.1.-> DSP
    DSP <-.1.2.-> ADX

    User[使用者]
    Media[媒體網站]
    Ad[廣告主]
    DSP[DSP 1..n]
    ADX[ADX]
```


* [IAB](https://www.iab.com/) 制定了 [OpenRTB](https://openrtb.github.io/OpenRTB/) 接口標準，已經被一些 ADX 採用

#### 優選（Preferred Deal，PD）
* 步驟
    1. `使用者`訪問`媒體頁面`
    2. `媒體頁面`通過 JavaScript 程式碼或 SDK 向`供給方廣告投放機`發起廣告請求
    3. `供給方廣告投放機`向`需求方廣告投放機`發起詢問是否需要此次廣告曝光機會
    4. `需求方廣告投放機`判斷是否需要此次曝光
        1. 需要，則返回相應的廣告創意
        2. 不需要曝光機會，則通知`媒體廣告投放機`，由`供給方廣告投放機`從自有廣告庫中選擇合適的創意返回

```mermaid
flowchart TD
    User --1. 訪問--> Media --2. 廣告請求--> SAD
    SAD --3. 曝光機會詢問--> DAD --> adop
    adop -->|4-1. Yes, 提供廣告| SAD
    adop -->|4-2. No, 由供給方選其他廣告回傳| SAD

    User[使用者]
    Media[媒體頁面]
    SAD[供給方廣告投放機]
    DAD[需求方廣告投放機]
    adop{是否需要廣告機會}
```

* 計價方式: CPM
    * 沒有多方競價，又有選擇流量的便利，因一般比市場 CPM 單價
    * 決策過程可能存在比較多的投放機往返

#### 私有市場
* 邀請制的交易方式
    * 廣告主的品質可以較好地控制（優選的好處）
    * 被邀請的各需求方間仍需競價，有利於提升媒體的變現能力（競價的好處）
* 以 DoubleClick ADX、Mopub 等爲代表的主流 ADX 都在大力加強私有市場的產品和服務

#### 程式化直投 (PDB)
* 直接購買與即時競價的過度
    * 定價、保量或半保量
    * 需求方可以對採買的庫存做廣告投放決策
    * 有時可進行一定的流量選擇
* 特點
    1. 跨媒體頻率控制
    2. 多個子產品流量分配 → 提高流量使用價值
        * 需求方可以根據自有 CRM、DMP 以及策略在子產品之分配流量 → 相當於一個內部的 ADN
    3. 一定比例的還量
        * 部分媒體向 DSP 提供了一定比例的還量自由（例如可以返還20%的廣告請求）
            * 頻率過高或人群不匹配時，DSP 可以決定不投放廣告

#### 廣告交易平臺 (ADX)
* 計價方式： CPM
* 產品案例： DoubleClick ADX

#### 需求方平臺 (DSP)
* 產品核心特徵
    1. 程式化的流量購買方式（e.g., RTB, 優選）
    2. 供需求方進行客製化使用者劃分
* 產品策略
    * 檢索、排序、定價、**出價**
        * 出價直接決定 DSP 的流量基本單位成本和利潤
        * 出價策略（主要看 eCPM 和市價隨時間變化的曲線）
            1. 通過歷史資料，得到 eCPM 和市價的曲線
            2. 將一天的預算分配到 $eCPM / 市價$ 較大的流量
* 重定向
    * 對曾經對廣告主服務感興趣的使用者找出來，再對他們投放
    * 召回重定向與個性化重定向
        * 網站重定向（site retargeting）： 將一段時間內到達過廣告主服務的使用者作爲重定向集合
        * 個人化重定向（personalized retargeting）： 對重定向流量進行個人化加工
            * 對處於不同購買階段（e.g., 瀏覽、搜索、加入購物）的使用者，採用合適的創意推動他儘快完成轉化行爲
            * 對有過購買記錄的使用者推薦相關的商品以提升二次購買率
                * 動態創意
                * 推薦引擎
                * 廣告主商品庫存即時接口
                    * 避免使用者點擊廣告後發現售完
        * 搜索重定向： 將搜索過與廣告主直接相關的關鍵詞的使用者群作爲重定向集合
* 新客推薦（look-alike）
    * 由廣告主根據自己的第一方資料提供一部分種子使用者，再由第二方資料的廣告平臺分析這些使用者網絡行爲的特徵，並根據這些特徵找到具有相似特徵的拓展人群

#### 供給方平臺 （SSP）
* 產品策略
    1. 聚合（mediation）： 集成多個 ADN 的 JavaScript 程式碼或 SDK，動態決定向誰請求廣告
    2. 廣告投放（ad serving）
    3. 市場（marketplace）： 程式化交易產生後，SSP也會以RTB方式向DSP請求廣告，形成了一個市場

```mermaid

flowchart LR
    TA[受眾標籤] --> AD[SSP 內部廣告]
    TA[受眾標籤] --> ADNs

    AD --> DSPs
    ADNs --> DSPs

    subgraph adserver [廣告投放]
    AD
    end

    subgraph mediation [聚合]
    ADNs[ADN 1..n]
    end

    subgraph market [市場]
    DSPs[DSP 1..n]
    end
```

* 決策過程
    1. 估算出被聚合的 ADN 和內部廣到的 eCPM
    2. 用排序出最好的價格作為底價向 DSP 詢價
    3. 若排序最高的 ADN 拒絕請求，則向後面的排名發出請求 → 可能造成延遲

* Header Bidding
    * Bidder 繞過 ADX 直接向媒體報價，媒體根據出價高低決定中標者，如果沒有，再交由 ADX 進行即時競標
        * Bidder： 所有可以進行報價的服務（e.g., DSP、 ADX、其他廣告參與者）
    * 主要區別
        * 繞過 ADX 接可回傳報價的 DSP 而非只能估計eCPM 的 ADN
            * 收入最佳化變簡單
            * 容易獲得更高的 eCPM
        * 缺點
            * 廣告延遲
                * 實際曝光減少
                * 影響使用者體驗
    * 過程
        1. `使用者`訪問`媒體頁面`
        2. `媒體`將 Header Bidding 的 script hb.js 放在 HTML 的 head 中發給`使用者瀏覽器`
        3. 透過 hb.js，`使用者瀏覽器`向媒體網站約定好的 `Bidder` 發起曝光機會的競價請求，`Bidder`將報價回傳給`使用者瀏覽器`
        4. 透過 hb.js，`使用者瀏覽器`將 `Bidder` 報價回傳給`媒體網站`
        5. `媒體`同時向 `ADX` 或 `SSP` 發廣告請求
        6. `ADX` 或 `SSP` 發起 RTB 過程並獲得廣告候選
        7. `媒體`將 Header Bidding 出價結果和RTB出價結果排序，出價最高者贏得本次廣告展示機會，`使用者瀏覽器`請求勝方廣告

```mermaid
flowchart LR
    user --1--> media
    media --2--> user
    user <--3--> js <--3--> bidder
    user --4--> js --4--> media
    media <--5--> ADX
    ADX <--6--> DSPs
    media --7--> js --7 --> user

    bidder[bidder 1..n]
    js[js code]
    user
    media[媒體伺服器]
    ADX
    DSPs[DSP 1..n]
```
